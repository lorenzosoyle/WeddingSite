<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Site Color Picker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #0b0f1a;
            color: #e6e8ef;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: #7dd3fc;
        }
        .tool-section {
            background: rgba(255,255,255,0.06);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .color-display {
            display: flex;
            gap: 20px;
            align-items: center;
            margin: 20px 0;
        }
        .color-box {
            width: 100px;
            height: 100px;
            border: 2px solid #fff;
            border-radius: 8px;
            cursor: pointer;
        }
        .color-info {
            flex: 1;
        }
        .color-code {
            font-size: 24px;
            font-weight: bold;
            font-family: monospace;
            margin: 10px 0;
        }
        button {
            background: #7dd3fc;
            color: #0b0f1a;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #5fd3f3;
        }
        button:disabled {
            background: #666;
            cursor: not-allowed;
        }
        .instruction {
            background: rgba(95, 211, 243, 0.1);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #5fd3f3;
            margin: 15px 0;
        }
        .current-pink {
            background: #f0a3d5;
        }
        input[type="color"] {
            width: 100px;
            height: 100px;
            border: 2px solid #fff;
            border-radius: 8px;
            cursor: pointer;
        }
        .preview-text {
            font-size: 20px;
            margin: 15px 0;
            padding: 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 6px;
        }
        .iframe-container {
            margin-top: 20px;
            border: 2px solid #7dd3fc;
            border-radius: 8px;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¨ Wedding Site Color Picker</h1>

        <div class="tool-section">
            <h2>Current Pink Color</h2>
            <div class="color-display">
                <div class="color-box current-pink"></div>
                <div class="color-info">
                    <div class="color-code">#f0a3d5</div>
                    <p>This is the current bold pink color used throughout your site</p>
                </div>
            </div>
        </div>

        <div class="tool-section">
            <h2>Method 1: Pick from Website Preview</h2>
            <div class="instruction">
                Click "Enable Eyedropper" below, then click anywhere in the website preview to pick a color. The color will be captured and you can preview it before applying.
            </div>
            <button id="enableEyedropper">Enable Eyedropper</button>
            <button id="disableEyedropper" style="display: none;">Disable Eyedropper</button>

            <div class="iframe-container">
                <iframe id="sitePreview" src="http://localhost:3000"></iframe>
            </div>
        </div>

        <div class="tool-section">
            <h2>Method 2: Use Color Picker</h2>
            <div class="instruction">
                Click the color box below to open your browser's color picker, or manually enter a hex code.
            </div>
            <div class="color-display">
                <input type="color" id="colorPicker" value="#f0a3d5">
                <div class="color-info">
                    <input type="text" id="hexInput" value="#f0a3d5"
                           style="font-size: 20px; padding: 10px; background: rgba(255,255,255,0.1); border: 2px solid #7dd3fc; color: #e6e8ef; border-radius: 6px; width: 200px;">
                </div>
            </div>
        </div>

        <div class="tool-section">
            <h2>Selected Color</h2>
            <div class="color-display">
                <div class="color-box" id="selectedColorBox" style="background: #f0a3d5;"></div>
                <div class="color-info">
                    <div class="color-code" id="selectedColorCode">#f0a3d5</div>
                    <div class="preview-text">
                        Preview: <strong id="previewText" style="color: #f0a3d5;">the wedding of Kathy Wielgosz and Ben Sherry</strong>
                    </div>
                </div>
            </div>

            <button id="applyColor">Apply This Color to Website</button>
            <button id="resetColor">Reset to Original Pink</button>
        </div>

        <div class="tool-section">
            <h2>Instructions</h2>
            <ol>
                <li>Use either the eyedropper (Method 1) or color picker (Method 2) to select your desired color</li>
                <li>Preview how the color looks with the sample text above</li>
                <li>Click "Apply This Color to Website" to update all bold pink text</li>
                <li>The color change will be saved and applied to your index.html file</li>
            </ol>
        </div>
    </div>

    <script>
        let selectedColor = '#f0a3d5';
        let eyedropperActive = false;

        const colorPicker = document.getElementById('colorPicker');
        const hexInput = document.getElementById('hexInput');
        const selectedColorBox = document.getElementById('selectedColorBox');
        const selectedColorCode = document.getElementById('selectedColorCode');
        const previewText = document.getElementById('previewText');
        const enableBtn = document.getElementById('enableEyedropper');
        const disableBtn = document.getElementById('disableEyedropper');
        const iframe = document.getElementById('sitePreview');

        function updateSelectedColor(color) {
            selectedColor = color;
            selectedColorBox.style.background = color;
            selectedColorCode.textContent = color;
            previewText.style.color = color;
            colorPicker.value = color;
            hexInput.value = color;
        }

        colorPicker.addEventListener('input', (e) => {
            updateSelectedColor(e.target.value);
        });

        hexInput.addEventListener('input', (e) => {
            let value = e.target.value;
            if (!value.startsWith('#')) value = '#' + value;
            if (/^#[0-9A-Fa-f]{6}$/.test(value)) {
                updateSelectedColor(value);
            }
        });

        enableBtn.addEventListener('click', () => {
            eyedropperActive = true;
            enableBtn.style.display = 'none';
            disableBtn.style.display = 'inline-block';
            iframe.style.cursor = 'crosshair';
            alert('Eyedropper enabled! Click anywhere in the website preview below to pick a color.');
        });

        disableBtn.addEventListener('click', () => {
            eyedropperActive = false;
            enableBtn.style.display = 'inline-block';
            disableBtn.style.display = 'none';
            iframe.style.cursor = 'default';
        });

        // Eyedropper functionality - Note: This is simplified
        // For a real eyedropper from iframe, you'd need the iframe to be same-origin
        iframe.addEventListener('load', () => {
            try {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

                iframeDoc.addEventListener('click', (e) => {
                    if (!eyedropperActive) return;

                    e.preventDefault();

                    const element = e.target;
                    const computedStyle = window.getComputedStyle(element);
                    const color = computedStyle.color || computedStyle.backgroundColor;

                    // Convert rgb to hex
                    const rgb = color.match(/\d+/g);
                    if (rgb) {
                        const hex = '#' + rgb.map(x => {
                            const hex = parseInt(x).toString(16);
                            return hex.length === 1 ? '0' + hex : hex;
                        }).join('');
                        updateSelectedColor(hex);
                    }

                    eyedropperActive = false;
                    enableBtn.style.display = 'inline-block';
                    disableBtn.style.display = 'none';
                    iframe.style.cursor = 'default';
                });
            } catch (e) {
                console.log('Cannot access iframe due to CORS. Use Method 2 instead.');
            }
        });

        document.getElementById('applyColor').addEventListener('click', async () => {
            if (confirm(`Are you sure you want to change all bold pink text to ${selectedColor}?`)) {
                try {
                    const response = await fetch('http://localhost:3000/__edit/save', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            path: '/index.html',
                            content: 'COLOR_REPLACE_REQUEST',
                            oldColor: '#f0a3d5',
                            newColor: selectedColor
                        })
                    });

                    if (response.ok) {
                        alert('Color updated successfully! The page will reload.');
                        iframe.contentWindow.location.reload();
                    } else {
                        alert('Could not save automatically. Please copy this color code and tell Claude to update it: ' + selectedColor);
                    }
                } catch (e) {
                    alert(`Please tell Claude: "Change all bold pink text (#f0a3d5) to ${selectedColor}"`);
                }
            }
        });

        document.getElementById('resetColor').addEventListener('click', () => {
            updateSelectedColor('#f0a3d5');
        });
    </script>
</body>
</html>
