try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f5cd3aa0-0c6e-4e13-9a6c-5d6a6f7009c5",e._sentryDebugIdIdentifier="sentry-dbid-f5cd3aa0-0c6e-4e13-9a6c-5d6a6f7009c5")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5717],{45078:(e,t,n)=>{n.d(t,{r:()=>y,v:()=>m});var a=n(68096),i=n(7726),r=n(70958),o=n(98518),u=n(1761),l=n(27062),s=n(85544),d=n(7620),c=n(81527),v=n(57383),p=n(93770),g=n(75973);let _=e=>{let{value:t}=(0,l.fS)("claudeai_paprika_sticky"),{value:n}=(0,l.fS)("claude_ai_sticky_project_settings"),a=["enabled_web_search","enabled_bananagrams","enabled_sourdough","enabled_foccacia","enabled_mcp_tools"];return(t||e&&n)&&a.push("paprika_mode"),e&&n&&a.push("compass_mode"),a},m=e=>{let t=(0,p.jw)(),{pendingConversationSettings:n}=(0,p.Fj)(),{account:a}=(0,u.YL)(),{projectUuid:i}=(0,v.oM)(),{data:o}=(0,c.xQ)(i),{value:s}=(0,l.fS)("claude_ai_sticky_project_settings"),d=_(!!i);if((0,r.u9)(),t){var g;return null==(g=t.conversationSettings)?void 0:g[e]}return d.includes(e)?i&&s&&o?o[e]:null==a?void 0:a.settings[e]:null==n?void 0:n[e]},y=()=>{let e=(0,p.jw)(),{setPendingConversationSettings:t}=(0,p.Fj)(),{projectUuid:n}=(0,v.oM)(),{account:r}=(0,u.YL)(),m=_(!!n),{isInBeam:y,beamConversationSettings:f,setBeamConversationSettings:b}=(0,g.d)(),{track:S}=(0,o.st)(),{mutate:L}=(0,a.Jy)(),{mutate:h}=(0,i.HF)(null==e?void 0:e.id),{data:j}=(0,c.xQ)(n),{mutate:k}=(0,c.mu)(n),{value:E}=(0,l.fS)("claude_ai_sticky_project_settings"),T=(0,d.useCallback)(a=>{if(!r)return;e?h({settings:{...a}}):y&&b&&b({...f,...a});let i={},o=!1;Object.keys(a).forEach(n=>{let r=a[n];m.includes(n)?(Object.assign(i,{[n]:r}),o=!0):s.W$.includes(n)&&!e&&t({[n]:r}),S({event_key:"claudeai.conversation.setting.toggled",conversation_uuid:(null==e?void 0:e.id)||null,setting:n,value:r})}),o&&(n&&E?k({...j,...i}):L({...r.settings,...i}))},[r,e,h,y,b,f,m,L,S,t,j,n,k,E]);return{toggleConversationSetting:(0,d.useCallback)((e,t)=>{T({[e]:t})},[T]),batchToggleConversationSettings:T}}},45564:(e,t,n)=>{n.d(t,{Q:()=>l,t:()=>s});var a=n(54568),i=n(89256),r=n.n(i),o=n(7620);let u=(0,o.createContext)({isOpen:!1,dropdownToOpen:void 0,openModal:r(),closeModal:r(),clearCallerIdentifier:r()}),l=e=>{let{children:t}=e,[n,i]=(0,o.useState)(!1),r=(0,o.useRef)(void 0),[l,s]=(0,o.useState)(void 0);return(0,a.jsx)(u.Provider,{value:{isOpen:n,openModal:e=>{i(!0),r.current=e},closeModal:()=>{i(!1),s(r.current)},dropdownToOpen:l,clearCallerIdentifier:()=>{s(void 0)}},children:t})},s=()=>(0,o.useContext)(u)},80731:(e,t,n)=>{n.d(t,{K:()=>u,p:()=>l});var a=n(1761),i=n(55554),r=n(85544),o=n(21036);let u=()=>{let e=(0,a.O9)(),t=(0,a.zc)(),n=(0,a.mV)(),{selectedTier:u,shouldOverrideFeatureAccess:l,isTierSelectorEnabled:s}=(0,i.t)(),d=(0,o.useDynamicConfig)("claude_ai_projects_limits").get("max_free_projects",0)>0,c=s&&l&&u?u===r.d7.PRO||u===r.d7.MAX||u===r.d7.ENTERPRISE:e||t||n,v=(0,o.useLayer)("trials_freemium").get("free_project",!1);return d||c||v},l=()=>{let e=(0,a.O9)(),t=(0,a.zc)(),n=(0,a.mV)(),{selectedTier:u,shouldOverrideFeatureAccess:l,isTierSelectorEnabled:s}=(0,i.t)(),d=(0,o.useDynamicConfig)("claude_ai_projects_limits"),c=(0,o.useLayer)("trials_freemium");if(s&&l&&u?u===r.d7.PRO||u===r.d7.MAX||u===r.d7.ENTERPRISE:e||t||n)return;let v=d.get("max_free_projects",0);return v>0?v:+!!c.get("free_project",!1)}},81527:(e,t,n)=>{n.d(t,{BN:()=>D,CB:()=>y,GQ:()=>I,Gz:()=>C,Kf:()=>b,LQ:()=>T,PL:()=>m,bL:()=>j,bs:()=>S,dx:()=>p,eW:()=>E,fo:()=>L,gM:()=>g,gr:()=>_,mu:()=>P,sC:()=>v,sS:()=>k,u7:()=>f,xQ:()=>w});var a=n(7726),i=n(77186),r=n(1761),o=n(29585),u=n(71473),l=n(27062),s=n(87606),d=n(7620),c=n(80731);let v=30,p=1e4;var g=function(e){return e.Student="student",e.Beam="beam",e.Meeting="meeting",e.Haystack="haystack",e}({}),_=function(e){return e.Study="study",e.Career="career",e.Research="research",e.BeamTemplateAskClaudeV1="beam_template_ask_claude_v1",e.BeamTemplatePmV1="beam_template_pm_v1",e.BeamTemplateDsV1="beam_template_ds_v1",e.Zoom="zoom",e.Teams="teams",e.GoogleMeet="google_meet",e}({});let m=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid;return(0,i.Sk)("/api/organizations/".concat(t,"/projects/count"),{queryKey:[u.Wy,{orgUUID:t}],staleTime:3e5,enabled:!!t,meta:{noToast:e=>e instanceof o.LG&&"permission_error"===e.type}})},y=e=>{let{enabled:t=!0,limit:n,offset:a,starred:o,creatorFilter:l,isBeam:s,projectFilter:d,orderBy:v}=e,{activeOrganization:p}=(0,r.YL)(),g=(0,c.K)(),_=null==p?void 0:p.uuid,m=new URLSearchParams;return m.append("include_harmony_projects","true"),void 0!==n&&m.append("limit",n.toString()),void 0!==a&&m.append("offset",a.toString()),void 0!==o&&m.append("starred",o.toString()),void 0!==l&&m.append("creator_filter",l.toString()),void 0!==s&&m.append("is_beam",s.toString()),void 0!==d&&m.append("filter",d.toString()),void 0!==v&&m.append("order_by",v.toString()),(0,i.Sk)("/api/organizations/".concat(_,"/projects?").concat(m.toString()),{queryKey:[u.BP,{orgUuid:_},{limit:n,offset:a,starred:o,creatorFilter:l,projectFilter:d,isBeam:s,orderBy:v}],enabled:!!(t&&p&&g),select:e=>{let t=e.length===n;return Object.assign(e.filter(e=>!e.archived_at),{hasMore:t})}})},f=e=>{let{enabled:t=!0,limit:n=v,offset:a=0,starred:o,creatorFilter:l,isBeam:s,projectFilter:d,orderBy:p,searchQuery:g}=e,{activeOrganization:_}=(0,r.YL)(),m=(0,c.K)(),y=null==_?void 0:_.uuid,f=new URLSearchParams;return f.append("limit",n.toString()),f.append("offset",a.toString()),void 0!==o&&f.append("starred",o.toString()),void 0!==l&&f.append("creator_filter",l.toString()),void 0!==s&&f.append("is_beam",s.toString()),void 0!==d&&f.append("filter",d.toString()),void 0!==p&&f.append("order_by",p.toString()),void 0!==g&&f.append("searchQuery",g.toString()),(0,i.Sk)("/api/organizations/".concat(y,"/projects_v2?").concat(f.toString()),{queryKey:[u.Wf,{orgUuid:y},{limit:n,offset:a,starred:o,creatorFilter:l,projectFilter:d,isBeam:s,orderBy:p,searchQuery:g}],enabled:!!(t&&_&&m)})},b=()=>{let{activeOrganization:e}=(0,r.YL)(),t=(0,i.mn)();return(0,d.useCallback)(async()=>(await t("/api/organizations/".concat(null==e?void 0:e.uuid,"/projects"))).json(),[null==e?void 0:e.uuid,t])},S=()=>{let e=b(),t=(0,a.uE)();return(0,d.useCallback)(async()=>{let[n,i]=await Promise.all([e(),t({limit:a.dy})]);return((e,t)=>{let n=e.map(e=>({...e,lastConversation:null==t?void 0:t.find(t=>t.project_uuid===e.uuid)})).filter(e=>e.lastConversation).sort((e,t)=>new Date(t.lastConversation.created_at).getTime()-new Date(e.lastConversation.created_at).getTime()),a=null==e?void 0:e.filter(e=>!n.find(t=>t.uuid===e.uuid));return[...n,...a]})(n,i)},[t,e])},L=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid;return(0,i.Sk)("/api/organizations/".concat(n,"/projects/").concat(e),{queryKey:[u.hc,{orgUuid:n,projectUuid:e}],enabled:!!(t&&e),staleTime:0,meta:{noToast:e=>e instanceof o.LG&&(404===e.statusCode||403===e.statusCode)}})},h=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid,n=(0,s.useQueryClient)();return{addProject:e=>{n.setQueriesData({queryKey:[u.Wf,{orgUuid:t}]},t=>t?{...t,data:[e,...t.data],pagination:{...t.pagination,total:t.pagination.total+1}}:t),n.setQueriesData({queryKey:[u.BP,{orgUuid:t}]},t=>t?[e,...t]:t),n.setQueriesData({queryKey:[u.Wy,{orgUUID:t}]},e=>e?{count:e.count+1}:e)},removeProject:e=>{n.setQueriesData({queryKey:[u.Wf,{orgUuid:t}]},t=>t?{...t,data:t.data.filter(t=>t.uuid!==e),pagination:{...t.pagination,total:Math.max(0,t.pagination.total-1)}}:t),n.setQueriesData({queryKey:[u.BP,{orgUuid:t}]},t=>t?t.filter(t=>t.uuid!==e):t),n.setQueriesData({queryKey:[u.Wy,{orgUUID:t}]},e=>e?{count:Math.max(0,e.count-1)}:e)}}},j=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid,n=C(),{addProject:a}=h();return(0,i.L2)(()=>"/api/organizations/".concat(t,"/projects"),"POST",{onSuccess:e=>{a(e),n()}})},k=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,a=C();return(0,i.Qv)(()=>"/api/organizations/".concat(n,"/projects/").concat(e),"PUT",(e,t)=>t?{...t,...e}:void 0,{onSuccess:()=>{a(e)},queryKey:[u.hc,{orgUuid:n,projectUuid:e}]})},E=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,a=C(),{removeProject:o}=h();return(0,i.L2)(()=>"/api/organizations/".concat(n,"/projects/").concat(e),"DELETE",{onSuccess:()=>{o(e),a(e,{remove:!0})}})},T=function(e){let{limit:t=30,offset:n=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:a}=(0,r.YL)(),l=null==a?void 0:a.uuid,s=new URLSearchParams;return s.append("limit",t.toString()),s.append("offset",n.toString()),(0,i.Sk)("/api/organizations/".concat(l,"/projects/").concat(e,"/conversations_v2?").concat(s.toString()),{queryKey:[u.yF,{orgUuid:l,projectUuid:e,limit:t,offset:n}],enabled:!!a,staleTime:0,meta:{noToast:e=>e instanceof o.LG&&403===e.statusCode}})},D=()=>{var e,t;let n=y({enabled:!0,creatorFilter:"is_creator",limit:p}),a=null==(t=n.data)||null==(e=t.find(e=>e.is_starter_project))?void 0:e.uuid;return{...n,data:a}},C=()=>{let{activeOrganization:e}=(0,r.YL)(),t=null==e?void 0:e.uuid,n=(0,s.useQueryClient)();return(e,a)=>{let{remove:i=!1}=a||{};if([[u.BP,{orgUuid:t}],[u.Wf,{orgUuid:t}],[u.Wy,{orgUUID:t}]].forEach(e=>void n.invalidateQueries({queryKey:e})),e){let a=i?"removeQueries":"invalidateQueries";[[u.hc,{orgUuid:t,projectUuid:e}],[u.yF,{orgUuid:t,projectUuid:e}],[u.vE,{projectUuid:e}]].forEach(e=>void n[a]({queryKey:e}))}}},I=(e,t)=>{let n=C();return(0,i.L2)("/api/organizations/".concat(e,"/projects/").concat(t,"/report"),"POST",{enabled:!!t&&!!e,onSuccess:()=>{n(t)}})},w=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,{value:a}=(0,l.fS)("claude_ai_sticky_project_settings");return(0,i.Sk)("/api/organizations/".concat(n,"/projects/").concat(e,"/settings"),{queryKey:[u.vX,{orgUuid:n,projectUuid:e}],enabled:!!(t&&e&&a)})},P=e=>{let{activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,{value:a}=(0,l.fS)("claude_ai_sticky_project_settings");return(0,i.Qv)(()=>"/api/organizations/".concat(n,"/projects/").concat(e,"/settings"),"PUT",(e,t)=>t?{...t,...e}:void 0,{queryKey:[u.vX,{orgUuid:n,projectUuid:e}],enabled:!!(t&&e&&a)})}},85717:(e,t,n)=>{n.d(t,{$f:()=>Y,K6:()=>z,L5:()=>q,LP:()=>E,U5:()=>C,cI:()=>D,ef:()=>M,fb:()=>K,kJ:()=>T,qL:()=>P,vT:()=>R,y:()=>I,yy:()=>j,zF:()=>w,zH:()=>Q});var a=n(68096),i=n(77186),r=n(1761),o=n(69916),u=n(71473),l=n(27062),s=n(77101),d=n(90119),c=n(21036),v=n(87606),p=n(62942),g=n(7620),_=n(46760),m=n(98251),y=n(45564),f=n(93049),b=n(45078),S=n(91768),L=n(40459);let h="gdrive_success",j=()=>{let e=(0,r.mV)(),{data:t}=(0,S.LN)(),n=!!(Array.isArray(t)&&t.find(e=>e.type===s.v8.GDRIVE&&e.enabled));return!e||n},k=()=>{let{value:e}=(0,l.fS)("kingfisher_enabled"),t=(0,c.useLayer)("trials_freemium").get("free_integrations",!1);return e||t},E=()=>{let e=j(),t=k();return!!(!L.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION&&t&&e)},T=()=>{let{account:e,activeOrganization:t}=(0,r.YL)(),n=null==t?void 0:t.uuid,a=E(),{data:o,isFetched:l}=(0,i.Sk)("/api/organizations/".concat(n,"/sync/mcp/drive/auth"),{queryKey:[u.jR,{accountUUID:null==e?void 0:e.uuid,orgUUID:n}],enabled:a,staleTime:3e5});return{isAuthenticated:a&&!!(null==o?void 0:o.is_authenticated),isFetched:l}},D=function(){let{callerIdentifier:e,handleAuthSuccess:t,pathname:n,queryString:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isAuthenticated:l,isFetched:s}=T(),{addSuccess:c}=(0,o.Y)(),m=(0,_.A)(),{dropdownToOpen:f,clearCallerIdentifier:b}=(0,y.t)(),L=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null==t||t(e),c(m.formatMessage({defaultMessage:"Successfully connected to Google Drive",id:"7RI6njc31e"}))},j=(e=>{let{callerIdentifier:t,pathname:n,queryString:a}=e,o=(0,p.usePathname)(),{account:l,activeOrganization:s}=(0,r.YL)(),c=null==l?void 0:l.uuid,_=null==s?void 0:s.uuid,m=E(),y=(0,v.useQueryClient)(),f=(0,d.V)(),b=(0,p.useSearchParams)(),{mutate:L}=(0,i.L2)("/api/organizations/".concat(_,"/sync/mcp/drive/auth/start"),"POST",{enabled:m,onSuccess:e=>{window.location.href=e.redirect_url}}),j=(0,g.useRef)(!1);return()=>{if(!m)return;let e="".concat(h,"=").concat(t).concat(a?"&".concat(a):""),i=(0,S.dH)({pathname:n||o,searchParams:b,queryString:e,isClaudeApp:f});if(y.invalidateQueries({queryKey:[u.jR,{accountUUID:c,orgUUID:_}]}),f)return void window.open("/settings/connectors?open_in_browser=1&auth_start=gdrive&origin=".concat(i));j.current||(j.current=!0,L({pre_auth_state:{origin:i},redirect_uri:new URL("/connect/mcp/drive/callback",window.location.origin).toString()}))}})({callerIdentifier:e,pathname:n,queryString:a});return(0,S.FZ)({callerIdentifier:e,successParam:h,handleOpen:L}),(0,g.useEffect)(()=>{e&&f===e&&(null==t||t(!0),b())},[f,t,e,b]),{isDriveAuthenticated:l,initDriveAuth:j,handleDriveTrigger:L,isFetched:s}},C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:t,activeOrganization:n}=(0,r.YL)(),a=null==t?void 0:t.uuid,o=null==n?void 0:n.uuid,l=E(),s=(0,v.useQueryClient)(),{mutate:d}=(0,m.ih)();return(0,i.L2)("/api/organizations/".concat(o,"/sync/mcp/drive/auth"),"DELETE",{enabled:!!(n&&l),...e,onSuccess:function(){for(var t,n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];s.invalidateQueries({queryKey:[u.jR,{accountUUID:a,orgUUID:o}]}),d({}),null==(t=e.onSuccess)||t.call(e,...i)}})},I=e=>{let{documentId:t}=e,{account:n,activeOrganization:a}=(0,r.YL)(),o=null==n?void 0:n.uuid,l=null==a?void 0:a.uuid,s=E(),d=(0,v.useQueryClient)(),c=(0,i.Sk)("/api/organizations/".concat(l,"/sync/mcp/drive/document/").concat(t,"?include_content=false"),{queryKey:[u.QB,{accountUUID:o,orgUUID:l,documentId:t}],enabled:s,meta:{noToast:!0}}),p=c.isError;return(0,g.useEffect)(()=>{p&&d.invalidateQueries({queryKey:[u.jR,{accountUUID:o,orgUUID:l}]})},[d,p,o,l]),c};function w(e){let{uri:t}=e,{data:n,isLoading:a}=I({documentId:t});return{title:null==n?void 0:n.title,isLoading:a}}let P=e=>{let{account:t,activeOrganization:n}=(0,r.YL)(),a=null==t?void 0:t.uuid,o=null==n?void 0:n.uuid,l=E(),s=(0,g.useMemo)(()=>e.map(e=>"/api/organizations/".concat(o,"/sync/mcp/drive/document/").concat(e)),[e,o]),d=(0,g.useMemo)(()=>({queryKey:e.map(e=>[u.qM,{accountUUID:a,orgUUID:o,documentId:e}]),enabled:l,meta:{noToast:!0}}),[e,a,o,l]);return(0,i._i)(s,d)},Q=e=>{let{account:t,activeOrganization:n}=(0,r.YL)(),a=null==t?void 0:t.uuid,o=null==n?void 0:n.uuid,l=E(),s=(0,f.bI)(),{data:d,isSuccess:c,isLoading:v}=(0,i.Sk)("/api/organizations/".concat(o,"/sync/mcp/drive/recents"),{queryKey:[u.zu,{accountUUID:a,orgUUID:o}],enabled:e&&l,meta:{noToast:!0}});return(0,g.useEffect)(()=>{if(c&&d){let e=d.map(e=>{let{uri:t,title:n}=e;return{uri:t,title:n}});(0,f.Ac)(e)}},[c,d]),{recentDriveDocs:c?d:s,isLoading:v}},K=()=>{let e=k(),{value:t}=(0,l.fS)("apps_use_bananagrams"),n=(0,c.useLayer)("trials_freemium").get("free_integrations",!1);return e&&t||n},z=()=>{let e=E(),t=K();return e&&t&&!L.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION},Y=e=>{var t;let n=z(),{account:a}=(0,r.YL)(),{value:i}=(0,l.fS)("claude_ai_sticky_project_settings"),o=(0,b.v)("enabled_bananagrams");return!!n&&(i?!!o:e?!!(null==e||null==(t=e.conversationSettings)?void 0:t.enabled_bananagrams):!!(null==a?void 0:a.settings.enabled_bananagrams))},q=()=>(0,l.fS)("rag_prototype").value,R=()=>{let e=z(),t=(0,r.mV)(),{data:n}=(0,S.LN)(),{account:a}=(0,r.YL)(),i=q();return!!e&&!!i&&(t?!!(Array.isArray(n)&&n.find(e=>{var t;return e.type===s.v8.GDRIVE&&e.enabled&&(null==(t=e.config)?void 0:t.allow_indexing)})):!!(null==a?void 0:a.settings.enabled_gdrive_indexing))},M=()=>{let{account:e}=(0,r.YL)(),{mutate:t}=(0,a.Jy)(),{mutate:n}=(0,m.Bg)();return{toggleDriveSearchAndIndexingEnabled:a=>{var i;let{indexingEnabled:r,searchEnabled:o,dismissBanner:u}=a,l=u||!!r;r&&n({}),t({...null==e?void 0:e.settings,...void 0!==r?{enabled_gdrive_indexing:r}:null,...void 0!==o||!0===r?{enabled_bananagrams:null!=r?r:o}:null,...l?{dismissed_claudeai_banners:[...(null==e||null==(i=e.settings)?void 0:i.dismissed_claudeai_banners)||[],{banner_id:"drive_indexing_enablement_2/11_1",dismissed_at:new Date().toISOString()}]}:null})}}}}}]);