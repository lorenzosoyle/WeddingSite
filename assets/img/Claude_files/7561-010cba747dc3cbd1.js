try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2665588d-12f0-4ac3-a516-773d6ebd28f3",e._sentryDebugIdIdentifier="sentry-dbid-2665588d-12f0-4ac3-a516-773d6ebd28f3")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7561],{4708:(e,t,a)=>{a.d(t,{q:()=>c});var s=a(23661),n=a(27062),l=a(21036),i=a(89836),r=a(56147),o=a(53573),d=a(6568);let c=e=>{let{projectUuid:t,conversationUuid:a,conversationTokensSoFar:c,conversationFiles:u,projectKnowledgebaseTokens:m,input:p,attachments:h,syncSourceUuids:x,chatInputModel:g}=e,f=(0,l.useStatsigClient)(),v=(0,r.Pb)(t);m=m&&!v?m:0;let y=u.filter(e=>e.file_kind===s.M.Image),b=c+(0,d.ED)(y)+u.filter(e=>e.file_kind===s.M.SanitizedDocument).reduce((e,t)=>e+(0,d.n2)(t),0)+m,j=(0,d.fO)(p,y,h),w=b+j+(0,i.YO)(x),k=(0,o.D)(a,g),M=null;b>k?M="exceeded":w>k&&(M="will-exceed");let _=f.getExperiment("conversation_truncation_max"),{value:A}=(0,n.fS)("conversation_truncation_projects");return _.get("truncate",!1)&&(void 0===t||A)&&null!==M&&j<k?[null,{conversationTokens:b,msgTokens:j,totalTokens:w,maxConversationTokens:k}]:[M,{conversationTokens:b,msgTokens:j,totalTokens:w,maxConversationTokens:k}]}},7409:(e,t,a)=>{a.d(t,{Dk:()=>r,NM:()=>i,lD:()=>d,sv:()=>o});var s=a(54568),n=a(16253),l=a(7386);let i=e=>{let{file:t,size:a,showWarnings:n,onRemoveFile:i,onClick:r,isEditable:o}=e;return"xxs"===a?(0,s.jsx)(l.M1,{file:t}):(0,s.jsx)(l.NM,{file:t,showWarnings:n,handleRemove:i,handleClick:r,isEditable:o})};function r(e){let t=e.match(/\.[^/.]+$/);return t&&(0,n.cm)({imagesEnabled:!0}).includes(t[0].toLowerCase())?e.replace(/\.[^/.]+$/,""):e}let o=()=>(0,s.jsx)(l.Iq,{title:"Images hidden in shared chats",isError:!0}),d=()=>(0,s.jsx)(l.Iq,{title:"Files hidden in shared chats",isError:!0})},8559:(e,t,a)=>{a.d(t,{L:()=>r});var s=a(54568),n=a(32987),l=a(49645),i=a(37463);function r(e){let{warning:t,placement:a,theme:r,onClick:o}=e,d=(0,n.A)("w-full border-0.5 relative z-[5] px-3.5","bottom"===a?"-mb-1 rounded-t-xl border-b-0 pb-2.5 pt-2":"-mb-1 -mt-1 rounded-b-xl border-t-0 pb-2 pt-2.5",{"bg-danger-900 border-transparent":"danger"===r,"text-text-200 border-accent-pro-100/20 bg-accent-pro-900":"pro"===r,"bg-bg-300 border-transparent":"info"===r,"bg-bg-200 border-transparent":"chin"===r,"hover:bg-bg-300 transition-colors":"chin"===r&&!!o});return(0,s.jsx)(l.N,{children:t&&(0,s.jsx)(i.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},children:o?(0,s.jsx)("button",{className:(0,n.A)(d),onClick:o,children:t}):(0,s.jsx)("div",{className:d,children:t})})})}},12331:(e,t,a)=>{a.d(t,{z:()=>i});var s=a(7620),n=a(20878),l=a(50163);function i(e,t){let{dateAdded:a,priority:i,showAfterOthersDismiss:r}=t,o=(0,s.useContext)(l.L),{dismiss:d,isDismissed:c}=(0,n.W)();if(!o)throw Error("useNux must be used within a NuxProvider");let{registerNux:u,unregisterNux:m,currentlyShowing:p}=o;return(0,s.useEffect)(()=>{if(!c(e))return u(e,{dateAdded:a,priority:i,showAfterOthersDismiss:r}),()=>m(e)},[e,a,i,r,c,u,m]),{shouldShow:p===e&&!c(e),dismiss:()=>{d(e),m(e)}}}},14786:(e,t,a)=>{a.d(t,{q:()=>o});var s=a(54568),n=a(4705),l=a(32987),i=a(7620),r=a(93770);let o=e=>{let{children:t,actionButton:a,title:o,minimalUi:d,dangerText:c}=e,{hasBlockingWarning:u,setHasBlockingWarning:m}=(0,r.Tc)(e=>({hasBlockingWarning:e.hasBlockingWarning,setHasBlockingWarning:e.setHasBlockingWarning}),"BlockingWarning");return(0,i.useEffect)(()=>(m(!0),()=>{m(!1)}),[u,m]),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"flex w-full flex-col items-center md:flex-row gap-2",children:[(0,s.jsxs)("div",{className:(0,l.A)("flex flex-row items-center gap-2 md:w-full",c?"text-danger-000":d?"text-text-300":"text-danger-000"),children:[d?null:(0,s.jsx)(n.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsxs)("div",{children:[o&&(0,s.jsx)("div",{className:"text-sm font-medium",children:o}),(0,s.jsx)("div",{className:"text-sm",children:t})]})]}),!!a&&(0,s.jsx)("div",{className:"-mt-px w-full whitespace-nowrap md:w-fit",children:a})]})})}},18395:(e,t,a)=>{a.d(t,{B:()=>g});var s=a(54568),n=a(7726),l=a(1761),i=a(15964),r=a(41417),o=a(37076),d=a(54890),c=a(27261),u=a.n(c),m=a(7620),p=a(46760),h=a(62971),x=a(77336);function g(e){var t,a,c,g,f,v;let{conversationUuid:y,message:b,requestedFeedbackType:j,setRequestedFeedbackType:w,isOpen:k,onClose:M,onSuccess:_,showOptions:A=!0}=e,N=(0,p.A)(),[C,S]=(0,m.useState)(""),{data:E}=(0,n.Bq)(y),I=null==E?void 0:E.chat_messages.some(e=>(0,d.Xz)(e).length>0),T=(0,x.V)(null!=(c=null==E?void 0:E.chat_messages)?c:[]).length>0,{mutate:D}=(0,n.HA)(y,b,!!I,{onSuccess:_}),O=(0,m.useId)(),L=null!=(g=null==(t=b.content)?void 0:t.some(e=>"thinking"===e.type))&&g,R="raven"===(0,l.$b)(),P=null;return(null==E||null==(a=E.settings)?void 0:a.enabled_web_search)&&(P=null!=(v=null==(f=b.content)?void 0:f.some(e=>"tool_use"===e.type&&"web_search"===e.name))&&v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("option",{value:"flag/web-over",children:(0,s.jsx)(h.A,{defaultMessage:"Shouldn’t have searched the web",id:"T+mr27AakV"})}),(0,s.jsx)("option",{value:"flag/web-sources",children:(0,s.jsx)(h.A,{defaultMessage:"Don’t like the cited sources",id:"MBNotx/VaO"})}),(0,s.jsx)("option",{value:"flag/web-url",children:(0,s.jsx)(h.A,{defaultMessage:"Report a URL",id:"BMYqsjhycd"})})]}):(0,s.jsx)("option",{value:"flag/web-under",children:(0,s.jsx)(h.A,{defaultMessage:"Should have searched the web",id:"CS8kdzupd9"})})),(0,s.jsxs)(o.aF,{isOpen:k,title:N.formatMessage({defaultMessage:"Feedback",id:"Ejhdi47Jk5"}),onClose:M,children:[(0,s.jsx)("div",{className:"mt-4 flex flex-col",children:(null==j?void 0:j.includes("flag"))&&A&&(0,s.jsxs)(i.l6,{className:"my-2 max-w-md",label:N.formatMessage({defaultMessage:"What type of issue do you wish to report? (optional)",id:"IFWIi9rs1t"}),value:j,onChange:e=>{w(e.target.value||"flag")},children:[(0,s.jsx)("option",{value:"flag",children:(0,s.jsx)(h.A,{defaultMessage:"Select…",id:"q0+99kUbd6"})}),(0,s.jsx)("option",{value:"flag/bug",children:(0,s.jsx)(h.A,{defaultMessage:"UI bug",id:"0uIYueAyDB"})}),(0,s.jsx)("option",{value:"flag/refusal",children:(0,s.jsx)(h.A,{defaultMessage:"Overactive refusal",id:"Jl0Mn6yDBI"})}),T&&(0,s.jsx)("option",{value:"flag/file",children:(0,s.jsx)(h.A,{defaultMessage:"Poor image understanding",id:"227KYxHrx5"})}),(0,s.jsx)("option",{value:"flag/instructions",children:(0,s.jsx)(h.A,{defaultMessage:"Did not fully follow my request",id:"2uOw8LgMwG"})}),(0,s.jsx)("option",{value:"flag/facts",children:(0,s.jsx)(h.A,{defaultMessage:"Not factually correct",id:"topE9Q6MGe"})}),(0,s.jsx)("option",{value:"flag/incomplete",children:(0,s.jsx)(h.A,{defaultMessage:"Incomplete response",id:"ZNEcy7OM5r"})}),L&&(0,s.jsx)("option",{value:"flag/thoughts",children:(0,s.jsx)(h.A,{defaultMessage:"Issue with thought process",id:"zOab+24EWo"})}),P,(0,s.jsx)("option",{value:"flag/other",children:(0,s.jsx)(h.A,{defaultMessage:"Other",id:"/VnDMl81rh"})})]})}),"flag/web-url"===j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-text-300 border-0.5 border-border-300 rounded-lg p-12 text-sm",children:(0,s.jsx)(h.A,{defaultMessage:"Please use this <link>form</link> to report violative content.",id:"QSjqvNNsUq",values:{link:e=>(0,s.jsx)("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLSeO9Hzkyf_hQ2fYkfP_cqAcJG5kdlkg1wF4drQEFK9Z6db7jg/viewform",target:"_blank",className:"underline",children:e})}})}),(0,s.jsx)(o.vW,{children:(0,s.jsx)(r.$,{variant:"secondary",onClick:M,children:(0,s.jsx)(h.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mt-4 flex flex-col",children:[(0,s.jsx)("label",{htmlFor:O,className:"text-text-400 mb-2 text-sm",children:(0,s.jsx)(h.A,{defaultMessage:"Please provide details: (optional)",id:"og1W/bIZdx"})}),(0,s.jsx)(i.fs,{id:O,className:"text-sm",placeholder:(null==j?void 0:j.includes("flag"))||(null==j?void 0:j.includes("sc"))?N.formatMessage({defaultMessage:"What was unsatisfying about this response?",id:"+DB/t6WTki"}):N.formatMessage({defaultMessage:"What was satisfying about this response?",id:"yJFWG3mK1I"}),value:C,onChange:e=>{S(e.target.value)}})]}),(0,s.jsx)("p",{className:"text-text-500 mt-3 italic leading-tight",children:(0,s.jsx)("small",{children:(0,s.jsx)(h.A,{defaultMessage:"Submitting this report will send the entire current conversation to Anthropic for future improvements to our models. <link>Learn More</link>",id:"laRJ009b4f",values:{link:e=>(0,s.jsx)(u(),{target:"_blank",rel:"noopener",href:R?"https://privacy.anthropic.com/en/articles/9957937-how-does-anthropic-use-submitted-feedback":"https://privacy.anthropic.com/en/articles/10023565-how-does-anthropic-use-submitted-feedback",className:"text-accent-secondary-100 font-medium hover:underline",children:e})}})})}),(0,s.jsxs)(o.vW,{children:[(0,s.jsx)(r.$,{onClick:()=>{j&&(D({type:j,reason:C||void 0}),M())},children:(0,s.jsx)(h.A,{defaultMessage:"Submit",id:"wSZR47Y5kj"})}),(0,s.jsx)(r.$,{variant:"secondary",onClick:M,children:(0,s.jsx)(h.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})]})}},20434:(e,t,a)=>{a.d(t,{c:()=>s});var s=function(e){return e[e.HIGH=30]="HIGH",e[e.MEDIUM=20]="MEDIUM",e[e.LOW=10]="LOW",e[e.NONE=0]="NONE",e}({})},33562:(e,t,a)=>{async function s(e){let t,a="CaptureController"in window?new CaptureController:null;null==a||a.setFocusBehavior("no-focus-change");try{t=await navigator.mediaDevices.getDisplayMedia({video:!0,controller:a})}catch(e){if(e instanceof DOMException&&"NotAllowedError"===e.name)return null;throw e}let s=document.createElement("video");s.srcObject=t,await new Promise((e,t)=>{s.onloadedmetadata=()=>{s.play().then(e,t)}});let n=document.createElement("canvas");if(e){let t=Math.min(e.width/Math.min(s.videoWidth,e.width),e.height/Math.min(s.videoHeight,e.height));n.width=s.videoWidth*t,n.height=s.videoHeight*t}else n.width=s.videoWidth,n.height=s.videoHeight;let l=n.getContext("2d");if(!l)throw Error("Could not create 2D context");l.drawImage(s,0,0,n.width,n.height);let i=n.toDataURL("image/png");return t.getTracks().forEach(e=>e.stop()),{imageDataUrl:i}}a.d(t,{U_:()=>j,pi:()=>M,$V:()=>w,Cn:()=>y});var n=a(98518),l=a(69916),i=a(90517),r=a(77101),o=a(44180),d=a(46760),c=a(89836),u=a(85717),m=a(57934),p=a(57383),h=a(45727),x=a(80047),g=a(49194),f=a(31102),v=a(34211);let y=e=>{let{setMcpDirectoryModalIsOpen:t,setStyleModalOpenWithScreen:a,setCreateProjectModalIsOpen:s,setGithubModalIsOpen:n,setGmailAuthModalIsOpen:l,setCreatePromptArgumentModalIsOpen:r}=e,o=k(),d=M(),c=w(),p=(0,v.y)(),{openFeaturePreviewModal:h}=(0,x.go)(),{checkIsGithubAuthenticated:g,initGithubAuth:f}=(0,m.nB)(),{initDriveAuth:y}=(0,u.cI)();return{onAddScreenshot:()=>{o()},openGithubModal:()=>{g().then(e=>{if(!e)return void f();n(!0)})},openGmailAuthModal:()=>{l(!0)},openMcpDirectoryModal:()=>{t(!0)},initDriveAuth:y,createDriveSyncSource:b(),onStyleChange:e=>{d(e)},openStyleModal:()=>{a(i.I.LIST)},onSelectProject:c,onCreateProject:e=>{s({isOpen:!0,moveAttachments:e})},onSelectBeamChat:p,openFeaturePreviewModal:h,onEnterPromptArguments:(e,t)=>{r({isOpen:!0,serverUuid:e,prompt:t})}}},b=()=>{let{addError:e}=(0,l.Y)(),{setIsUploadingDriveSync:t,setSyncSourceUuids:a}=(0,p.oM)(),{mutate:s}=(0,c.EF)({onMutate:()=>{t(!0)},onSuccess:e=>{t(!1),a(t=>[...t,e.uuid])},onError:a=>{t(!1),e((0,f.J)(a),{error:a})},meta:{noToast:!0}});return e=>s({sync_source_type:r.v8.GDRIVE,sync_source_config:{uri:e}})},j=e=>{var t;null==(t=document.getElementById("chat-input-file-upload-".concat(e)))||t.click()},w=()=>{let{projectUuid:e,setProjectUuid:t}=(0,p.oM)();return a=>{e===a?t(void 0):t(a)}},k=()=>{let{addError:e}=(0,l.Y)(),t=(0,d.A)(),{handleUpload:a}=(0,p.oM)(),i=(0,n.st)();return async()=>{i.track({event_key:"claudeai.plus_menu.screenshot_clicked"});let n=null;try{n=await s({width:1568,height:1568})}catch(a){(0,o.Cp)(a),e(t.formatMessage({defaultMessage:"Could not capture screen",id:"GT8HkzCHoM"}),{error:a})}if(!n)return;let l=new File([await fetch(n.imageDataUrl).then(e=>e.blob())],"screenshot.png",{type:"image/png"});await a([l])}},M=()=>{let{setPersonalizedStyle:e}=(0,p.oM)(),t=(0,n.st)(),{personalizedStyleOptions:a,setStoredStyle:s}=(0,h.p)();return n=>{let l=a.find(e=>e.key===n);if(!l)return;e(l);let i=(0,g.X)(l);s({styleKey:i,timestamp:new Date}),t.track({event_key:"styles.selected",style_key:i})}}},34211:(e,t,a)=>{a.d(t,{f:()=>l,y:()=>n});var s=a(57383);let n=()=>{let{beamChatUuid:e,setBeamChatUuid:t,isNewBeamChat:a,setIsNewBeamChat:n,prompt:l,setPrompt:i,promptInputRef:r}=(0,s.oM)();return s=>{a&&!s&&n(!1),e===s?t(void 0):(t(s),l.length>0&&"@"===l[l.length-1]&&i(l.slice(0,-1)),setTimeout(()=>{var e;null==(e=r.current)||e.focus()},250))}},l=()=>{let{setIsNewBeamChat:e}=(0,s.oM)();return()=>{e(!0)}}},38715:(e,t,a)=>{a.d(t,{V:()=>o});var s=a(54568);a(77101);var n=a(7620),l=a(89836),i=a(93770),r=a(74744);function o(e){let{uuid:t,syncSource:a,onRemove:o,isEditable:d}=e,{mutateAsync:c}=(0,l.Ql)(),u=(0,n.useCallback)(()=>{c(t),null==o||o()},[c,t,o]),{projectUuid:m}=(0,i.lE)();return(0,s.jsx)(r.br,{location:"chat",projectUuid:m,syncSource:a,handleRemove:d?u:void 0,isEditable:d})}},38807:(e,t,a)=>{a.d(t,{Xx:()=>G,_9:()=>F,CH:()=>Y,tl:()=>H});var s=a(54568),n=a(98518),l=a(89256),i=a.n(l),r=a(7620),o=a(41264),d=a(8027),c=a(11515),u=a(52198),m=a(34059),p=a(91961),h=a(77101),x=a(85544),g=a(90119),f=a(46760),v=a(70659),y=a(81527),b=a(85717),j=a(57934),w=a(80731),k=a(57383),M=a(27062),_=a(85201),A=a(34211),N=a(62370),C=a(33562),S=a(73212),E=a(65400),I=a(16430),T=a(20591),D=a.n(T);let O={includeScore:!0,isCaseSensitive:!1,ignoreLocation:!0,threshold:.4},L={path:null,inputMenuSearchQuery:"",setInputMenuSearchQuery:i(),inputMenuIsOpen:!1,setInputMenuIsOpen:i(),menuView:{rootItems:[],currentItems:[]},handleClickItem:i(),handleBack:i(),highlightedItemKey:null,setHighlightedItemKey:i(),animationDirection:"none"},R={...L,styleModalOpenWithScreen:null,setStyleModalOpenWithScreen:i(),createProjectModalIsOpen:null,setCreateProjectModalIsOpen:i(),githubModalIsOpen:!1,setGithubModalIsOpen:i(),gmailAuthModalIsOpen:!1,setGmailAuthModalIsOpen:i(),createPromptArgumentModalIsOpen:null,setCreatePromptArgumentModalIsOpen:i()},P={...L,mcpDirectoryModalIsOpen:!1,setMcpDirectoryModalIsOpen:i()},z=(0,r.createContext)(R),U=(0,r.createContext)(P),F=e=>{let{actions:t,rootItems:a,menuType:l,inputMenuIsOpen:i,setInputMenuIsOpen:o}=e,d=(0,n.st)(),c=(0,r.useRef)(null),[p,x]=(0,r.useState)(null),[g,v]=(0,r.useState)(null),[j,k]=(0,r.useState)(""),M=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i&&e){o(!0),"plus"===l&&d.track({event_key:"claudeai.plus_menu.opened"});return}if(i&&!e){k("");let e=()=>{var e;_(null,!0),v(null),o(!1),null==(e=document.getElementById("input-".concat(l,"-menu-trigger")))||e.focus()};t.withDelay?setTimeout(e,200):e()}},_=(e,t)=>{t?c.current=e:c.current=p,x(e)},A=(()=>{if(p){let e=a.find(e=>e.key===p);if(e&&"children"in e)return e.children}return a})(),N=(e=>{let{actions:t,inputMenuSearchQuery:a,inputMenuIsOpen:n,pathItems:l,path:i,menuType:o}=e,d=(0,f.A)(),c=(0,r.useRef)(a),{handleSearchDrive:p,searchedDriveItems:x}=(e=>{let{path:t,actions:a,inputMenuSearchQuery:n,inputMenuIsOpen:l,menuType:i}=e,o="drive",d=(t===o||!t)&&l&&"plus"===i,c=(0,b.LP)(),[u,p]=(0,r.useState)([]),{recentDriveDocs:x}=(0,b.zH)(d),g=(0,r.useMemo)(()=>new I.A(x,{...O,keys:["title"]}),[x]);return c&&d?{handleSearchDrive:()=>{let e=n.toLowerCase();if(!e||!x)return[];p(g.search(e,{limit:t===o?10:5}).map(e=>({key:e.item.uri,type:"button",label:e.item.title||"",icon:(0,s.jsx)(m.A9,{type:h.v8.GDRIVE,variant:m.UF.DOCS,size:16}),onClick:()=>{a.createDriveSyncSource(e.item.uri)}})))},searchedDriveItems:u}:{handleSearchDrive:()=>[],searchedDriveItems:[]}})({path:i,actions:t,inputMenuSearchQuery:a,inputMenuIsOpen:n,menuType:o}),{handleSearchProjects:g,searchedProjectItems:v}=(e=>{let{path:t,actions:a,inputMenuSearchQuery:n,inputMenuIsOpen:l,menuType:i,pathItems:o}=e,d="projects",c=(0,w.K)(),m=o.map(e=>{let{key:t}=e;return t}).indexOf("projects")>-1||"projects"===t,p=!!(n&&m&&(t===d||!t)&&l&&c&&"plus"===i),[h,x]=(0,r.useState)([]),{data:g}=(0,y.CB)({enabled:p,limit:y.dx}),f=(0,r.useMemo)(()=>new I.A(g||[],{...O,keys:["name","description"]}),[g]);return p?{handleSearchProjects:()=>{let e=n.toLowerCase();if(!e||!g)return[];x(f.search(e,{limit:t===d?10:5}).map(e=>({type:"button",key:e.item.uuid,label:e.item.name,icon:(0,s.jsx)(u.Jt,{size:16}),subtitle:e.item.creator.full_name,onClick:()=>a.onSelectProject(e.item.uuid)})))},searchedProjectItems:h}:{handleSearchProjects:()=>[],searchedProjectItems:[]}})({path:i,actions:t,inputMenuSearchQuery:a,inputMenuIsOpen:n,menuType:o,pathItems:l}),{handleFilterMenuItems:j,filteredMenuItems:k}=(e=>{let{path:t,inputMenuSearchQuery:a,pathItems:s}=e,n=s.filter(e=>{let{menuItemHidden:t}=e;return!t}),[l,i]=(0,r.useState)([]);return"projects"===t||"drive"===t?{handleFilterMenuItems:()=>[],filteredMenuItems:[]}:{handleFilterMenuItems:()=>{let e=a.toLowerCase();if(!e)return n;let t=[];for(let e of n)t.push(e),!e.isDisabled&&"projects"!==e.key&&"drive"!==e.key&&"children"in e&&e.children&&t.push(...e.children);i(t.filter(t=>!t.nonSearchable&&"toggleAll"!==t.type&&"back"!==t.type&&"divider"!==t.type&&"string"==typeof t.label&&t.label.toLowerCase().includes(e)).slice(0,7))},filteredMenuItems:l}})({path:i,inputMenuSearchQuery:a,pathItems:l}),M=(0,r.useCallback)(()=>{j(),g(),p()},[j,g,p]),_=(0,r.useMemo)(()=>D()(()=>{M()},100),[M]);return((0,r.useEffect)(()=>{if(a&&n&&a!==c.current)return c.current=a,_(),()=>{_.cancel()}},[n,a,_]),k.length||v.length||x.length)?[k,v,x].reduce((e,t,a)=>[...e,...e.length&&t.length?[{key:"divider".concat(a+1),type:"divider",label:""}]:[],...t],[]):[{key:"loading",type:"button",label:d.formatMessage({defaultMessage:"No results found",id:"hX5PAbCTOR"}),icon:(0,s.jsx)(E.e,{size:16}),onClick:()=>void 0,isDisabled:!0}]})({actions:t,inputMenuSearchQuery:j,inputMenuIsOpen:i,pathItems:A,path:p,menuType:l}),C=j.trim().length?N:A,{handleClickItem:T,handleBack:L}=(e=>{let{currentItems:t,inputMenuIsOpen:a,setInputMenuIsOpen:s,inputMenuSearchQuery:n,setInputMenuSearchQuery:l,path:i,handleUpdatePath:o,highlightedItemKey:d,setHighlightedItemKey:c}=e,u=(0,r.useCallback)(e=>{if("toggleGroup"===e.type||"optionGroup"===e.type||"buttonGroup"===e.type)s(!0),o(e.key,!0);else if("button"===e.type||"switch"===e.type||"toggle"===e.type||"option"===e.type){var t;null==(t=e.onClick)||t.call(e)}},[s,o]),m=(0,r.useCallback)(e=>{i&&(null==e||e.preventDefault(),o(null),c(i),(0,S.l)())},[i,c,o]),p=(0,r.useCallback)(e=>{let a,s=t.filter(e=>!["subheader","divider"].includes(e.type)&&!e.isDisabled&&!e.menuItemHidden),n=s.findIndex(e=>{let{key:t}=e;return t===d});a="ArrowUp"===e?n>0?n-1:s.length-1:n<s.length-1?n+1:0,c(s[a].key)},[t,d,c]),h=(0,r.useCallback)(e=>{var t,n,i;if(!a)return void u(e);if(!e.isDisabled){if(l(""),"back"===e.type)return void m();if("button"===e.type){null==(t=e.onClick)||t.call(e),e.skipCloseOnClick||s(!1);return}if("toggleGroup"===e.type||"optionGroup"===e.type||"buttonGroup"===e.type){o(e.key),c(null),(0,S.l)();return}"option"===e.type&&(null==(n=e.onClick)||n.call(e),e.skipCloseOnClick||s(!1,{withDelay:!0})),("toggleAll"===e.type||"toggle"===e.type||"switch"===e.type)&&(null==(i=e.onClick)||i.call(e),(0,S.l)())}},[m,u,o,a,l,s,c]),x=(0,r.useCallback)((e,a)=>{if(!d)return;let s=t.find(e=>{let{key:t}=e;return t===d});s&&("Enter"===e||["optionGroup","toggleGroup","buttonGroup"].includes(s.type))&&(a.preventDefault(),h(s))},[d,t,h]);return(0,r.useEffect)(()=>{if(!a)return;let e=e=>{"Tab"===e.key?e.preventDefault():"Escape"===e.key?(e.preventDefault(),s(!1)):"ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),p(e.key)):"ArrowRight"===e.key||"Enter"===e.key?x(e.key,e):"ArrowLeft"!==e.key||n||m(e)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a,s,n,p,x,m]),{handleClickItem:h,handleBack:m}})({currentItems:C,inputMenuIsOpen:i,setInputMenuIsOpen:M,inputMenuSearchQuery:j,setInputMenuSearchQuery:k,path:p,handleUpdatePath:_,highlightedItemKey:g,setHighlightedItemKey:v}),R=c.current&&!p?"back":!c.current&&p?"forward":"none";return{path:p,inputMenuSearchQuery:j,setInputMenuSearchQuery:k,inputMenuIsOpen:i,setInputMenuIsOpen:M,menuView:{rootItems:a,currentItems:C},handleClickItem:T,handleBack:L,highlightedItemKey:g,setHighlightedItemKey:v,animationDirection:R}};function G(e){let{placement:t,children:a}=e,[n,l]=(0,r.useState)(!1),[i,S]=(0,r.useState)(!1),[E,I]=(0,r.useState)(null),[T,D]=(0,r.useState)(!1),[O,L]=(0,r.useState)(!1),[R,P]=(0,r.useState)(!1),[G,Y]=(0,r.useState)(null),[H,B]=(0,r.useState)(null),V=(0,C.Cn)({setMcpDirectoryModalIsOpen:P,setStyleModalOpenWithScreen:Y,setCreateProjectModalIsOpen:I,setGithubModalIsOpen:D,setGmailAuthModalIsOpen:L,setCreatePromptArgumentModalIsOpen:B}),K=(e=>{let{placement:t,actions:a,inputMenuIsOpen:n}=e,l=(0,f.A)(),i=(e=>{let{actions:t}=e,a=(0,f.A)();return(0,g.V)()||(0,p.fJ)()?null:{key:x.xd.ADD_SCREENSHOT,type:"button",icon:(0,s.jsx)(u.i7,{size:16}),label:a.formatMessage({defaultMessage:"Take a screenshot",id:"aTaOpCB71M"}),onClick:t.onAddScreenshot}})({actions:a}),r=(e=>{let{actions:t}=e,a=(0,f.A)();return(0,j.Cq)()?{key:x.xd.GITHUB,type:"button",icon:(0,s.jsx)(m.A9,{type:h.v8.GITHUB,size:16}),label:a.formatMessage({defaultMessage:"Add from {github}",id:"h3J3E4bRfj"},{github:"GitHub"}),onClick:t.openGithubModal}:null})({actions:a}),o=(e=>{let{actions:t,inputMenuIsOpen:a}=e,n=(0,f.A)(),l=(0,_.Hd)(),i=(0,b.LP)(),{isDriveAuthenticated:r,initDriveAuth:o}=(0,b.cI)(),{recentDriveDocs:d,isLoading:c}=(0,b.zH)(a);if(!i)return null;let u=n.formatMessage({defaultMessage:"Add from {drive}",id:"hwJ50OkM/9"},{drive:"Google Drive"}),p={key:x.xd.DRIVE,icon:(0,s.jsx)(m.A9,{type:h.v8.GDRIVE,size:16}),label:u};if(!r)return{...p,type:"button",isExternal:!0,secondaryText:n.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),onClick:o};let g=c?[{key:"drive-loading",type:"button",label:n.formatMessage({defaultMessage:"{drive} documents loading...",id:"PjuSZ/7RIb"},{drive:"Drive"}),isDisabled:!0}]:d.length?d.slice(0,8).map(e=>{var a;return{key:e.uri,type:"button",label:null!=(a=e.title)?a:"Untitled",icon:(0,s.jsx)(m.A9,{type:h.v8.GDRIVE,variant:m.UF.DOCS,size:16}),onClick:()=>{t.createDriveSyncSource(e.uri)}}}):[{key:"empty",type:"button",label:n.formatMessage({defaultMessage:"No recent {drive} documents",id:"XepM9W1Mo/"},{drive:"Drive"}),isDisabled:!0}];return{...p,type:"buttonGroup",children:[...l?[]:[{type:"back",key:"drive-back",label:u}],...g]}})({actions:a,inputMenuIsOpen:n}),S=(e=>{let{inputMenuIsOpen:t,actions:a}=e,n=(0,f.A)(),l=(0,_.Hd)(),{projectUuid:i,isProjectLocked:r}=(0,k.oM)(),o=(0,w.K)(),{data:d}=(0,y.CB)({enabled:t&&o,creatorFilter:"is_creator",limit:8}),{data:c}=(0,y.CB)({enabled:t&&o,creatorFilter:"is_not_creator",limit:8}),m=[...d||[],...c||[]],{data:p}=(0,y.fo)(i),h=(null==m?void 0:m.slice(0,8).map(e=>({key:e.uuid,type:"option",label:e.name,subtitle:e.creator.full_name,onClick:()=>a.onSelectProject(e.uuid),icon:(0,s.jsx)(u.Jt,{size:16}),isChecked:e.uuid===i})))||[];if(r||!o)return null;let g=n.formatMessage({defaultMessage:"Use a project",id:"H/dsl+Px2v"});return{key:x.xd.PROJECTS,type:"optionGroup",icon:(0,s.jsx)(u.Jt,{size:16}),label:g,secondaryText:null==p?void 0:p.name,children:[...l?[]:[{type:"back",key:"projects-back",label:g}],...h,{key:"divider1",type:"divider",label:""},{key:"add",type:"button",variant:"primary",icon:(0,s.jsx)(u.OM,{size:16}),label:n.formatMessage({defaultMessage:"Start a new project",id:"0y7bg6nA29"}),onClick:()=>a.onCreateProject(!1),nonSearchable:!0}],indicatorActive:!!p}})({actions:a,inputMenuIsOpen:n});(e=>{let{inputMenuIsOpen:t,actions:a}=e,n=(0,f.A)(),l=(0,M.fS)("claudeai_beam").value,i=(0,_.Hd)(),{isProjectLocked:r,beamChatUuid:o,isNewBeamChat:d}=(0,k.oM)(),c=((0,A.f)(),(0,w.K)()),{data:m}=(0,y.CB)({enabled:t&&c,limit:8,isBeam:!0});if(!l)return;let p=[...(null==m?void 0:m.slice(0,8).map(e=>({key:"beam-".concat(e.uuid),type:"option",label:e.name,onClick:()=>{a.onSelectBeamChat(e.uuid)},icon:(0,s.jsx)(u.g6,{size:16}),isChecked:e.uuid===o})))||[]];if(r||!c)return;let h=n.formatMessage({defaultMessage:"Start a beam chat",id:"6SS0ZNAywq"}),x=o?null==m?void 0:m.find(e=>e.uuid===o):null;return u.g6,null==x||x.name,[...i?[]:[{type:"back",key:"beam-chat-back",label:h}],...p,(u.OM,n.formatMessage({defaultMessage:"Start a new beam chat",id:"9VyHCfyJ8B"}))]})({actions:a,inputMenuIsOpen:n});let E=(e=>{let{actions:t}=e,a=(0,f.A)(),n=(0,N.Uz)({isConnected:!0,hasPromptsOrResources:!0}),l=(0,v.R4)(),i=(0,v.vW)();return n.map(e=>{let n=e.prompts.map(a=>({key:"prompt-".concat(e.name,"-").concat(a.name),type:"button",icon:(0,s.jsx)(u.ry,{size:16}),label:a.displayName,onClick:()=>{var s;return(null==(s=a.arguments)?void 0:s.length)?t.onEnterPromptArguments(e.uuid,a):void i({serverUuid:e.uuid,prompt:a,args:{}})}})),r=e.resources.map(t=>({key:"resource-".concat(e.name,"-").concat(t.uri),type:"button",icon:(0,s.jsx)(u.ZH,{size:16}),label:t.displayName,onClick:()=>void l({serverUuid:e.uuid,resource:t})}));return{key:"mcp-server-".concat(e.name),type:"buttonGroup",label:a.formatMessage({defaultMessage:"Add from {server}",id:"qEj6u51OfR"},{server:e.name}),icon:(0,s.jsx)(c.d,{url:e.url,fallbackSvg:(0,s.jsx)(d.B,{letter:e.name,size:16}),size:16}),children:[...n,...r]}})})({actions:a});return[{key:x.xd.UPLOAD,type:"button",icon:(0,s.jsx)(u.o3,{size:16}),label:l.formatMessage({defaultMessage:"Upload a file",id:"Zc9xq9TzDD"}),onClick:()=>(0,C.U_)(t)},...i?[i]:[],...r?[r]:[],...o?[o]:[],...E,...S?[{key:"divider1",type:"divider",label:""},S]:[]]})({placement:t,actions:V,inputMenuIsOpen:n}),W=F({actions:V,rootItems:K,menuType:"plus",inputMenuIsOpen:n,setInputMenuIsOpen:l}),q=(0,o.ey)({actions:V}),X=F({actions:V,rootItems:q,menuType:"tools",inputMenuIsOpen:i,setInputMenuIsOpen:S}),$=(0,r.useMemo)(()=>({...W,styleModalOpenWithScreen:G,setStyleModalOpenWithScreen:Y,createProjectModalIsOpen:E,setCreateProjectModalIsOpen:I,githubModalIsOpen:T,setGithubModalIsOpen:D,gmailAuthModalIsOpen:O,setGmailAuthModalIsOpen:L,createPromptArgumentModalIsOpen:H,setCreatePromptArgumentModalIsOpen:B}),[W,G,Y,E,I,T,D,O,L,H,B]),J=(0,r.useMemo)(()=>({...X,mcpDirectoryModalIsOpen:R,setMcpDirectoryModalIsOpen:P}),[X,R,P]);return(0,s.jsx)(z.Provider,{value:$,children:(0,s.jsx)(U.Provider,{value:J,children:a})})}function Y(){return(0,r.useContext)(z)}function H(){return(0,r.useContext)(U)}},40359:(e,t,a)=>{a.d(t,{g:()=>n});var s=a(54568);let n=e=>{let{height:t,className:a}=e;return(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 139 34",className:a,height:t,fill:"currentColor","aria-label":"Claude",children:(0,s.jsx)("path",{d:"M18.07 30.79c-5.02 0-8.46-2.8-10.08-7.11a19.2 19.2 0 0 1-1.22-7.04C6.77 9.41 10 4.4 17.16 4.4c4.82 0 7.78 2.1 9.48 7.1h2.06l-.28-6.9c-2.88-1.86-6.48-2.81-10.87-2.81-6.16 0-11.41 2.77-14.34 7.74A16.77 16.77 0 0 0 1 18.2c0 5.53 2.6 10.42 7.5 13.15a17.51 17.51 0 0 0 8.74 2.06c4.78 0 8.57-.91 11.93-2.5l.87-7.62h-2.1c-1.26 3.48-2.76 5.57-5.25 6.68-1.22.55-2.76.83-4.62.83Zm21.65-26.4.2-3.39H38.5l-6.33 1.9v1.02l2.8 1.3v23.79c0 1.62-.82 1.98-3 2.25V33h10.75v-1.74c-2.17-.27-3-.63-3-2.25V4.4Zm42.75 29h.83l7.27-1.38v-1.78l-1.03-.07c-1.7-.16-2.13-.52-2.13-1.9V15.58l.2-4.07h-1.15l-6.87.99v1.73l.67.12c1.85.28 2.4.8 2.4 2.1v11.3C80.9 29.13 79.2 30 77.19 30c-2.26 0-3.64-1.15-3.64-3.8V15.58l.2-4.07h-1.19l-6.87.99v1.73l.71.12c1.86.28 2.41.8 2.41 2.1v10.43c0 4.42 2.49 6.52 6.48 6.52 3.04 0 5.53-1.62 7.39-3.88l-.2 3.88Zm-20-14.06c0-5.65-3-7.82-8.4-7.82-4.79 0-8.27 1.97-8.27 5.25 0 1 .36 1.74 1.07 2.25l3.64-.47c-.16-1.1-.24-1.78-.24-2.05 0-1.86.99-2.8 3-2.8 2.97 0 4.47 2.09 4.47 5.44v1.11l-7.51 2.25c-2.49.67-3.91 1.27-4.86 2.65a5 5 0 0 0-.71 2.8c0 3.2 2.21 5.46 5.97 5.46 2.72 0 5.13-1.23 7.23-3.56.75 2.33 1.9 3.56 3.95 3.56 1.66 0 3.16-.68 4.5-1.98l-.4-1.38c-.59.16-1.14.23-1.73.23-1.15 0-1.7-.9-1.7-2.68v-8.26Zm-9.6 10.87c-2.05 0-3.31-1.19-3.31-3.28 0-1.43.67-2.26 2.1-2.73l6.08-1.94v5.85c-1.94 1.46-3.08 2.1-4.86 2.1Zm63.3 1.81v-1.78l-1.02-.07c-1.7-.16-2.14-.52-2.14-1.9V4.4l.2-3.4h-1.42l-6.32 1.9v1.02l2.8 1.3v7.83a8.84 8.84 0 0 0-5.37-1.54c-6.28 0-11.18 4.78-11.18 11.93 0 5.89 3.51 9.96 9.32 9.96 3 0 5.61-1.47 7.23-3.72l-.2 3.72h.83l7.27-1.39Zm-13.15-18.13c3 0 5.25 1.74 5.25 4.94v9a7.2 7.2 0 0 1-5.21 2.1c-4.31 0-6.48-3.4-6.48-7.94 0-5.1 2.48-8.1 6.44-8.1Zm28.52 4.5c-.55-2.64-2.17-4.15-4.42-4.15-3.36 0-5.7 2.53-5.7 6.17 0 5.37 2.85 8.85 7.44 8.85a8.6 8.6 0 0 0 7.38-4.35l1.35.36c-.6 4.66-4.82 8.14-10 8.14-6.08 0-10.27-4.5-10.27-10.9 0-6.45 4.54-11 10.63-11 4.54 0 7.74 2.73 8.77 7.48l-15.84 4.85V21.7l10.66-3.32Z"})})}},41264:(e,t,a)=>{a.d(t,{$3:()=>K,ey:()=>L});var s=a(54568),n=a(8027),l=a(11515),i=a(78217),r=a(85644),o=a(1761),d=a(22529),c=a(52198),u=a(34059),m=a(27062),p=a(77101),h=a(85544),x=a(24871),g=a(21036),f=a(62942),v=a(7620),y=a(46760),b=a(61906),j=a(70659),w=a(85717),k=a(35747),M=a(92947),_=a(45078),A=a(91768),N=a(43156),C=a(57383),S=a(45727),E=a(75973),I=a(62370),T=a(85201);let D="inputMenu",O=()=>({isDisabled:!0,tooltip:(0,y.A)().formatMessage({defaultMessage:"Select a different model to use this feature",id:"/9vSDy2Wm0"}),isChecked:!1}),L=e=>{let{actions:t}=e,a=(0,y.A)(),n=(0,j.lu)(),l=(0,o.O9)(),r=(0,o.zc)(),d=(0,o.h0)(),u=(0,M.sb)(),m=(0,T.Ob)(),{conversation:p,model:h}=(0,C.oM)(),g=(0,i.Z3)((null==p?void 0:p.id)||null),v=null!=h?h:g,b=(0,f.useRouter)(),w=R({actions:t,currentModel:v}),k=V(),_=G({actions:t}),A=Y({actions:t}),N=H({currentModel:v,conversation:p});if((0,T.gB)())return _;let S=[...A?[A]:[],...N?[N]:[]];w.length&&(S=S.concat([...S.length?[{key:"divider1",type:"divider",label:""}]:[],...w]));let E=n&&(l||r);return(k.length||E||u)&&(S=S.concat([...k,...u?[{key:"divider2",type:"divider",label:""},{key:"addIntegrations",type:"button",icon:(0,s.jsx)(x.c,{size:16}),label:a.formatMessage({defaultMessage:"Add connectors",id:"2dXigF1Pil"}),tag:d?void 0:m?"upgrade":"pro",onClick:d||!m?t.openMcpDirectoryModal:()=>{window.location.href="/upgrade"}},{key:"manageIntegrations",type:"button",icon:(0,s.jsx)(c.wB,{size:16}),label:a.formatMessage({defaultMessage:"Manage connectors",id:"cqx+RdJnHp"}),isExternal:!0,onClick:()=>{b.push("/settings/connectors")}}]:E?[{key:"divider2",type:"divider",label:""},{key:"addIntegrations",type:"button",icon:(0,s.jsx)(x.c,{size:16}),label:a.formatMessage({defaultMessage:"Add connectors",id:"2dXigF1Pil"}),isExternal:!0,onClick:()=>{b.push("/settings/connectors")}}]:[]])),S},R=e=>{let{actions:t,currentModel:a}=e,s=P({currentModel:a}),n=z({currentModel:a}),l=F({actions:t,currentModel:a}),i=U({currentModel:a});return[...s?[s]:[],...n?[n]:[],...l?[l]:[],...i?[i]:[]]},P=e=>{let{currentModel:t}=e,a=(0,y.A)(),{conversation:n}=(0,C.oM)(),l=(0,o.h0)(),i=(0,T.Ob)(),r=(0,N.Eu)(t),d=(0,N.be)(),u=(0,N.WJ)(),m=(0,N.fy)(n),{toggleConversationSetting:p}=(0,_.r)(),h=O(),x=W("web_search");if(!d&&!i)return null;let g=m&&r;return d||!i||l?{key:"webSearch",type:"switch",label:a.formatMessage({defaultMessage:"Web search",id:"x0W7xxxEcv"}),icon:(0,s.jsx)(c.qz,{size:16}),isChecked:g,onClick:()=>p("enabled_web_search",!g),tag:x,...!u?{isDisabled:!0,tooltip:a.formatMessage({defaultMessage:"This feature has been disabled by your administrator.",id:"Jpvq2WYysx"})}:!r?h:null}:{key:"webSearch",type:"switch",label:a.formatMessage({defaultMessage:"Web search",id:"x0W7xxxEcv"}),icon:(0,s.jsx)(c.qz,{size:16}),isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}}},z=e=>{let{currentModel:t}=e,a=(0,y.A)(),{conversation:n}=(0,C.oM)(),l=(0,o.h0)(),i=(0,T.Ob)(),{toggleConversationSetting:d}=(0,_.r)(),c=(0,w.K6)(),m=(0,r.Wq)()(t,"gsuite_tools"),p=(0,w.$f)(n),{isDriveAuthenticated:h,initDriveAuth:x}=(0,w.cI)({callerIdentifier:D,handleAuthSuccess:()=>{d("enabled_bananagrams",!0)}}),g=O(),f=W("drive_search");if(!c&&!i)return null;let v={key:"driveSearch",icon:(0,s.jsx)(u.ft,{size:16}),label:a.formatMessage({defaultMessage:"{drive} search",id:"nUykp097rV"},{drive:"Drive"})};if(!c&&i&&!l)return{...v,type:"switch",isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}};if(!h)return{...v,type:"button",isExternal:!0,secondaryText:a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),onClick:x,...m?null:g};let b=h&&p;return{...v,type:"switch",isChecked:b,onClick:()=>{d("enabled_bananagrams",!b)},tag:f,...m?null:g}},U=e=>{let{currentModel:t}=e,a=(0,y.A)(),{conversation:n}=(0,C.oM)(),l=(0,T.Ob)(),{toggleConversationSetting:i}=(0,_.r)(),o=(0,A.Ys)(p.v8.GCAL),d=(0,r.Wq)()(t,"gsuite_tools"),c=(0,A.X0)(p.v8.GCAL,n),{isAuthenticated:m,startAuth:h}=(0,A.ob)(p.v8.GCAL,{callerIdentifier:D,handleAuthSuccess:()=>{i("enabled_foccacia",!0)}}),x=O(),g=W("calendar_search");if(!o&&!l)return null;let f={key:"gcal",label:a.formatMessage({defaultMessage:"Calendar search",id:"b7aUhdL5nd"}),icon:(0,s.jsx)(u.HI,{size:16})};if(!o&&l)return{...f,type:"switch",isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}};if(!m)return{...f,type:"button",isExternal:!0,secondaryText:a.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),onClick:h,...d?null:x};let v=m&&c;return{...f,type:"switch",isChecked:v,onClick:()=>{i("enabled_foccacia",!v)},tag:g,...d?null:x}},F=e=>{let{actions:t,currentModel:a}=e,n=(0,y.A)(),{conversation:l}=(0,C.oM)(),i=(0,o.h0)(),d=(0,T.Ob)(),{toggleConversationSetting:c}=(0,_.r)(),m=(0,A.Ys)(p.v8.GMAIL),h=(0,r.Wq)()(a,"gsuite_tools"),x=(0,A.X0)(p.v8.GMAIL,l),g=O(),f=W("gmail_search"),{isAuthenticated:v}=(0,A.ob)(p.v8.GMAIL,{callerIdentifier:D,handleAuthSuccess:()=>{c("enabled_sourdough",!0)}});if(!m&&!d)return null;let b={key:"gmail",label:n.formatMessage({defaultMessage:"Gmail search",id:"v0qteoUCm+"}),icon:(0,s.jsx)(u.kw,{size:16})};if(!m&&d&&!i)return{...b,type:"switch",isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}};if(!v)return{...b,type:"button",isExternal:!0,secondaryText:n.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),onClick:()=>{t.openGmailAuthModal()},...h?null:g};let j=v&&x;return{...b,type:"switch",isChecked:j,onClick:()=>{c("enabled_sourdough",!j)},tag:f,...h?null:g}},G=e=>{let{actions:t}=e,a=(0,y.A)(),{personalizedStyle:n}=(0,C.oM)(),{personalizedStyleOptions:l}=(0,S.p)();return[...l.map(e=>{let a=(null==n?void 0:n.key)===e.key;return{key:e.key,type:"option",label:"default"===e.type&&e.nameKey?(0,s.jsx)(d.X5,{id:e.nameKey}):e.name,icon:(0,s.jsx)(c.P_,{size:16}),onClick:()=>{a?t.onStyleChange("Default"):t.onStyleChange(e.key)},isChecked:a}}),{key:"divider1",type:"divider",label:""},{key:"add",type:"button",variant:"primary",icon:(0,s.jsx)(c.OM,{size:16}),label:a.formatMessage({defaultMessage:"Create & edit styles",id:"cY+Fgc8HvE"}),onClick:t.openStyleModal,nonSearchable:!0}]},Y=e=>{let{actions:t}=e,a=(0,y.A)(),n=(0,T.Hd)(),{personalizedStyle:l}=(0,C.oM)(),i=G({actions:t}),r=a.formatMessage({defaultMessage:"Use style",id:"f7VY0ldE+0"});return{key:h.xd.STYLES,type:"optionGroup",icon:(0,s.jsx)(c.P_,{size:16}),label:r,secondaryText:(null==l?void 0:l.isDefault)||null==l?void 0:l.name,children:[...n?[]:[{type:"back",key:"styles-back",label:r}],...i],indicatorActive:l&&"Default"!==l.key}},H=e=>{let t,{currentModel:a,conversation:n}=e,l=(0,y.A)(),i=(0,_.v)("paprika_mode"),r=(0,k.J)(),d=(0,k.j)()(a),{toggleConversationSetting:u}=(0,_.r)(),{value:p}=(0,m.fS)("model_selector_enabled"),{data:x}=(0,b.EY)(),f=(0,o.h0)(),j=(0,g.useLayer)("trials_freemium"),w=O(),M=(0,T.Ob)();(0,v.useEffect)(()=>{let e=!f,t=j.get("free_thinking",!1),a=e&&t&&(null==x?void 0:x.remaining)===0,s=!n||0===n.messagesSoFar;a&&i&&!s&&u("paprika_mode",null)},[null==x?void 0:x.remaining,f,j,i,u,n]);let A=j.get("free_thinking",!1),N=r&&(p||A&&!f);if(!r||!p&&!A&&!M)return null;let C=l.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),S=!f,E=j.get("free_thinking",!1),I=S&&E&&(null==x?void 0:x.remaining)===0,D=!I&&!!i;if(S&&E&&x&&void 0!==x.remaining&&x.resets_at){let e=new Date(1e3*x.resets_at),a=l.formatDate(e,{month:"short",day:"numeric"});t=l.formatMessage({defaultMessage:"{remaining} remaining until {date}",id:"httnsxXSeU"},{remaining:x.remaining,date:a})}let L={key:h.xd.EXTENDED_THINKING,type:"switch",label:C,icon:(0,s.jsx)(c.Sw,{size:16}),isChecked:D,indicatorActive:D,...t&&{subtitle:t},...I&&{isDisabled:!0,tag:"upgrade",rateLimitReached:!0,onClick:()=>{window.location.href="/upgrade"}}};return N||!M||f?d?{...L,...I?{}:{onClick:()=>{u("paprika_mode",i?null:"extended")},tooltip:l.formatMessage({defaultMessage:"Allow Claude to think out loud for longer for trickier questions and challenges.",id:"bbgQqH7Grg"}),tooltipImage:{src:"/images/feature-preview/extended-thinking.png",width:200,height:108}}}:{...L,...w}:{...L,isChecked:!1,isDisabled:!0,tag:"upgrade",onClick:()=>{window.location.href="/upgrade"}}},B=e=>{let{showConnectAction:t,mcpToolsSetting:a,toggleMcpToolEnabled:i,remoteOnly:r}=e,o=(0,y.A)(),d=(0,M.QD)();return(0,I.Uz)({isConnecting:!1,...r?{type:"remote"}:{},...t?{}:{isConnected:!0}}).map(e=>{let t={key:e.uuid,label:e.name,icon:(0,s.jsx)(l.d,{url:e.url,fallbackSvg:(0,s.jsx)(n.B,{letter:e.name,size:16}),size:16})};if(!e.isConnected)return{...t,type:"button",isExternal:!0,secondaryText:o.formatMessage({defaultMessage:"Connect",id:"+vVZ/G11Zg"}),onClick:()=>d({uuid:e.uuid,url:e.url})};let r=e.tools.map(t=>{let r=t.enabledKey,o=!1!==a[r];return{key:r,type:"switch",label:t.displayName,icon:(0,s.jsx)(l.d,{url:e.url,fallbackSvg:(0,s.jsx)(n.B,{letter:e.name,size:16}),size:16}),isChecked:o,onClick:()=>{i(r,!o,e.url)}}}),u=r.filter(e=>"switch"===e.type&&e.isChecked).length,m=u>0,p=e.tools.length,h=[];return r.length>1&&h.push({key:"select-all",type:"button",label:m?o.formatMessage({defaultMessage:"Disable all tools",id:"8A9N39nihk"}):o.formatMessage({defaultMessage:"Enable all tools",id:"x4/g36jIjW"}),onClick:()=>{i(e.tools.map(e=>e.enabledKey),!m,e.url)},skipCloseOnClick:!0,nonSearchable:!0},{key:"divider1",type:"divider",label:""}),h.push(...r),0===h.length&&h.push({key:"empty",type:"button",label:o.formatMessage({defaultMessage:"No tools available",id:"+XSkrzcF/0"}),icon:(0,s.jsx)(c.k0,{size:16}),onClick:()=>void 0,isDisabled:!0}),{...t,type:"toggleGroup",enabledCount:u,totalCount:p,children:h,isChecked:m,onClick:()=>{i(e.tools.map(e=>e.enabledKey),!m,e.url)}}})},V=()=>{var e;let t=null!=(e=(0,_.v)("enabled_mcp_tools"))?e:{},{toggleMcpToolEnabled:a}=(0,M.es)(),{isInBeam:s}=(0,E.d)();return B({showConnectAction:!!s,mcpToolsSetting:t,toggleMcpToolEnabled:a})},K=()=>{var e;let t=(0,I.Uz)({type:"remote"}),a=null!=(e=(0,_.v)("enabled_mcp_tools"))?e:{},[s,n]=(0,v.useState)(()=>{let e=new Set(t.map(e=>e.uuid));return Object.fromEntries(Object.entries(a).filter(t=>{let[a]=t,s=a.split(":")[0];return e.has(s)}))});return{menuOptions:B({showConnectAction:!1,mcpToolsSetting:s,toggleMcpToolEnabled:function(e,t){n(a=>({...a,...Array.isArray(e)?Object.fromEntries(e.map(e=>[e,t])):{[e]:t}}))},remoteOnly:!0}),getEnabledRemoteTools:()=>{let e=[];for(let a of t)for(let t of a.tools)!1!==s[t.enabledKey]&&e.push({tool_name:t.name,server_uuid:a.uuid});return e}}},W=e=>(0,g.useDynamicConfig)("claude_ai_beta_tools").get("beta_tools",[]).includes(e)?"beta":void 0},42e3:(e,t,a)=>{a.d(t,{U:()=>d});var s=a(54568),n=a(41417),l=a(32987),i=a(37463),r=a(7620);let o={FROM_ANCHOR:8,POINTER_OFFSET:18,POINTER_HEIGHT:16},d=e=>{let{anchorRef:t,children:a,side:d,align:u="center",accentColor:m="default",onClose:p,className:h,introDelay:x=0,spacing:g={},buttonText:f,onClickButton:v}=e,y={...o,...g},b=(0,r.useRef)(null),[j,w]=(0,r.useState)(d),[k,M]=(0,r.useState)(u);(0,r.useEffect)(()=>{if(!b.current||!t.current)return;let e=()=>{let{current:e}=b,{current:a}=t;if(!e||!a)return;let s=a.getBoundingClientRect(),n=e.getBoundingClientRect(),l=window.innerWidth,i=window.innerHeight,r=j,o=k,d=0,c=0,u=()=>{d="top"===r?s.top-n.height-y.FROM_ANCHOR:"bottom"===r?s.bottom+y.FROM_ANCHOR:s.top-y.POINTER_OFFSET+.5*s.height-.5*y.POINTER_HEIGHT},m=()=>{if("left"===r)c=s.left-n.width-y.FROM_ANCHOR;else if("right"===r)c=s.right+y.FROM_ANCHOR;else switch(o){case"start":c=s.left-y.FROM_ANCHOR;break;case"center":c=s.left+(s.width-n.width)/2;break;case"end":c=s.right-n.width+y.FROM_ANCHOR}};u(),m(),c<0?"top"===r||"bottom"===r?o="start":r="bottom":c+n.width>l&&("top"===r||"bottom"===r?o="end":r="bottom"),d<0?r="bottom":d+n.height>i&&(r="top"),u(),m(),e.style.top="".concat(d,"px"),e.style.left="".concat(c,"px"),r!==j&&w(r),o!==k&&M(o)};e();let a=new ResizeObserver(e);t.current&&(a.observe(t.current),t.current.parentElement&&a.observe(t.current.parentElement));let s=e=>{if(p){var t;(null==(t=b.current)?void 0:t.contains(e.target))||p()}};return window.addEventListener("resize",e),window.addEventListener("scroll",e),document.addEventListener("click",s,{capture:!0}),()=>{a.disconnect(),window.removeEventListener("resize",e),window.removeEventListener("scroll",e),document.removeEventListener("click",s,{capture:!0})}},[j,k,t,p,y.FROM_ANCHOR,y.POINTER_HEIGHT,y.POINTER_OFFSET]);let _={};switch(j){case"right":_={translateX:-y.FROM_ANCHOR,opacity:0};break;case"left":_={translateX:y.FROM_ANCHOR,opacity:0};break;case"bottom":_={translateY:-y.FROM_ANCHOR,opacity:0};break;case"top":_={translateY:y.FROM_ANCHOR,opacity:0}}return(0,s.jsxs)(i.P.div,{ref:b,initial:_,animate:{translateY:0,translateX:0,opacity:1,transition:{delay:x,type:"spring",stiffness:200,damping:20,mass:1.5,opacity:{ease:"easeOut",duration:.15}}},exit:{scale:.985,opacity:0,filter:"blur(24px)",transition:{ease:"easeIn",duration:.3,opacity:{duration:.2}}},className:(0,l.A)("font-base fixed z-tooltip rounded-xl p-4 border-0.5 shadow-sm max-w-[16.6rem]","default"===m&&"bg-bg-200 border-border-300","secondary"===m&&"text-accent-secondary-000 bg-accent-secondary-900 border-accent-secondary-100/50",h),role:"dialog",style:{willChange:"transform",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"},children:[(0,s.jsx)(c,{side:j,align:k,accentColor:m,spacing:y}),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[a,!!f&&!!v&&(0,s.jsx)(n.$,{variant:"outline",className:(0,l.A)("!gap-0 !text-sm !rounded-lg  !px-3 !min-w-0 !w-fit","secondary"===m&&"!text-accent-secondary-000 !border-accent-secondary-100/30 hover:!bg-accent-secondary-100 hover:!text-oncolor-100"),onClick:()=>{v(),null==p||p()},size:"sm",children:(0,s.jsx)("p",{className:"inline",children:f})})]})]})},c=e=>{let{accentColor:t,side:a,align:n,spacing:i=o}=e,r="fill-bg-200",d="fill-border-300";"secondary"===t&&(r="fill-accent-secondary-900",d="fill-accent-secondary-100/50");let c={};switch(a){case"top":c={top:"100%",left:"50%",marginTop:"-5px",transform:"rotate(-90deg) translateY(-25%)"};break;case"bottom":c={bottom:"100%",left:"50%",marginBottom:"-5px",transform:"rotate(90deg) translateY(25%)"};break;case"right":c={top:i.POINTER_OFFSET};break;case"left":c={top:i.POINTER_OFFSET,left:"100%",transform:"rotate(180deg)"}}if("top"===a||"bottom"===a)switch(n){case"start":c.left=i.POINTER_OFFSET;break;case"end":c.left="auto",c.right=i.POINTER_OFFSET}return(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",height:i.POINTER_HEIGHT,viewBox:"0 0 6 16",className:(0,l.A)("absolute origin-center pointer-events-none","right"===a&&"right-full"),style:c,children:[(0,s.jsx)("path",{className:r,d:"M6 0h-.5v1.55c0 .55-.27 1.06-.71 1.55-.53.6-1.16 1.05-1.79 1.51-.57.42-1.15.85-1.65 1.37C.87 6.48.5 7.06.5 7.74c0 .68.37 1.26.85 1.77.5.52 1.08.94 1.65 1.36.63.47 1.26.93 1.79 1.51.44.5.71 1 .71 1.56V16H6V0Z"}),(0,s.jsx)("path",{className:d,fillRule:"evenodd",clipRule:"evenodd",d:"M6 0v1.55c0 .74-.36 1.36-.85 1.9-1.01 1.13-2.4 1.8-3.44 2.89-.45.47-.71.92-.71 1.4 0 .48.26.93.7 1.4 1.05 1.1 2.44 1.76 3.45 2.89.5.54.85 1.17.85 1.9V16h-.5v-2.06c0-.56-.27-1.06-.71-1.56-1.01-1.12-2.4-1.79-3.44-2.87C.87 9 .5 8.42.5 7.74c0-.68.37-1.26.85-1.76C2.4 4.89 3.78 4.22 4.8 3.1c.44-.5.71-1 .71-1.55V0H6Z"})]})}},42824:(e,t,a)=>{a.d(t,{U:()=>n});var s=a(56147);let n=e=>{let t=(0,s.ED)(e),{maxKbTokens:a}=(0,s.AO)();return void 0!==t&&t>a}},45317:(e,t,a)=>{a.d(t,{x:()=>l});var s=a(42977);function n(){let e=(0,s._)(["\n  font-normal\n  text-[0.65rem]\n  sm:text-xs\n  w-full\n  flex\n  gap-1.5\n  items-center\n  justify-between\n"]);return n=function(){return e},e}let l=a(90510).J.div(n())},45476:(e,t,a)=>{a.d(t,{g:()=>r,x:()=>o});var s=a(77186),n=a(1761),l=a(71473),i=a(87606);let r=()=>{let{account:e,activeOrganization:t}=(0,n.YL)();return(0,s.Sk)("/api/organizations/".concat(null==t?void 0:t.uuid,"/spotlight"),{enabled:!!e,queryKey:[l.vi,null==e?void 0:e.uuid,null==t?void 0:t.uuid]})},o=()=>{let{account:e,activeOrganization:t}=(0,n.YL)(),a=(0,i.useQueryClient)();return(0,s.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/spotlight/action"),"POST",{enabled:!!e,onSuccess:()=>{a.invalidateQueries({queryKey:[l.vi,null==e?void 0:e.uuid,null==t?void 0:t.uuid]})}})}},45483:(e,t,a)=>{a.d(t,{E:()=>p,I:()=>m});var s=a(7726),n=a(98518),l=a(1761),i=a(87606),r=a(76088),o=a.n(r),d=a(62942),c=a(7620),u=a(47492);let m=()=>{let e="new-conversation-params-for-navigation",t=(0,i.useQueryClient)(),a=(0,c.useCallback)(()=>{let t=localStorage.getItem(e);if(!t)return{};try{let e=JSON.parse(t);return o()(e,e=>Date.now()-e.created_at<6e4)}catch(t){localStorage.removeItem(e)}return{}},[]);return{prepareNewConversation:(0,c.useCallback)((s,n)=>{let l={created_at:Date.now(),...n};t.setQueryData([e,s],l);let i=a();i[s]=l;try{localStorage.setItem(e,JSON.stringify(i))}catch(e){}},[t,a]),getCreateParamsForConvo:(0,c.useCallback)(s=>{let n=a(),l=t.getQueryData([e,s])||n[s];t.removeQueries({queryKey:[e,s]});let i=o()(n,(e,t)=>t!==s);return localStorage.setItem(e,JSON.stringify(i)),l},[t,a])}};function p(){var e;let{setTemporaryConversationUUID:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,n.st)(),{data:i}=(0,s.Fn)(),{mutateAsync:r}=(0,s.CW)(),[o,p]=(0,u.d)(),{prepareNewConversation:h}=m(),{account:x}=(0,l.YL)(),g=(0,d.useRouter)();return(0,c.useCallback)(async e=>{var s;let{model:n,project_uuid:l,include_conversation_preferences:d,paprika_mode:c,compass_mode:u,create_mode:m,name:f,is_temporary:v,is_new_beam_chat:y,beam_chat_uuid:b}=e,j=r({uuid:o,name:null!=f?f:"",model:n,project_uuid:l,include_conversation_preferences:d,paprika_mode:c,compass_mode:u,create_mode:m,is_temporary:v,is_new_beam_chat:y,beam_chat_uuid:b});if(h(o,e),await j,v)null==t||t(o);else if((null==x||null==(s=x.settings)?void 0:s.has_finished_claudeai_onboarding)===!1){let e=new URLSearchParams;e.append("returnTo","/chat/".concat(o));let t="/onboarding?".concat(e.toString());g.push(t)}else void 0!==b?g.push("/beam/".concat(b,"/chat/").concat(o)):g.push("/chat/".concat(o));return p(),(null==i?void 0:i.is_first_conversation)&&await a.track({event_key:"chat.conversation.first_conversation_created",surface:"claude.ai"}),{uuid:o}},[r,o,p,i,a,g,h,null==x||null==(e=x.settings)?void 0:e.has_finished_claudeai_onboarding,t])}},47959:(e,t,a)=>{a.d(t,{h:()=>c});var s=a(54568),n=a(10158),l=a(1761),i=a(27261),r=a.n(i);a(7620);var o=a(62971),d=a(1390);function c(){let{allowSelfUpgrade:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(function(e){let t=(0,l.UC)(),a=(0,l.wi)(),s=(0,l.bu)(),i=(0,l.tP)(),r=(0,n.fZ)(),o=(0,d.o)();return r?(i||t)&&e?a||s||i?!t&&s?"subscribe-max":!t&&i?"subscribe-max-20x":"subscribe":"subscribe-pro-only":o?"enable-overages":"none":"contact-sales"}(e)){case"contact-sales":return(0,s.jsx)(u,{});case"subscribe":return(0,s.jsx)(m,{});case"subscribe-pro-only":return(0,s.jsx)(p,{});case"subscribe-max":return(0,s.jsx)(h,{});case"subscribe-max-20x":return(0,s.jsx)(x,{});case"enable-overages":return(0,s.jsx)(g,{});case"none":return null}}function u(){let{websiteBaseUrl:e}=(0,n._r)();return(0,s.jsx)(r(),{href:"".concat(e,"/contact-sales"),className:"underline text-sm",children:(0,s.jsx)(o.A,{defaultMessage:"Contact us to upgrade",id:"VifKcG4Va9"})})}function m(){return(0,s.jsx)(r(),{href:"/upgrade?hide_free=true",className:"underline text-sm",children:(0,s.jsx)(o.A,{defaultMessage:"Upgrade",id:"0h/lPMeYkq"})})}function p(){return(0,s.jsx)(r(),{href:"/upgrade/pro",className:"underline text-sm",children:(0,s.jsx)(o.A,{defaultMessage:"Upgrade",id:"0h/lPMeYkq"})})}function h(){return(0,s.jsx)(r(),{href:"/upgrade?hide_pro=true",className:"underline text-sm",children:(0,s.jsx)(o.A,{defaultMessage:"Subscribe to Max",id:"8ACH3Vf732"})})}function x(){return(0,s.jsx)(r(),{href:"/upgrade",className:"underline text-sm",children:(0,s.jsx)(o.A,{defaultMessage:"Upgrade",id:"0h/lPMeYkq"})})}function g(){return(0,s.jsx)(r(),{href:"/settings/usage",className:"underline text-sm",children:(0,s.jsx)(o.A,{defaultMessage:"Keep working",id:"YJG5oUjsVT"})})}},48367:(e,t,a)=>{a.d(t,{V:()=>aE});var s=a(42977),n=a(54568),l=a(90510),i=a(22529),r=a(52198),o=a(27062),d=a(57646),c=a(32987),u=a(49645),m=a(37463),p=a(7620),h=a(46760),x=a(89836),g=a(53685),f=a(68195),v=a(7409),y=a(7386),b=a(38715);let j=e=>{let{attachments:t,files:a,syncSourceResults:s,onRemoveAttachment:l,onRemoveFile:i,onRemoveSyncSource:r,isUploadingFile:o,isUploadingSync:d}=e;return(0,n.jsxs)("div",{className:"border-border-300/25 border-t-0.5 rounded-b-2xl bg-bg-100 !p-3.5 !m-0 flex flex-row overflow-x-auto gap-3 px-3.5 py-2.5 -my-1",children:[t.map((e,t)=>(0,n.jsx)(v.NM,{file:e,size:"md",onRemoveFile:()=>l(t),isEditable:!0},t)),a.map((e,t)=>(0,n.jsx)(v.NM,{file:e,showWarnings:!0,size:"md",onRemoveFile:()=>i(t),isEditable:!0},e.file_uuid)),(0,n.jsx)(y.NG,{isShown:o}),s.map(e=>{let{syncSource:t,uuid:a}=e;return(0,n.jsx)(b.V,{uuid:a,syncSource:t,onRemove:()=>r(a),isEditable:!0},a)}),(0,n.jsx)(y.NG,{isShown:d})]})};var w=a(57383),k=a(72431),M=a(51291),_=a(42824),A=a(16253),N=a(69916),C=a(77101),S=a(62971),E=a(85717),I=a(48676),T=a(31102),D=a(78217),O=a(93770),L=a(4708),R=a(23661),P=a(94390),z=a(75006),U=a(18900),F=a(85644),G=a(56147);let Y=e=>{var t,a;let{model:s,projectUuid:l}=e,{allModelOptions:i}=(0,F.A9)(),r=(0,G.ED)(l),o=(0,G.Pb)(l),d=null!=(a=null==(t=i.find(e=>e.model===s))?void 0:t.slow_kb_warning_threshold)?a:155e3,c=!o&&(null!=r?r:0)>d?(0,n.jsx)("div",{className:"max-md:hidden",children:(0,n.jsx)(S.A,{defaultMessage:"Large knowledge may slow responses",id:"d6mr4c6d+8"})}):void 0;return(0,n.jsx)("div",{className:"text-text-400 text-xs ml-2",children:null!=c?c:void 0})};var H=a(9896),B=a(1761),V=a(55554),K=a(41417),W=a(56370),q=a(12072),X=a(91961),$=a(84403),J=a(85544),Z=a(37428),Q=a(60265),ee=a(99272),et=a(62094),ea=a(44180),es=a(21036),en=a(61906),el=a(45476),ei=a(62757),er=a(35747),eo=a(45078),ed=a(85201);let ec=e=>{let{remaining:t,total:a}=e,s="".concat(t,"/").concat(a);return(0,n.jsx)("span",{className:"inline-flex items-center text-accent-secondary-000 bg-bg-000 border-0.5 border-border-200 rounded-full px-1.5 py-0.25",children:(0,n.jsx)("span",{className:"text-xs",children:s})})};var eu=a(50707),em=a(40359);let ep=e=>{let{model:t,hideModelNameLogo:a}=e,s=t.name.replace("Claude",""),l=s.startsWith("\uD83E\uDD2B")?(0,n.jsx)(q.Tooltip,{tooltipContent:s,children:(0,n.jsx)("span",{children:"\uD83E\uDD2B"})}):s;return(0,n.jsxs)("div",{className:"font-claude-response inline-flex gap-[3px] text-[14px] h-[14px] leading-none items-baseline",children:[!a&&(0,n.jsx)(em.g,{className:"claude-logo-model-selector block translate-y-[0.5px]",height:11.5}),(0,n.jsx)("div",{className:"flex items-center gap-[4px]",children:(0,n.jsx)("div",{className:"whitespace-nowrap tracking-tight select-none",children:l})})]})};var eh=a(98518),ex=a(42e3),eg=a(62942);let ef=e=>{let{anchorRef:t,onClose:a,onSelectModel:s}=e,l=(0,eg.useRouter)(),d=(0,B.zc)(),c=(0,B.O9)(),m=(0,B.mV)(),{mutateAsync:h}=(0,el.x)(),{allModelOptions:x}=(0,F.A9)(),g=(0,Z.wc)(),{track:f}=(0,eh.st)(),{value:v}=(0,o.fS)("voldemort_luna_lovegood"),y=g[Z.m],b=x.find(e=>e.model===y);(0,p.useEffect)(()=>{b&&v&&f({event_key:"claudeai.model_upsell.tooltip.viewed",model_id:b.model})},[b,v,f]);let j=async()=>{await h({spotlight:$.L.VOLDEMORT_LUNA_LOVEGOOD,action:$.f.DISMISSED}),f({event_key:"claudeai.model_upsell.tooltip.dismissed",model_id:null==b?void 0:b.model}),a()},w=async()=>{a(),await h({spotlight:$.L.VOLDEMORT_LUNA_LOVEGOOD,action:$.f.INTERACTED}),f({event_key:"claudeai.model_upsell.tooltip.clicked",model_id:null==b?void 0:b.model}),l.push("/upgrade")},k=async()=>{b&&s&&s(b.model),a(),await h({spotlight:$.L.VOLDEMORT_LUNA_LOVEGOOD,action:$.f.INTERACTED}),f({event_key:"claudeai.model_upsell.tooltip.clicked",model_id:null==b?void 0:b.model})};return b&&v?(0,n.jsx)(u.N,{children:(0,n.jsxs)(ex.U,{anchorRef:t,side:"bottom",align:"start",onClose:j,introDelay:.2,accentColor:"secondary",children:[(0,n.jsx)(K.$,{variant:"ghost",size:"icon_xs",onClick:j,className:"!absolute !top-2 !right-2 !text-accent-secondary-000 hover:!text-accent-secondary-100 !w-6 !h-6 !p-0 !rounded-md hover:!bg-accent-secondary-100/10",children:(0,n.jsx)(r.X,{size:12})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"font-base-bold text-accent-secondary-000 pr-6",children:(0,n.jsx)(i.YX,{id:"twilight_forest_echo"})}),(0,n.jsx)("p",{className:"font-base text-accent-secondary-000",children:(0,n.jsx)(i.YX,{id:"silver_mountain_breeze"})})]}),(0,n.jsx)("div",{className:"space-y-2",children:c||d||m?(0,n.jsx)(K.$,{variant:"outline",size:"sm",onClick:k,className:"w-full !bg-transparent !border-accent-secondary-200 !text-accent-secondary-000 hover:!bg-accent-secondary-100/10 !rounded-lg font-small-bold",children:(0,n.jsx)(i.YX,{id:"emerald_river_dawn"})}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(K.$,{variant:"outline",size:"sm",onClick:w,className:"w-full !bg-transparent !border-accent-secondary-100 !text-accent-secondary-000 hover:!bg-accent-secondary-100/10 !rounded-lg font-small-bold",children:(0,n.jsx)(i.YX,{id:"crystal_meadow_path"})})})})]})]})}):null};function ev(){let e=(0,s._)(["\n  uppercase\n  mt-0.3\n  bg-accent-pro-100/10\n  text-accent-pro-000\n  rounded-full\n  px-2\n  ml-2\n  -mr-1\n  border-0.5\n  border-accent-pro-100/10\n  leading-4\n  h-4\n  text-[0.6rem]\n  flex-shrink-0\n"]);return ev=function(){return e},e}function ey(){let e=(0,s._)(["\n  border-0.5\n  border-border-300\n  -mr-1\n  ml-2\n  translate-y-px\n  rounded-full\n  px-2\n  py-px\n  text-xs\n  text-text-500\n  tracking-tight\n  group-hover:bg-bg-100\n"]);return ey=function(){return e},e}let eb=l.J.div(ev()),ej=l.J.div(ey()),ew=(0,n.jsx)(S.A,{defaultMessage:"Upgrade to Claude Pro to use our best and latest models",id:"GFsmqWxmnh"}),ek={model:"missing-model",name:"Legacy Model",description:"",inactive:!0},eM=e=>{var t,a;let s,{model:l,currentModelOption:r,opensInNewChat:o,onSelect:d,tag:u,tooltip:m,onUpgradeClick:x}=e,g=(0,h.A)(),f=(0,p.useMemo)(()=>({"haiku-3-5-description":(0,n.jsx)(S.A,{defaultMessage:"Fastest model for daily tasks",id:"75wJbzj8Tm",description:"A description of the AI model"}),"sonnet-3-7-description":(0,n.jsx)(S.A,{defaultMessage:"Our most intelligent model yet",id:"WW0Apyq96E",description:"A description of the AI model"}),"telescope-cinnamon-lampshade":(0,n.jsx)(i.YX,{id:"telescope_cinnamon_lampshade"}),"origami-glacier-marmalade":(0,n.jsx)(i.YX,{id:"origami_glacier_marmalade"})}),[]),{data:v}=(0,en.jc)(),y=(0,B.h0)(),b=(0,es.useLayer)("trials_freemium"),j=l.model===(null==r?void 0:r.model),w=l.name,k=!y,M=b.get("free_opus",!1),_=l.model.startsWith("claude-opus-4");if(_&&k&&M&&v&&void 0!==v.remaining&&v.resets_at){let e=new Date(1e3*v.resets_at),t=g.formatDate(e,{month:"short",day:"numeric"});s=g.formatMessage({defaultMessage:"{remaining} remaining until {date}",id:"httnsxXSeU"},{remaining:v.remaining,date:t})}let A=_&&k&&M&&(null==v?void 0:v.remaining)===0,N=A?"Upgrade":u;return(0,n.jsx)(q.Tooltip,{tooltipContent:m,side:"right",children:(0,n.jsxs)(W.tJ,{onClick:()=>{j||N||A?("Upgrade"===N||"PRO"===N||A)&&(null==x||x()):d(l)},className:(0,c.A)("group pr-1 py-1.5",("Upgrade"===N||"PRO"===N||A)&&"cursor-pointer"),disabled:A&&"Upgrade"!==N,children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"flex-1 text-sm",children:(0,n.jsx)("div",{className:"flex items-center gap-1.5",children:(0,n.jsx)("div",{children:w})})}),N&&!j&&"Upgrade"===N?(0,n.jsx)(eu.M,{as:"button",className:"mt-0.3 ml-2 -mr-1 flex-shrink-0",onClick:e=>{e.stopPropagation(),null==x||x()}}):N&&!j?(0,n.jsx)(eb,{children:N}):null,!j&&o&&!N&&!A&&(0,n.jsx)(ej,{children:(0,n.jsx)(S.A,{defaultMessage:"New chat",id:"ATDyLPIoxz"})})]}),(0,n.jsxs)("div",{className:"text-text-500 pr-4 text-xs mt-1",children:[null!=(a=f[null!=(t=l.description_i18n_key)?t:""])?a:l.description,s&&(0,n.jsx)("div",{className:"mt-0.5",children:s})]})]}),j&&(0,n.jsx)(Q.J,{className:"text-accent-secondary-100 mb-1 mr-1.5",size:16,weight:"bold"})]})})},e_=e=>{let{models:t,currentModelOption:a,opensInNewChat:s,handleModelSelect:l,hasMultiModalContent:r,upsellMode:o}=e,d=(0,p.useMemo)(()=>({"velvet-bicycle-thunderstorm":(0,n.jsx)(i.YX,{id:"velvet_bicycle_thunderstorm"})}),[]),c=(0,ed.Ob)(),u=(0,B.h0)(),m=(0,es.useLayer)("trials_freemium").get("free_opus",!1),h=!u,x=()=>{window.location.href="/upgrade"};return(0,n.jsx)(n.Fragment,{children:t.map(e=>(0,n.jsx)(eM,{model:e,currentModelOption:a,opensInNewChat:s,onSelect:l,hasMultiModalContent:r,tag:o&&e.model!==(null==a?void 0:a.model)&&h&&!(m&&e.model.startsWith("claude-opus-4")||e.model.startsWith("claude-sonnet-4"))?c?"Upgrade":"PRO":void 0,tooltip:(e=>{var t,s;return o&&e.model!==(null==a?void 0:a.model)&&h&&!(m&&e.model.startsWith("claude-opus-4")||e.model.startsWith("claude-sonnet-4"))?ew:null!=(s=d[null!=(t=e.notice_text_i18n_key)?t:""])?s:e.notice_text})(e),onUpgradeClick:x},e.model))})},eA=e=>{let{selectedModel:t,conversationUuid:a,onSelect:s,placement:l,hasMultiModalContent:i,open:r,onOpenChange:d,isNewConversation:u,hideModelNameLogo:h}=e,x=!u,{allModelOptions:g,mainModels:f,overflowModels:v}=(0,F.A9)(),y=(0,D.Z3)(a||null),b=null!=t?t:y,j=(0,p.useRef)(null),[w,k]=(0,p.useState)(!1),M=(0,eo.v)("paprika_mode"),_=(0,er.j)(),A=(0,ei.G8)(),{toggleConversationSetting:N}=(0,eo.r)(),C=(0,Z.wc)(),{mutateAsync:E}=(0,el.x)(),I=g.find(e=>e.model===b);I||(I=ek);let{value:T}=(0,o.fS)("model_selector_enabled"),O=(0,B.h0)(),{selectedTier:L,shouldOverrideFeatureAccess:R,isTierSelectorEnabled:P}=(0,V.t)(),z=P&&R&&!!L,U=z?L===J.d7.FREE:!T&&!O,G=(0,es.useLayer)("trials_freemium").get("free_opus",!1),{data:Y}=(0,en.jc)(),{setStickyModelPreference:q}=(0,H.F)(),[Q,ed]=(0,p.useState)(!1),{value:eu}=(0,o.fS)("voldemort_luna_lovegood"),{data:em}=(0,el.g)(),eh=b.startsWith("claude-opus-4")&&!O&&G&&Y&&void 0!==Y.remaining&&void 0!==Y.limit;(0,p.useEffect)(()=>{eu&&(null==em?void 0:em.spotlight)===$.L.VOLDEMORT_LUNA_LOVEGOOD&&(I.model===C[Z.m]?E({spotlight:$.L.VOLDEMORT_LUNA_LOVEGOOD,action:$.f.NOT_TARGETED}).catch(e=>(0,ea.Cp)(e,{extra:{message:"Failed to set spotlight action",spotlight:$.L.VOLDEMORT_LUNA_LOVEGOOD,action:$.f.NOT_TARGETED}})):k(!0))},[null==em?void 0:em.spotlight,eu,I,C,E]);let ex=e=>{let t=!O&&G;(T||z&&"free"!==L||t)&&(M&&!_(e.model)&&N("paprika_mode",null),A(e.model)||N("compass_mode",null),q(e.model),s(e))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(W.ms,{className:(0,c.A)("!min-w-[17rem] relative"),..."bottom"===l?{side:"top",sideOffset:4}:{side:"bottom",sideOffset:4},align:"end",unstyledTrigger:!0,onCloseAutoFocus:e=>e.preventDefault(),open:r,onOpenChange:e=>{d&&d(e),e||ed(!1)},trigger:(0,n.jsx)(m.P.div,{initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:700,damping:32,mass:.7},className:"overflow-hidden shrink-0 p-1 -m-1",children:(0,n.jsxs)(K.$,{ref:j,variant:"unstyled",size:"unset","data-testid":"model-selector-dropdown",className:(0,c.A)("h-7 border-0.5 text-text-100 ml-1.5 inline-flex items-start gap-[0.175em] rounded-md border-transparent text-sm opacity-80 transition hover:opacity-100 disabled:!opacity-80 hover:bg-bg-100 hover:border-border-400 px-1.5"),children:[(0,n.jsx)(ep,{model:I,hideModelNameLogo:h}),eh&&(0,n.jsx)(ec,{remaining:Y.remaining,total:Y.limit}),(0,n.jsx)(ee.a,{size:12,className:"text-text-500 shrink-0"})]})}),children:[(0,n.jsx)(e_,{models:f,currentModelOption:I,opensInNewChat:x,handleModelSelect:ex,hasMultiModalContent:i,upsellMode:U}),v.length>0&&((0,X.Fr)()?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.DG,{}),(0,n.jsx)("div",{className:"text-xs text-text-500 pt-2 pb-1 px-2",children:(0,n.jsx)(S.A,{defaultMessage:"More models",id:"9yxvA9+l6B"})}),(0,n.jsx)(e_,{models:v,currentModelOption:I,opensInNewChat:x,handleModelSelect:ex,hasMultiModalContent:i,upsellMode:U})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.DG,{}),(0,n.jsxs)(W.MS,{children:[(0,n.jsxs)(W.Wn,{className:"pl-2 py-1.5 gap-2",children:[(0,n.jsx)("div",{className:"group-hover:text-text-100  text-sm",children:(0,n.jsx)(S.A,{defaultMessage:"More models",id:"9yxvA9+l6B"})}),(0,n.jsx)(et.K,{className:"text-text-500 group-hover:text-text-300 mr-1",size:16})]}),(0,n.jsx)(W.cm,{children:(0,n.jsx)(W.FV,{sideOffset:4,children:(0,n.jsx)(e_,{models:v,currentModelOption:I,opensInNewChat:x,handleModelSelect:ex,hasMultiModalContent:i,upsellMode:U})})})]})]}))]}),w&&(0,n.jsx)(ef,{anchorRef:j,onClose:()=>k(!1),onSelectModel:e=>{let t=g.find(t=>t.model===e);t&&ex(t)}})]})};var eN=a(9340),eC=a(95663),eS=a(82327),eE=a(6157),eI=a(37076);let eT=e=>{let{isOpen:t,onClose:a,onConfirm:s,isLoading:l=!1}=e,i=(0,p.useCallback)(e=>{"Enter"!==e.key||l||s()},[s,l]);return(0,p.useEffect)(()=>(t&&window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)}),[t,i]),(0,n.jsxs)(eI.aF,{isOpen:t,onClose:a,title:(0,n.jsx)(S.A,{defaultMessage:"Want to stop researching?",id:"H+/TRHeeuc"}),children:[(0,n.jsx)("div",{className:"mt-4 mb-6",children:(0,n.jsx)(S.A,{defaultMessage:"This can’t be undone. If you want to research this topic again, you can ask in this chat or start a new session.",id:"RuV1dagwp6"})}),(0,n.jsxs)(eI.vW,{children:[(0,n.jsx)(K.$,{variant:"danger",onClick:s,disabled:l,autoFocus:!0,children:(0,n.jsx)(S.A,{defaultMessage:"Stop research",id:"l3tljn/kXe"})}),(0,n.jsx)(K.$,{variant:"secondary",onClick:a,children:(0,n.jsx)(S.A,{defaultMessage:"Keep researching",id:"ODR/0L48DC"})})]})]})},eD=e=>{let{prompt:t,files:a,attachments:s,syncSourceUuids:l,conversation:i,onSend:r,onStop:o,isSending:d,isDisabled:c,disabledReason:m,currentCompassTask:p}=e,h=(()=>{if(p)return"researching";if(i){let{isSampling:e,isStoppingSampling:t}=i;if(e)return t?"stopping":"sampling"}return t.length>0||a.length>0||s.length>0||l.length>0?"drafting":"empty"})();return(0,n.jsx)(u.N,{children:"sampling"===h||"stopping"===h?(0,n.jsx)(eL,{onStop:o,isLoading:"stopping"===h},"stop"):"researching"===h?(0,n.jsx)(eO,{conversationId:null==i?void 0:i.id,taskId:p},"stop_research"):(0,n.jsx)(eR,{isSending:d,isDisabled:c,disabledReason:m,onSend:r},"send")})},eO=e=>{let{conversationId:t,taskId:a}=e,s=(0,h.A)(),[l,i]=(0,p.useState)(!1),{mutate:r,isPending:o}=(0,ei.hs)(t,null!=a?a:""),d=(0,p.useCallback)(()=>{t&&a&&(r(),i(!1))},[t,a,r]),c=(0,p.useCallback)(()=>{i(!0)},[]);return(0,p.useEffect)(()=>{let e=e=>{"Escape"!==e.key||o||i(!0)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[o]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(q.Tooltip,{tooltipContent:(0,n.jsx)(S.A,{defaultMessage:"Stop Claude response",id:"BonFmr6O3r"}),keyboardShortcut:"Esc",children:(0,n.jsx)(K.$,{variant:"secondary",size:"icon_sm",className:"!rounded-lg",onClick:c,"aria-label":s.formatMessage({defaultMessage:"Stop response",id:"RANC4/S/j1"}),children:o?(0,n.jsx)(eC.N,{className:"animate-spin",size:18}):(0,n.jsx)(eS.X,{weight:"bold",size:16})})}),(0,n.jsx)(eT,{isOpen:l,onClose:()=>i(!1),onConfirm:d,isLoading:o})]})},eL=e=>{let{onStop:t,isLoading:a}=e,s=(0,h.A)();return(0,p.useEffect)(()=>{let e=e=>{"Escape"!==e.key||a||t()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t,a]),(0,n.jsx)(q.Tooltip,{tooltipContent:(0,n.jsx)(S.A,{defaultMessage:"Stop Claude response",id:"BonFmr6O3r"}),keyboardShortcut:"Esc",children:(0,n.jsx)(K.$,{variant:"secondary",size:"icon_sm",className:"!rounded-lg",onClick:()=>t(),"aria-label":s.formatMessage({defaultMessage:"Stop response",id:"RANC4/S/j1"}),children:a?(0,n.jsx)(eC.N,{className:"animate-spin",size:18}):(0,n.jsx)(eS.X,{weight:"bold",size:16})})})},eR=e=>{let{isSending:t,isDisabled:a,disabledReason:s,onSend:l}=e,i=(0,h.A)(),r=(0,p.useCallback)(()=>{(0,eN.R)("event","msg_sent",{location:"chat_input"}),l()},[l]);return(0,n.jsx)(m.P.div,{initial:{scale:.3,opacity:0},animate:{scale:1,opacity:1,transition:{delay:.15,scale:{type:"spring",stiffness:600,damping:30},opacity:{duration:.1}}},children:(0,n.jsx)(q.Tooltip,{tooltipContent:s,children:(0,n.jsx)("div",{children:(0,n.jsx)(K.$,{variant:"flat",size:"icon_sm",className:"!rounded-lg !h-8 !w-8",disabled:a,onClick:()=>r(),"aria-label":i.formatMessage({defaultMessage:"Send message",id:"Xx0WZVz8QS"}),children:t?(0,n.jsx)(eC.N,{className:"animate-spin",weight:"bold",size:16}):(0,n.jsx)(eE.D,{weight:"bold",size:16})})})})})};var eP=a(46127);a(97509);var ez=a(66436);let eU=e=>{let{style:t,children:a,duration:s=200,delay:l=0,easing:i="ease-in-out",className:r="",onTransitionEnd:o=()=>void 0}=e,d=(0,p.useRef)(null),[c,u]=(0,p.useState)("auto"),m=(0,p.useRef)(null);return(0,p.useEffect)(()=>{if(d.current)return m.current=new ResizeObserver(e=>{for(let t of e){let e=t.contentRect.height;u("".concat(e,"px"))}}),m.current.observe(d.current),()=>{m.current&&m.current.disconnect()}},[]),(0,n.jsx)("div",{style:{height:c,transitionDelay:"".concat(l,"ms"),transitionTimingFunction:i,transitionDuration:"".concat(s,"ms"),transitionProperty:"height",...t},className:r,onTransitionEnd:()=>{o()},children:(0,n.jsx)("div",{className:"w-full",ref:d,children:a})})};var eF=a(98769),eG=a(48498),eY=a(92947),eH=a(92111),eB=a(28042),eV=a(20434),eK=a(12331),eW=a(76761);let eq=p.forwardRef((e,t)=>{let{indicatorActive:a,disabled:s,text:l,tag:i,className:r,buttonClassName:o,tooltip:d,hideIndicatorText:u,icon:p,showRemoveIcon:h,showCaretIcon:x,...g}=e,f=(0,n.jsx)(m.P.div,{className:(0,c.A)("flex",l?"shrink min-w-8":"shrink-0",r),initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:700,damping:32,mass:.7},children:(0,n.jsxs)(K.$,{variant:"unstyled",size:"unset",className:(0,c.A)("border-0.5 transition-all h-8 min-w-8 rounded-lg flex items-center px-[7.5px] group !pointer-events-auto !outline-offset-1",a?"text-accent-secondary-100 bg-accent-secondary-100/[8%] border-accent-secondary-200/20":"text-text-300 border-border-300",!s&&(a?"active:scale-[0.98] hover:text-accent-secondary-000 hover:bg-accent-secondary-100/[12%]":"active:scale-[0.98] hover:text-text-200/90 hover:bg-bg-100"),o),disabled:s,"aria-pressed":a,...g,children:[p,!!l&&!u&&(0,n.jsxs)("div",{className:"min-w-0 flex items-center",children:[(0,n.jsx)("p",{className:"min-w-0 pl-1 text-xs tracking-tight text-ellipsis whitespace-nowrap break-words overflow-hidden shrink",children:l}),!!i&&(0,n.jsx)(ez.u,{tag:i,className:"!top-0 !ml-1"})]}),x&&(0,n.jsx)(ee.a,{size:12,className:"ml-1 opacity-70"}),!s&&h&&(0,n.jsx)("div",{className:"duration-100 w-0 group-hover:w-3 opacity-0 group-hover:opacity-70 transition-all ml-0 group-hover:ml-1",children:(0,n.jsx)(eW.X,{size:12})})]})});return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(q.Tooltip,{tooltipContent:d,disableHoverableContent:!0,side:"bottom",align:"center",children:f})})});eq.displayName="InputMenuButton";var eX=a(38583);let e$=e=>{let{path:t}=e,a={drive:(0,h.A)().formatMessage({defaultMessage:"Paste a Drive link in the chat to upload it",id:"ZJxjEilF0C"})},s=t&&t in a?a[t]:null;return s?(0,n.jsxs)("div",{className:"w-full bg-bg-100 border-t-0.5 border-border-300 opacity-80 text-text-500 flex flex-row items-center gap-2.5 px-3 py-1 font-small",children:[(0,n.jsx)(eX.R,{size:14}),s]}):null};var eJ=a(73817),eZ=a(24871),eQ=a(22387);let e0=e=>{let{tooltip:t,text:a,tag:s,showCaretIcon:l,indicatorActive:i=!1,hideIndicatorText:o,canShowDot:d,onDoubleClick:c,menuType:u,menuView:x,inputMenuIsOpen:g,setInputMenuIsOpen:f}=e,v=(0,h.A)(),y=(0,p.useRef)(null),{rootItems:b}=x,j={indicatorActive:i,text:a||"",tooltip:t},w=(0,ed.gB)(),k="tools"===u&&w;if(k){j.tooltip=v.formatMessage({defaultMessage:"Style",id:"7mL9QEUFav"});let e=b.find(e=>"option"===e.type&&e.isChecked);e&&"Default"!==e.key&&(j.indicatorActive=!0,j.text=e.label)}let M=b.filter(e=>{let{indicatorActive:t}=e;return t}).length,_=(0,n.jsxs)("div",{className:"flex flex-row items-center justify-center gap-1",children:["plus"===u?(0,n.jsx)(m.P.div,{animate:{rotate:45*!!g},transition:{type:"spring",stiffness:650,damping:32,duration:.1},children:(0,n.jsx)(eZ.F,{size:16})}):"research"===u?(0,n.jsx)(r.is,{size:16}):k?(0,n.jsx)(r.P_,{size:16}):(0,n.jsx)(eQ.l,{size:16}),(0,n.jsx)(e1,{isShown:d&&M>0})]}),A="plus"===u?v.formatMessage({defaultMessage:"attachments",id:"whkEDsy4V6",description:"Menu heading that will be used within the string ‘Open {menuType} menu’"}):"research"===u?v.formatMessage({defaultMessage:"research",id:"PUcnDUZD0/",description:"Menu heading that will be used within the string ‘Open {menuType} menu’"}):k?v.formatMessage({defaultMessage:"styles",id:"G91kUvt+GD",description:"Menu heading that will be used within the string ‘Open {menuType} menu’"}):v.formatMessage({defaultMessage:"tools",id:"yd3KUET1r+",description:"Menu heading that will be used within the string ‘Open {menuType} menu’"});return(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(eq,{tag:s,showCaretIcon:l,hideIndicatorText:!!o,icon:_,id:"input-".concat(u,"-menu-trigger"),ref:y,onClick:()=>{f(!g)},onKeyDown:e=>{g||"Space"!==e.code&&"ArrowDown"!==e.code||f(!0)},onDoubleClick:c?e=>{e.preventDefault(),null==c||c()}:void 0,"aria-expanded":g,"aria-haspopup":"listbox","aria-controls":"input-menu","data-testid":"input-menu-".concat(u),"aria-label":v.formatMessage({defaultMessage:"Open {menuType} menu",id:"Larie1pvYJ"},{menuType:A}),...j})})},e1=e=>{let{isShown:t}=e;return!!t&&(0,n.jsx)(m.P.div,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},children:(0,n.jsx)("div",{className:"h-1.5 w-1.5 bg-accent-secondary-200 rounded-full mr-0.5"})})};var e2=a(73212),e5=a(38807),e7=a(33562);let e6={forward:{initial:{x:"20%",opacity:0},animate:{x:0,opacity:1}},back:{initial:{x:"-20%",opacity:0},animate:{x:0,opacity:1}},none:{initial:{x:0},animate:{x:0}}},e4=e=>{let{placement:t,canShowDot:a}=e,s=(0,p.useRef)(null),l=(0,h.A)(),i=(0,e5.tl)(),r=(0,eY.AY)(),o=(0,eY.M8)();return(0,n.jsxs)("div",{ref:s,children:[(0,n.jsx)(te,{canShowDot:a,placement:t,menuType:"tools",...i,tooltip:l.formatMessage({defaultMessage:"Search and tools",id:"lhFEU+uT6i"})}),(0,n.jsx)(eH.V,{canShowNux:o,anchorRef:s,side:"bottom",text:l.formatMessage({defaultMessage:"Add your everyday tools and apps to get the best out of Claude",id:"olaMSdwPL6"}),id:"research-rmcp-tools-nux-1",nuxItem:{dateAdded:"2025-05-14",priority:eV.c.HIGH,showAfterOthersDismiss:!0}}),(0,n.jsx)(eH.V,{canShowNux:r,anchorRef:s,side:"bottom",text:l.formatMessage({defaultMessage:"MCP is here now! Access integrations in this menu.",id:"NkJar0wFk+"}),id:"mcp-tools-nux-1",nuxItem:{dateAdded:"2025-04-29",priority:eV.c.HIGH,showAfterOthersDismiss:!0}})]})},e3=e=>{let{placement:t,canShowDot:a}=e,s=(0,e5.CH)();return(0,n.jsx)(te,{placement:t,menuType:"plus",canShowDot:a,...s})},e8=e=>{let t,{hideIndicatorText:a}=e,s=(0,h.A)(),{conversation:l,model:i,setModel:o}=(0,w.oM)(),d=(0,eo.v)("compass_mode"),{toggleConversationSetting:c}=(0,eo.r)(),u=(0,ei.g7)(),m=(0,ei.BU)(),p=(0,ei.Gm)(l),x=(0,D.Z3)((null==l?void 0:l.id)||null),g=(0,ei.G8)()(null!=i?i:x),f=(0,ei.G8)()(x),v=!l&&!g&&f;if(!u)return null;m?p?g||v||(t=s.formatMessage({defaultMessage:"Select a different model to use this feature",id:"/9vSDy2Wm0"})):t=s.formatMessage({defaultMessage:"Enable a search integration to use research",id:"WyiVeak7w5"}):t=s.formatMessage({defaultMessage:"Your administrator must enable a search tool to use research",id:"CzjOV5rgPZ"});let y=!!t;return(0,n.jsx)(eq,{disabled:y,tooltip:t,hideIndicatorText:!!a,icon:(0,n.jsx)(r.is,{size:16}),onClick:()=>{y||(v&&o(x),c("compass_mode","advanced"===d?null:"advanced"))},indicatorActive:!y&&"advanced"===d,text:s.formatMessage({defaultMessage:"Research",id:"JEe7dVso7F"}),className:"!shrink-0"})},e9={id:"mcp-add-connectors-nux",nuxItem:{dateAdded:"2025-07-11",priority:eV.c.HIGH,showAfterOthersDismiss:!0}},te=e=>{let{text:t,tag:a,showCaretIcon:s,indicatorActive:l,canShowDot:i,hideIndicatorText:r,tooltip:o,placement:d,menuType:h,path:x,menuView:g,highlightedItemKey:f,setHighlightedItemKey:v,handleClickItem:y,inputMenuIsOpen:b,setInputMenuIsOpen:j,inputMenuSearchQuery:w,setInputMenuSearchQuery:k,handleBack:M,animationDirection:_}=e,{currentItems:A}=g,N=(0,eG.L)(()=>{j(!1)},["mouseup","touchend"]),C=(0,p.useRef)(null),E=(0,p.useRef)(null),I=(0,p.useRef)(null),T=(0,p.useRef)(null),[D,O]=(0,p.useState)(void 0),[L,R]=(0,p.useState)("bottom"===d?"top":"bottom"),[P,z]=(0,p.useState)(0),U=(0,eg.useSearchParams)(),{shouldShow:F}=(0,eK.z)(e9.id,e9.nuxItem),G="true"===U.get(eB.HU)&&F&&"tools"===h;(0,p.useEffect)(()=>{G&&(j(!0),I.current&&(I.current.scrollTop=I.current.scrollHeight))},[G,j]),(0,p.useEffect)(()=>{if(!C.current||!E.current)return;let e=C.current.getBoundingClientRect(),{updatedHeightAvailable:t,updatedDropdownSide:a}=tt({placement:d,triggerRectTop:e.top,triggerRectBottom:e.bottom});O(Math.min(422,t)),R(a);let s=E.current.getBoundingClientRect();z(Math.min(0,window.innerWidth-s.right-8))},[d,b]);let Y=(0,ed.Hd)(),H=("plus"===h||"tools"===h)&&Y?(0,n.jsx)(eJ.s,{path:x,inputMenuSearchQuery:w,setInputMenuSearchQuery:k,handleBack:M}):null;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"relative shrink-0",onClick:e=>{e.preventDefault()},ref:N,children:[(0,n.jsx)("div",{ref:C,children:(0,n.jsx)(e0,{tag:a,tooltip:o,text:t,showCaretIcon:s,indicatorActive:l,hideIndicatorText:r,canShowDot:i,menuType:h,menuView:g,inputMenuIsOpen:b,setInputMenuIsOpen:j,onDoubleClick:"plus"===h?()=>(0,e7.U_)(d):void 0})}),(0,n.jsx)("div",{ref:E,className:(0,c.A)("w-[20rem] absolute max-w-[calc(100vw-16px)]","top"===L?"bottom-10":"top-10",b?"block":"hidden"),children:(0,n.jsx)(u.N,{children:b&&(0,n.jsx)(m.P.div,{ref:I,initial:{opacity:0,scale:.95,y:"top"===L?8:-8,x:-8},animate:{opacity:1,scale:1,y:0,x:0},exit:{opacity:0,scale:.95,y:"top"===L?8:-8,x:-8},transition:{type:"spring",stiffness:650,damping:23,mass:.6,height:{ease:"easeInOut"}},className:(0,c.A)("relative w-full will-change-transform h-auto overflow-y-auto overscroll-auto flex z-dropdown bg-bg-000 rounded-xl overflow-hidden border-border-300 border-0.5 shadow-diffused shadow-[hsl(var(--always-black)/6%)]","top"===L?"flex-col-reverse":"flex-col"),onMouseEnter:()=>v(null),style:{maxHeight:D?"".concat(D,"px"):void 0,left:P},onClick:e=>{e.stopPropagation(),(0,e2.l)()},children:(0,n.jsxs)(eU,{duration:100,className:(0,c.A)("flex flex-col min-h-0 w-full !ease-out","top"===L?"justify-end":"justify-start"),children:[(0,n.jsxs)("div",{className:"p-1.5 flex flex-col",children:["bottom"===L&&H,(0,n.jsx)(m.P.div,{variants:e6[_],initial:"initial",animate:"animate",className:"flex flex-col",transition:{x:{duration:.15,ease:eF.A.outCirc},opacity:{duration:.25,ease:"easeInOut"}},children:("top"===L?[...A].reverse():A).filter(e=>{let{menuItemHidden:t}=e;return!t}).map(e=>"addIntegrations"===e.key?(0,n.jsx)("div",{ref:T,children:(0,n.jsx)(ez.$,{item:e,onClick:()=>y(e),isHighlighted:f===e.key})},e.key):(0,n.jsx)(ez.$,{item:e,onClick:()=>y(e),isHighlighted:f===e.key},e.key))},null!=x?x:"root"),"top"===L&&H]}),(0,n.jsx)(e$,{path:x})]})})})})]}),(0,n.jsx)(eH.V,{canShowNux:G&&!!T.current&&b,anchorRef:T,side:"right",text:(0,n.jsx)(S.A,{defaultMessage:"Find and add more of your favorite tools in <span>Add connectors</span>.",id:"2icgWBPsqj",values:{span:e=>(0,n.jsx)("span",{className:"font-bold",children:e})}}),...e9})]})},tt=e=>{let{placement:t,triggerRectTop:a,triggerRectBottom:s}=e,n=window.innerHeight-s-8-8;if("bottom"===t){let e=a-76-8;return e<160&&n>e?{updatedDropdownSide:"bottom",updatedHeightAvailable:n}:{updatedDropdownSide:"top",updatedHeightAvailable:e}}{let e=a-8-8;return n<160&&e>n?{updatedDropdownSide:"top",updatedHeightAvailable:e}:{updatedDropdownSide:"bottom",updatedHeightAvailable:n}}};a(62370),a(81527),a(53861);var ta=a(98682);let ts=e=>{let{menuItem:t,handleClick:a,limitInfo:s,...l}=e,{handleClickItem:i}=(0,e5.CH)();if(!t||t.isDisabled||"pro"===t.tag||"new chat"===t.tag||!t.indicatorActive)return null;let{indicatorActive:r}=t,o=!!t.menuItemHidden,d=s?(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[l.icon,(0,n.jsx)(ec,{remaining:s.remaining,total:s.total})]}):l.icon;return(0,n.jsx)(eq,{onClick:null!=a?a:()=>i(t),indicatorActive:r,disabled:o,showRemoveIcon:!0,...l,icon:d})};a(34211);let tn=e=>{let{hideIndicatorText:t,hideIndicators:a}=e,s=(0,h.A)();return((0,o.fS)("claudeai_beam").value,a)?null:(0,n.jsx)(ta.o,{children:(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2 min-w-0",children:[(0,n.jsx)(tl,{}),(0,n.jsx)(ti,{itemKey:J.xd.COMPASS,tooltip:s.formatMessage({defaultMessage:"Research mode",id:"lYf0AUt2RH"})}),(0,n.jsx)(tr,{hideIndicatorText:t}),(0,n.jsx)(to,{hideIndicatorText:t}),""]})})},tl=()=>{let e=(0,h.A)(),{menuView:{rootItems:t}}=(0,e5.tl)(),a=(0,B.h0)(),s=(0,es.useLayer)("trials_freemium"),{data:l}=(0,en.EY)(),i=t.find(e=>e.key===J.xd.EXTENDED_THINKING),r=(0,o.P0)("thinking_sticky_default_on","hide_thinking_chat_indicator",!1,o.e_);if(!i||r)return null;let d=s.get("free_thinking",!1),c=!a&&d&&l&&void 0!==l.remaining&&void 0!==l.limit&&i.indicatorActive;return(0,n.jsx)(ts,{hideIndicatorText:!0,menuItem:i,icon:i.icon,tooltip:e.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),limitInfo:c?{remaining:l.remaining,total:l.limit}:null})},ti=e=>{let{itemKey:t,tooltip:a}=e,{menuView:{rootItems:s}}=(0,e5.CH)(),{menuView:{rootItems:l}}=(0,e5.tl)(),i=[...s,...l].find(e=>e.key===t);return i?(0,n.jsx)(ts,{hideIndicatorText:!0,menuItem:i,icon:i.icon,tooltip:a}):null},tr=e=>{let{hideIndicatorText:t}=e,{menuView:{rootItems:a}}=(0,e5.tl)(),s=(0,e7.pi)(),l=a.find(e=>"styles"===e.key);return l&&"optionGroup"===l.type?(0,n.jsx)(ts,{hideIndicatorText:t,menuItem:l,icon:(0,n.jsx)(r.P_,{size:16}),text:l.secondaryText,buttonClassName:"!shrink",handleClick:()=>s("Default")}):null},to=e=>{let{hideIndicatorText:t}=e,{menuView:{rootItems:a}}=(0,e5.CH)(),s=(0,e7.$V)(),l=a.find(e=>e.key===J.xd.PROJECTS);return l&&"optionGroup"===l.type?(0,n.jsx)(ts,{hideIndicatorText:t,menuItem:l,icon:(0,n.jsx)(r.Jt,{size:16}),text:l.secondaryText,buttonClassName:"!shrink-[2]",handleClick:()=>s(void 0)}):null},td=z.z.object({enabled:z.z.boolean(),system_prompt:z.z.string().optional()}),tc=e=>{let{placement:t,isDisabled:a}=e,s=(0,h.A)(),{value:l}=(0,o.fS)("claudeai_beam");(0,o.iW)("prompt_improver_config",{enabled:!1},td);let{projectUuid:i,prompt:r,model:d,setModel:c,attachments:u,files:m,syncSourceUuids:x,sendMessage:g,stopSampling:f,conversation:v,isSending:y,isChatSyncing:b,isProjectSyncing:j,isModelSelectorOpen:k,setIsModelSelectorOpen:M,isNewConversation:_,currentCompassTask:A,improvePrompt:N,isImprovingPrompt:C}=(0,w.oM)(),S=b||j?s.formatMessage({defaultMessage:"Syncing knowledge...",id:"QuwefnZNVj"}):void 0,E=(0,p.useMemo)(()=>{var e;return[...m,...null!=(e=null==v?void 0:v.files)?e:[]].some(e=>e.file_kind===R.M.Image||e.file_kind===R.M.SanitizedDocument)},[m,v]),I=(0,p.useCallback)(e=>c(e.model),[c]),[T,D]=(0,P.w)({box:"border-box"}),O=D.width||null,L=null===O||O<480,z=null===O||O<396;return(0,U.QJ)(),(0,n.jsxs)("div",{className:"flex gap-2.5 w-full items-center",ref:T,children:[(0,n.jsxs)("div",{className:"relative flex-1 flex items-center gap-2 shrink min-w-0",children:[(0,n.jsx)(e3,{placement:t,canShowDot:null!==O&&z}),(0,n.jsx)(e4,{placement:t,canShowDot:null!==O&&z}),"",(0,n.jsx)(e8,{hideIndicatorText:L}),"",null!==O&&(0,n.jsx)(tn,{hideIndicatorText:L,hideIndicators:z}),(0,n.jsx)(Y,{model:d,projectUuid:i})]}),(0,n.jsx)(eA,{selectedModel:d,onSelect:I,hasMultiModalContent:E,placement:t,open:k,onOpenChange:M,isNewConversation:_,hideModelNameLogo:null!==O&&O<440}),(0,n.jsx)(eD,{isSending:y,isDisabled:a,disabledReason:S,prompt:r,files:m,attachments:u,syncSourceUuids:x,conversation:v,currentCompassTask:A,onSend:()=>g(),onStop:()=>f()})]})};var tu=a(82200),tm=a(29292);let tp=()=>{let{onDrop:e}=(0,w.oM)();return(0,n.jsx)(tu.wC,{onDrop:e,children:(0,n.jsx)(th,{})})},th=()=>{let{dragState:e}=(0,tu.t1)(),t=e===tu.mq.DRAGGING_ON_TARGET,a=e===tu.mq.DRAGGING_OFF_TARGET||e===tu.mq.DRAGGING_ON_TARGET;return a?(0,n.jsx)(u.N,{children:a&&(0,n.jsx)(m.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"absolute top-0 border border-dashed bg-clip-padding rounded-2xl min-h-4 h-full w-full border-accent-secondary-100 bg-bg-000 overflow-hidden z-10",children:(0,n.jsx)("div",{className:(0,c.A)("flex items-center justify-center h-full w-full transition-colors",t?"bg-accent-secondary-900":"bg-accent-secondary-900/50"),children:(0,n.jsxs)("p",{className:"text-accent-secondary-100 flex flex-row items-center gap-2.5",children:[(0,n.jsx)(tm._,{size:20,className:"opacity-50"}),(0,n.jsx)(S.A,{defaultMessage:"Drop files here to add to chat",id:"IYBR/J+nuA"})]})})},"chat-input-drop-zone-overlay")}):null};var tx=a(77186),tg=a(45727),tf=a(15964),tv=a(45986),ty=a.n(tv),tb=a(70659),tj=a(73347);function tw(e){var t,a;let{isOpen:s,onClose:l,prompt:i,serverUuid:r}=e,o=(0,h.A)(),d=(0,p.useCallback)(()=>{m({}),l()},[l]),c=(0,tb.vW)(d),[u,m]=(0,p.useState)({}),x=null==i||null==(t=i.arguments)?void 0:t.some(e=>e.required&&!u[e.name]);return i?(0,n.jsxs)(eI.aF,{title:o.formatMessage({defaultMessage:"Enter prompt inputs",id:"zDs90mJ5UJ"}),subtitle:(0,n.jsxs)("div",{className:"flex flex-col gap-1 mt-1",children:[i.name,(0,n.jsx)(tj.M,{text:i.description})]}),isOpen:s,onClose:d,modalSize:"lg",children:[(0,n.jsx)("div",{className:"flex flex-col gap-4 max-h-[500px] mb-4 overflow-y-auto",children:null==(a=i.arguments)?void 0:a.map(e=>(0,n.jsx)("div",{className:"flex flex-col gap-1",children:(0,n.jsx)(tf.ks,{required:e.required,label:"".concat(ty()(e.name.toLowerCase())).concat(e.required?"*":""),placeholder:e.description,value:u[e.name]||"",onValueChange:t=>m(a=>({...a,[e.name]:null!=t?t:""})),onBlur:()=>{m(t=>{var a;return{...t,[e.name]:(null!=(a=t[e.name])?a:"").trim()}})},error:e.required&&""===u[e.name]},e.name)},e.name))}),(0,n.jsxs)(eI.vW,{children:[(0,n.jsx)(K.$,{disabled:x,onClick:()=>void c({serverUuid:r,prompt:i,args:u}),children:(0,n.jsx)(S.A,{defaultMessage:"Add prompt",id:"8UhdEv01LN"})}),(0,n.jsx)(K.$,{variant:"secondary",onClick:d,children:(0,n.jsx)(S.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]}):null}var tk=a(41932),tM=a(52909),t_=a(91768),tA=a(15957),tN=a(51699);let tC=e=>{let{moveAttachments:t=!1,handleProjectCreated:a,isOpen:s,handleClose:l,syncSources:i=[],attachments:r=[],setSyncSourceUuids:o,setAttachments:d}=e,[c,u]=(0,p.useState)(null),{addError:m}=(0,N.Y)(),h=(0,tA.n)();return tS({project:c,syncSources:i,attachments:r,setSyncSourceUuids:o,setAttachments:d}),(0,n.jsxs)(eI.aF,{isOpen:s,onClose:l,modalSize:"xl",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsx)("h1",{className:"font-heading text-text-200 mb-4",children:t?(0,n.jsx)(S.A,{defaultMessage:"Create a project with attachments",id:"wSxz4Q9mjA"}):(0,n.jsx)(S.A,{defaultMessage:"Create a project",id:"HR5A+UPiIu"})}),(0,n.jsx)(K.$,{onClick:l,size:"icon",variant:"ghost",children:(0,n.jsx)(eW.X,{size:16})})]}),s&&(0,n.jsx)(tN.Kk,{syncSources:t?i:void 0,onProjectCreated:e=>{t&&u(e),a(e)},onError:e=>m(e.message,{error:e}),onCancel:l,strings:h})]})},tS=e=>{let{project:t,syncSources:a,attachments:s,setSyncSourceUuids:n,setAttachments:l}=e,i=(0,p.useRef)(!1),{addSuccess:r}=(0,N.Y)(),o=(0,h.A)(),{mutate:d}=(0,tk.fh)(null==t?void 0:t.uuid),{mutate:c}=(0,tM.pz)(null==t?void 0:t.uuid),u=(0,p.useCallback)(()=>{t&&(s.length||a.length&&t.is_private)&&(s.forEach(e=>{let{file_name:t,extracted_content:a}=e;d({file_name:t,content:a})}),t.is_private&&(a.forEach(e=>{let t=(0,t_.tS)(e);t&&c(t)}),n([])),l([]),r(o.formatMessage({defaultMessage:"Attachments successfully added to {projectName}",id:"xw8MJ6Kd/h"},{projectName:t.name||"your project"})))},[t,r,s,d,l,c,n,a,o]);(0,p.useEffect)(()=>{t&&!i.current&&(i.current=!0,u())},[t,u])};var tE=a(90517),tI=a(43989),tT=a(49271),tD=a(17423),tO=a(3975),tL=a(16622),tR=a(99778),tP=a(54556),tz=a(53357),tU=a(91039),tF=a(29585),tG=a(54615),tY=a(42685);let tH=()=>{let{addError:e}=(0,N.Y)();return{handleRateLimitError:(t,a)=>{t instanceof tF.LG&&429===t.statusCode?"thinking_messages_rate_limit_exceeded"===t.errorCode?e("You’ve reached your weekly limit for thinking messages. Please try again next week.",{error:t}):"opus_messages_rate_limit_exceeded"===t.errorCode?(0,tY.T)():(e("You’ve reached the limit for Claude messages at this time. Please wait before trying again.",{error:t}),(0,tG.D)()):e(a,{error:t})}}},tB=(0,tU.default)(()=>a.e(2342).then(a.bind(a,52342)).then(e=>({default:e.WritingAnimation})),{loadableGenerated:{webpack:()=>[52342]},ssr:!1}),tV={default:{type:"spring",stiffness:650,damping:60},opacity:{type:"tween",ease:"easeOut",duration:.35}},tK=(0,p.forwardRef)((e,t)=>{let{setScreen:a,onStyleChange:s,animateBoolRef:l}=e,i=(0,h.A)(),r=(0,eh.st)(),[o,d]=(0,p.useState)(!1),[c,x]=(0,p.useState)(""),{handleRateLimitError:g}=tH(),{mutateAsync:f}=(0,tD.f$)(),v=(0,p.useRef)(null),y=(0,p.useRef)(null);(0,p.useEffect)(()=>{o&&setTimeout(()=>{var e;return null==(e=y.current)?void 0:e.focus()},50)},[o]);let[b,j]=(0,p.useState)(!1),[w,k]=(0,p.useState)(!1),M=(0,p.useRef)(null),_=(0,p.useRef)(null),C=4e3,{handleFileUpload:E,handleTextUpload:I}=function(e){let[t,a]=(0,p.useState)(!1),{activeOrganization:s}=(0,B.YL)(),{addError:n}=(0,N.Y)(),l=(0,tx.mn)();return{handleFileUpload:async i=>{if(t||!s)return;if(a(!0),!(0,A.eT)(i))try{let t=await (0,A.F9)(i);await e(t),a(!1);return}catch(e){}let r=new FormData;r.append("file",i);try{let t=await l("/api/organizations/".concat(s.uuid,"/convert_document"),{method:"POST",body:r});if(!t.ok)throw Error("Document conversion failed");let a=await t.json();if(!(null==a?void 0:a.extracted_content))throw Error("Document conversion failed: No extracted content");await e(a.extracted_content)}catch(e){n(e instanceof Error?e.message:"Error uploading file",{error:e})}finally{a(!1)}},handleTextUpload:async n=>{!t&&s&&0!==n.trim().length&&(a(!0),await e(n),a(!1))},isUploading:t}}(async e=>{try{M.current=await f({content_example:e})}catch(e){g(e,i.formatMessage({defaultMessage:"Failed to create style. Please try again.",id:"GF2W10J5zb"})),j(!1)}}),T=()=>{M.current?s(M.current,!0):_.current=setTimeout(T,C=1e3)},D=async()=>{R(),await I(c)},O=async e=>{let t=Array.from(e.dataTransfer.files);t&&(k(!0),setTimeout(R,20),await E(t[0]))},L=async e=>{let t=e.target.files;t&&(R(),await E(Array.from(t)[0])),e.target.value=""},R=()=>{j(!0),_.current=setTimeout(T,C)};return(0,n.jsx)(m.P.div,{ref:t,className:"w-full h-full grid place-items-center",exit:{opacity:0,scale:.8},transition:l.current?tV:{duration:0},children:(0,n.jsxs)(u.N,{mode:"popLayout",children:[b&&(0,n.jsx)(m.P.div,{className:"w-full h-full grid place-items-center",initial:{opacity:0},animate:{opacity:1},transition:tV,children:(0,n.jsx)(tq,{})},"CreateStyleAnalyzingContentScreen"),!b&&(0,n.jsxs)(m.P.div,{className:"w-full h-full pt-1 flex flex-col sm:grid sm:grid-cols-2 sm:gap-4",children:[(0,n.jsxs)(m.P.div,{exit:{opacity:0,y:40,transition:tV},className:"sm:h-full text-center flex flex-col gap-2 items-center justify-center px-2 pt-8 pb-8 sm:pt-14 sm:pb-20",children:[(0,n.jsx)("div",{className:"relative pb-2 w-full flex items-center justify-center",children:(0,n.jsx)(tB,{})}),(0,n.jsx)("p",{className:"text-text-300 font-claude-response sm:text-lg",children:(0,n.jsx)(S.A,{defaultMessage:"Share a writing example or describe your style and Claude will make a custom writing style tailored just for you.",id:"2qm6Zfzfx3"})})]},"CreatStyleStartScreenExplainer"),(0,n.jsx)(m.P.div,{className:"h-full flex-1",exit:{opacity:0,x:0,scale:.8,transition:{basicTransition:tV}},children:o?(0,n.jsxs)("div",{className:"h-full flex flex-col gap-2 p-2 rounded-xl border-0.5 border-border-300",children:[(0,n.jsx)("textarea",{ref:y,className:" flex-1 min-h-0 bg-bg-000 border border-border-200 p-3 leading-5 rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:i.formatMessage({defaultMessage:"Paste at least a few paragraphs of example writing, including from multiple various sources if you’d like, for Claude to analyze and the match style of...",id:"mC+9IzmmMY"}),value:c,onChange:e=>x(e.target.value),required:!0}),(0,n.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,n.jsx)(K.$,{variant:"secondary",onClick:()=>d(!1),children:(0,n.jsx)(S.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,n.jsx)(K.$,{onClick:D,children:(0,n.jsx)(S.A,{defaultMessage:"Create style",id:"OC52fhpn7g"})})]})]}):(0,n.jsxs)(tu.wC,{className:"w-full h-full text-center border-dashed border border-border-300 bg-bg-000 rounded-xl relative grid place-items-center",onDrop:O,children:[(0,n.jsx)(tW,{showDropCover:w},"DropZoneOverlay"),(0,n.jsx)("input",{ref:v,type:"file",className:"hidden",accept:(0,A.cm)({imagesEnabled:!1}).join(","),onChange:L,multiple:!0}),(0,n.jsxs)("div",{children:[(0,n.jsxs)(W.ms,{trigger:(0,n.jsx)(K.$,{variant:"flat",className:"mt-2 font-medium !text-accent-secondary-100 bg-accent-secondary-900 hover:!bg-accent-secondary-100/15 gap-2",prepend:(0,n.jsx)(tO.C,{weight:"bold"}),children:(0,n.jsx)(S.A,{defaultMessage:"Add writing example",id:"EhXT0lXWRc"})}),children:[(0,n.jsx)(W.tJ,{children:(0,n.jsxs)("div",{className:"flex items-center gap-2",onClick:()=>{v.current&&v.current.click()},children:[(0,n.jsx)(tL.x,{size:16}),(0,n.jsx)(S.A,{defaultMessage:"Upload from device",id:"vMaZk5Jcnv"})]})}),(0,n.jsx)(W.tJ,{onClick:()=>d(!0),children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(tR.v,{size:16}),(0,n.jsx)(S.A,{defaultMessage:"Paste text content",id:"nVQ9XcjUIh"})]})})]}),(0,n.jsxs)("div",{className:"text-xs text-text-400 mt-3 flex flex-col gap-1 max-sm:pb-8",children:[(0,n.jsx)("p",{children:window.innerWidth<=640?(0,n.jsx)(S.A,{defaultMessage:"Select or paste existing doc, post, message, etc.",id:"7oFd31Vmu3"}):(0,n.jsx)(S.A,{defaultMessage:"Select, drop, or paste existing doc, post, message, etc.",id:"ugXnNZ7Ix/"})}),(0,n.jsx)("p",{children:(0,n.jsx)(S.A,{defaultMessage:"Content is not stored after matching style.",id:"bLEGIyr72h"})})]})]}),(0,n.jsx)("div",{className:"absolute w-full bottom-6",children:(0,n.jsx)(K.$,{variant:"underline",size:"inline",className:"text-sm gap-1.5",prepend:(0,n.jsx)(tP.u,{}),onClick:()=>{r.track({event_key:"styles.custom.describe_clicked"}),a(tE.I.CREATE_MANUALLY)},children:(0,n.jsx)(S.A,{defaultMessage:"Describe style instead",id:"p6hP+KeXkD"})})})]})},"CreatStyleStartScreenDropZone")]},"CreatStyleStartScreen")]})})});tK.displayName="CreateStyle";let tW=e=>{let{showDropCover:t}=e,{dragState:a}=(0,tu.t1)(),s=a===tu.mq.DRAGGING_OFF_TARGET||a===tu.mq.DRAGGING_ON_TARGET||t;return(0,n.jsx)(u.N,{children:s&&(0,n.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:(0,c.A)("absolute -inset-px z-10 flex flex-col justify-center rounded-xl border border-dashed transition-colors",a===tu.mq.DRAGGING_ON_TARGET||t?"bg-accent-secondary-900 border-accent-secondary-200 text-accent-secondary-000":"bg-bg-100 border-border-200 text-text-300"),children:(0,n.jsxs)("div",{className:"py-1.5 text-center",children:[(0,n.jsx)("div",{className:"relative inline-block opacity-60",children:(0,n.jsx)(tz.p,{size:36,weight:"thin"})}),(0,n.jsx)("div",{className:"font-claude-response pt-2 pb-4 italic tracking-tight",children:(0,n.jsx)(S.A,{defaultMessage:"Drop example writing here to match the style",id:"VcDT1Dt8dq"})})]})},"drop-zone-overlay")})},tq=()=>(0,n.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,n.jsx)(tB,{animate:!0}),(0,n.jsx)(m.P.div,{className:"font-claude-response italic text-lg",initial:{opacity:0,y:-15},animate:{opacity:1,y:0},transition:{opacity:{delay:.2,ease:"easeOut",duraation:.6},y:{delay:.2,type:"spring",stiffness:230,damping:20}},children:(0,n.jsx)(S.A,{defaultMessage:"Analyzing your writing...",id:"AnDnGKCn6M"})})]});var tX=a(46770),t$=a(29125),tJ=a(88999),tZ=a(31887);let tQ={objective:{label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tX.W,{})," ",(0,n.jsx)(S.A,{defaultMessage:"Define style objective",id:"gJB/90MGQ7"})]}),description:"Describe the main purpose and goal of this writing style — whether to teach, analyze, persuade, inspire, etc.",placeholder:"Try something like:\nI want to teach complex topics step-by-step, with a focus on building understanding.",promptPrepend:"I’d like the writing to serve this purpose:"},audience:{label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tZ.t,{})," ",(0,n.jsx)(S.A,{defaultMessage:"Tailor to an audience",id:"TYdBxyl/f3"})]}),description:"Describe details of the target audience you’d like Claude to write for including relevant information, needs, or preferences.",placeholder:"Try something like:\nWrite for marketing professionals. They’re tech-savvy and appreciate a dash of humor with their data.",promptPrepend:"I’d like to tailor this style to a specific audience:"},voicetone:{label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t$.r,{})," ",(0,n.jsx)(S.A,{defaultMessage:"Use specific voice & tone",id:"1Vo908p7lJ"})]}),description:"Think about characteristics like formality, emotion, personality, and how you want the written responses to feel.",placeholder:"Try something like:\nWrite in a warm, approachable tone with light professional humor - like a friendly mentor.",promptPrepend:"I’d like to write in this voice and tone:"},general:{label:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tP.u,{})," ",(0,n.jsx)(S.A,{defaultMessage:"Describe generally",id:"f3JnPS+B3+"})]}),description:"Describe in detail how you would like Claude to write. Be as specific as you can.",placeholder:"Try something like:\nWrite like an excited scientist explaining fascinating discoveries - technical but energetic.",promptPrepend:"I’d like to write like this:"},custom:{label:(0,n.jsx)(S.A,{defaultMessage:"Use custom instructions (advanced)",id:"hSfu0Sz47T"}),description:"Write exact custom instructions for this style instead of generating a style prompt automatically. Claude will ignore instructions that don’t follow our guidelines.",placeholder:"Write style custom instructions here...",promptPrepend:""}},t0=(0,p.forwardRef)((e,t)=>{let{setScreen:a,onStyleChange:s}=e,l=(0,h.A)(),i=(0,eh.st)(),[r,o]=(0,p.useState)(!1),[d,x]=(0,p.useState)(""),[g,f]=(0,p.useState)(Object.keys(tQ)[0]),{handleRateLimitError:v}=tH(),{mutateAsync:y}=(0,tD.f$)(),b=(0,p.useRef)(null);(0,p.useEffect)(()=>{setTimeout(()=>{var e;return null==(e=b.current)?void 0:e.focus()},50)},[g]);let j=d.replace(/\s/g,"").length>24,w=async()=>{if(!r&&j){o(!0);try{let e="custom"===g?{prompt:d}:{input_text:tQ[g].promptPrepend+"\n"+d},t=await y(e);s(t,!1)}catch(e){v(e,l.formatMessage({defaultMessage:"Failed to create style. Please try again.",id:"GF2W10J5zb"}))}finally{o(!1)}}},k=e=>{i.track({event_key:"styles.custom.describe_selected",key:e}),f(e)};return(0,n.jsxs)(m.P.div,{ref:t,className:"w-full h-full flex flex-col sm:grid sm:grid-cols-2 gap-4 pt-3",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:h-full sm:pr-3",children:[(0,n.jsxs)("div",{className:"flex-1 text-text-300",children:[(0,n.jsx)("p",{className:"mb-1 sm:mb-2 text-sm font-medium",children:(0,n.jsx)(S.A,{defaultMessage:"Generate style from a starting point:",id:"cz09/5alWg"})}),(0,n.jsx)("ul",{className:"hidden sm:flex flex-col gap-1.5",children:Object.keys(tQ).map(e=>(0,n.jsx)("li",{children:(0,n.jsxs)("button",{className:(0,c.A)("flex gap-1.5 items-center font-ui tracking-tight h-11 rounded-lg border border-border-400 hover:border-border-300 px-3 w-full text-left transition active:scale-[1.015] hover:bg-bg-200",g===e&&"!bg-accent-secondary-900 text-accent-secondary-000 !border-accent-secondary-100/80","custom"===e&&"mt-2 text-sm"),onClick:()=>k(e),children:[(0,n.jsx)("div",{className:"w-4 h-4 rounded-full bg-bg-100 grid place-items-center border border-border-300 mr-1",children:g===e&&(0,n.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-accent-secondary-100"})}),tQ[e].label]})},e))}),(0,n.jsx)("div",{className:"sm:hidden",children:(0,n.jsx)(W.ms,{trigger:(0,n.jsx)(K.$,{variant:"ghost",append:(0,n.jsx)(ee.a,{}),className:"w-full !border !border-border-300",children:(0,n.jsx)("div",{className:"flex-1 text-left flex items-center gap-1",children:tQ[g].label})}),children:Object.keys(tQ).map(e=>(0,n.jsx)(W.tJ,{onSelect:()=>k(e),children:(0,n.jsx)("div",{className:"flex items-center gap-1",children:tQ[e].label})},e))})})]}),(0,n.jsx)("div",{className:"mb-4 max-sm:hidden",children:(0,n.jsx)(K.$,{variant:"underline",size:"inline",className:"text-sm gap-1",onClick:()=>a(tE.I.CREATE),prepend:(0,n.jsx)(tJ.f,{}),children:(0,n.jsx)(S.A,{defaultMessage:"Never mind, I’ll add an example",id:"PpPoeCEz4X"})})})]}),(0,n.jsxs)("form",{className:"flex flex-col h-full rounded-xl border-0.5 border-border-300 bg-bg-200 px-3 py-2 gap-2",onSubmit:e=>{e.preventDefault(),w()},children:[(0,n.jsx)("p",{className:"pt-0 p-1 text-text-300 font-claude-response max-sm:text-sm",children:tQ[g].description}),(0,n.jsxs)("div",{className:"relative flex-1 w-full",children:[(0,n.jsx)("textarea",{ref:b,className:" min-h-0 w-full h-full bg-bg-000 border border-border-200 p-3 leading-snug rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:tQ[g].placeholder,value:d,required:!0,onChange:e=>x(e.target.value)}),(0,n.jsx)(u.N,{children:d.length>0&&!j&&(0,n.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{ease:"easeIn",duration:.1},className:"absolute bottom-1 right-1 left-1 py-2 px-2 rounded-md text-sm bg-accent-secondary-900 text-text-200 text-center",children:(0,n.jsx)(S.A,{defaultMessage:"Be as descriptive as possible to help Claude generate the best possible style for you",id:"3ObAHHjHgF"})})})]}),(0,n.jsx)(q.Tooltip,{tooltipContent:j?"":l.formatMessage({defaultMessage:"More description needed in order to generate style",id:"vX4dBOsKs3"}),side:"bottom",className:"text-center",children:(0,n.jsx)("div",{className:"flex items-center w-full justify-center pb-1",children:(0,n.jsx)(K.$,{className:"w-full",type:"submit",loading:r,disabled:!j,children:"custom"===g?(0,n.jsx)(S.A,{defaultMessage:"Create style",id:"OC52fhpn7g"}):(0,n.jsx)(S.A,{defaultMessage:"Generate style",id:"tILvvoBa87"})})})})]})]})});t0.displayName="CreateStyleManually";var t1=a(1336),t2=a(61547),t5=a(21777),t7=a(63965),t6=a(5856),t4=a(11439),t3=a(97240),t8=a(19384),t9=a(16566),ae=a(75032),at=a(49194);function aa(){let[e,t]=(0,eP.Vc)("userHiddenStyles",[]),a=(0,p.useCallback)(e=>{let a=(0,at.X)(e);t(e=>[...e,a])},[t]),s=(0,p.useCallback)(()=>{t([])},[t]),n=(0,p.useCallback)(t=>t.filter(t=>{let a=(0,at.X)(t);return!e.includes(a)}),[e]);return{hiddenPresetStyles:e,setHiddenPresetStyles:t,addHiddenPresetStyle:a,resetHiddenPresetStyles:s,filterHiddenStyles:n}}var as=function(e){return e.VIEW="view",e.EDIT="edit",e.EDIT_MANUALLY="edit_manually",e}(as||{});let an=z.z.array(z.z.object({key:z.z.string(),name:z.z.string(),nameKey:z.z.string().optional(),text:z.z.string(),textKey:z.z.string().optional()})),al=[],ai=e=>{let{isSaveButton:t,children:a}=e;return(0,n.jsx)("div",{className:(0,c.A)("flex gap-1.5",t?"sm:absolute sm:top-5 sm:right-16 max-sm:mt-3 max-sm:-mb-2":"absolute top-5 right-16"),children:a})},ar=(0,p.forwardRef)((e,t)=>{let{animateBoolRef:a,style:s,setCurrentStyle:l,returnToListScreen:i,setChatStyle:r,setIsEditing:o,setIsEditingName:d}=e,c=(0,h.A)(),u=(0,at.X)(s),x="default"===s.type,[g,f]=(0,p.useState)("view"),{mutateAsync:v}=(0,tD.lo)(u,x),{handleRateLimitError:y}=tH(),b=async e=>{let{prompt:t,editInput:a}=e;try{let e=await v({prompt:t,edit_instructions:a});e&&l(e)}catch(e){throw y(e,c.formatMessage({defaultMessage:"Failed to edit style. Please try again.",id:"1WkY08RVLW"})),Error}},j=e=>{o("edit"===e||"edit_manually"===e),f(e)};return(0,n.jsxs)(m.P.div,{className:"flex-1 min-h-0 grid sm:grid-cols-2 gap-3 pt-3",ref:t,children:["view"===g&&(0,n.jsxs)(ai,{children:[(0,n.jsx)(K.$,{variant:"secondary",className:"text-sm max-sm:hidden",onClick:()=>r(s),children:(0,n.jsx)(S.A,{defaultMessage:"Use style",id:"f7VY0ldE+0"})}),(0,n.jsx)(am,{style:s,returnToListScreen:i,onRename:()=>d(!0),setStateToManualEdit:()=>j("edit_manually")})]}),(0,n.jsxs)(m.P.div,{className:"min-h-0",initial:!!a.current&&{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{scale:{type:"spring",stiffness:230,damping:15,delay:.1},opacity:{duration:.3,delay:.1}},children:["view"===g&&(0,n.jsx)(ac,{style:s,onClick:()=>j("edit")}),"edit"===g&&(0,n.jsx)(ao,{style:s,updateStyle:b,onClose:()=>j("view")}),"edit_manually"===g&&(0,n.jsx)(ad,{style:s,updateStyle:b,onClose:()=>j("view")})]}),(0,n.jsx)(au,{style:s,animateBoolRef:a})]})});ar.displayName="EditStyle";let ao=e=>{let{style:t,updateStyle:a,onClose:s}=e,l=(0,h.A)(),i=(0,p.useRef)(t.prompt),r=(0,p.useRef)(null),[o,d]=(0,p.useState)(!1),[x,g]=(0,p.useState)(!1),[f,v]=(0,p.useState)([]),[y,b]=(0,p.useState)(""),j=async e=>{if(e.preventDefault(),o||x)return!1;await w(y)},w=async e=>{b(""),d(!0),v([...f,e]);try{await a({editInput:e})}catch(e){b(y),v(e=>e.slice(0,-1))}d(!1)},k=async()=>{f.length&&(g(!0),await a({prompt:i.current}),g(!1)),s()},M=(0,p.useMemo)(()=>{if(!t.attributes)return[];let e=Math.floor(Math.random()*t.attributes.length),a=e+1<t.attributes.length?e+1:e-1;return[l.formatMessage({defaultMessage:"A bit more {attribute}",id:"au1WTQvqDg"},{attribute:t.attributes[e].name.toLowerCase()}),l.formatMessage({defaultMessage:"Much less {attribute}",id:"dIbq/Ow8Zn"},{attribute:t.attributes[a].name.toLowerCase()})]},[t.attributes,l]);return(0,p.useEffect)(()=>{if(f.length>0){var e;null==(e=r.current)||e.scrollTo({top:r.current.scrollHeight,behavior:"smooth"})}},[f,t.summary]),(0,n.jsxs)("div",{className:"h-full flex flex-col",children:[(0,n.jsxs)("div",{className:"flex-1 min-h-0 flex flex-col gap-2 p-2.5 rounded-xl border border-accent-secondary-100/50 bg-bg-100 ",children:[(0,n.jsxs)("div",{className:(0,c.A)("border-0.5 rounded-lg p-3 pt-2.5 mb-2 relative transition bg-gradient-to-b",o?"border-border-300 from-accent-secondary-900/50 to-accent-secondary-900/10":"border-accent-secondary-100/50 from-accent-secondary-900/75 to-accent-secondary-900/25"),children:[(0,n.jsx)("div",{className:(0,c.A)("font-claude-response font-normal text-pretty leading-snug tracking-tight text-text-200 transition",o?"opacity-0 scale-[0.975]":"delay-150 duration-150 ease-out"),children:t.summary}),(0,n.jsx)(u.N,{children:o&&(0,n.jsx)(m.P.div,{className:"absolute inset-0 grid place-items-center",initial:{scale:.75,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.75,opacity:0},children:(0,n.jsx)(t2.a,{state:"thinking"})})})]}),(0,n.jsx)("ul",{ref:r,className:"flex-1 min-h-0 overflow-y-auto flex flex-col gap-2",children:f.map(e=>(0,n.jsx)("li",{children:(0,n.jsx)("div",{className:"inline-block py-2 px-3 rounded-lg bg-bg-300 text-sm",children:e})},e))}),f.length>0?(0,n.jsx)("div",{className:"text-sm text-center text-text-500",children:(0,n.jsx)(S.A,{defaultMessage:"Ask for more edits, save, or discard changes",id:"zOxoAYYCog"})}):(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("div",{className:"text-sm text-text-500 mb-2",children:(0,n.jsx)(S.A,{defaultMessage:"Describe how you’d like to edit the style, like:",id:"PRDvfjUkNA"})}),(0,n.jsx)("ul",{className:"flex flex-col gap-2",children:M.map((e,t)=>(0,n.jsx)("li",{children:(0,n.jsx)("button",{onClick:t=>{t.preventDefault(),w(e)},className:"text-sm font-medium h-8 px-3 rounded-full border-0.5 border-border-200 text-text-200 bg-gradient-to-b hover:text-text-000 hover:from-bg-400/0 hover:to-bg-400/50 hover:border-border-100 active:scale-x-[0.985] active:scale-y-[0.995] transition",children:e})},t))})]}),(0,n.jsx)("form",{className:"mb-1.5 mx-0.5",onSubmit:e=>j(e),children:(0,n.jsx)(tf.ks,{autoFocus:!0,className:"w-full",name:"inputText",placeholder:l.formatMessage({defaultMessage:"Ask Claude to edit the style...",id:"5D1Fao75P8"}),size:"lg",value:y,onChange:e=>b(e.target.value),append:(0,n.jsx)(u.N,{children:y.length>0&&(0,n.jsx)(m.P.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.85,opacity:0,transition:{ease:"easeIn",duration:.1}},children:(0,n.jsx)(K.$,{type:"submit",size:"icon_sm",variant:"flat",disabled:o||x,children:(0,n.jsx)(t7.D,{})})})})})})]}),(0,n.jsxs)(ai,{isSaveButton:!0,children:[(0,n.jsx)(K.$,{onClick:s,disabled:o||x||y.length>0||0===f.length,children:(0,n.jsx)(S.A,{defaultMessage:"Save changes",id:"X0ha1a+WYV"})}),(0,n.jsx)(K.$,{onClick:k,disabled:o,loading:x,variant:"secondary",children:f.length>0?(0,n.jsx)(S.A,{defaultMessage:"Discard",id:"nmpevlUATU"}):(0,n.jsx)(S.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})},ad=e=>{let{style:t,updateStyle:a,onClose:s}=e,[l,i]=(0,p.useState)(!1),[r,o]=(0,p.useState)(t.prompt),d=(0,h.A)(),c=async e=>{e.preventDefault(),i(!0),await a({prompt:r}),i(!1),s()};return(0,n.jsxs)("form",{className:"flex flex-col gap-2 h-full min-h-0 p-3 pt-2 rounded-xl border-0.5 border-border-200",onSubmit:e=>c(e),children:[(0,n.jsx)("div",{className:"text-center text-sm text-text-200 font-medium",children:(0,n.jsx)(S.A,{defaultMessage:"Edit style instructions manually",id:"+qSf1b/LLJ"})}),(0,n.jsx)("textarea",{className:" flex-1 min-h-0 bg-bg-000 border border-border-200 p-3 leading-5 rounded-lg transition-colors hover:border-border-100 placeholder:text-text-500 focus:border-accent-secondary-100 focus:ring-0 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 whitespace-pre-wrap resize-none",name:"inputText",placeholder:d.formatMessage({defaultMessage:"Describe your style instructions",id:"nk7EX3l+b4"}),value:r,disabled:l,onChange:e=>o(e.target.value),autoFocus:!0}),(0,n.jsxs)(ai,{isSaveButton:!0,children:[(0,n.jsx)(K.$,{type:"submit",loading:l,children:(0,n.jsx)(S.A,{defaultMessage:"Save changes",id:"X0ha1a+WYV"})}),(0,n.jsx)(K.$,{onClick:()=>{o(t.prompt),s()},disabled:l,variant:"secondary",children:(0,n.jsx)(S.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})},ac=e=>{let{style:t,onClick:a}=e,s="default"===t.type;return(0,n.jsxs)("div",{className:(0,c.A)("flex flex-col items-center h-full px-6 gap-4 rounded-lg sm:rounded-xl max-sm:mx-1.5",!s&&"bg-gradient-to-b from-accent-secondary-900/75 to-accent-secondary-900/25 border border-accent-secondary-100/50",s&&"bg-bg-300 border border-border-300"),children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)("div",{className:(0,c.A)("w-fit px-4 py-2 pb-2.5 gap-2.5 rounded-b-lg font-medium text-xs tracking-tight",s?"bg-bg-400 text-text-300":"bg-accent-secondary-200/10 text-accent-secondary-100"),children:s?(0,n.jsx)(S.A,{defaultMessage:"Preset style",id:"qwpRSZtBAV"}):(0,n.jsx)(S.A,{defaultMessage:"Your custom style",id:"o/vLK7B7mw"})})}),(0,n.jsxs)("div",{className:"flex flex-col items-center gap-1.5 pb-4",children:[!s&&(0,n.jsx)(q.Tooltip,{className:"text-center",tooltipContent:(0,n.jsx)(S.A,{defaultMessage:"Full style instructions are generated and include more than shown in summary. You can edit instructions manually from the options menu",id:"R5PMcY1ELo"}),children:(0,n.jsxs)("div",{className:"flex items-center gap-1 cursor-help opacity-50 hover:opacity-60",children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:(0,n.jsx)(S.A,{defaultMessage:"Style summary",id:"hVmQ4DO8io"})}),(0,n.jsx)(eX.R,{size:12,className:"translate-y-px",weight:"bold"})]})}),(0,n.jsx)("div",{"data-testid":"style-summary",className:"font-claude-response text-xl font-normal text-pretty leading-snug tracking-tight text-center flex-1 flex items-center",children:"default"===t.type&&t.summaryKey?(0,n.jsx)(i.X5,{id:t.summaryKey}):t.summary})]}),(0,n.jsx)("div",{className:"flex-1 flex items-center text-sm",children:s?(0,n.jsx)(S.A,{defaultMessage:"Preset styles are not editable",id:"qjKy0s/reb"}):(0,n.jsx)(K.$,{variant:"outline",onClick:a,className:"!border-accent-secondary-200 !text-accent-secondary-000 hover:!bg-accent-secondary-100/10",prepend:(0,n.jsx)(t9.f,{weight:"bold"}),children:(0,n.jsx)(S.A,{defaultMessage:"Edit with Claude",id:"wdKoWlVN+G"})})})]})},au=e=>{let{style:t,animateBoolRef:a}=e,s=(0,h.A)(),[l,r]=(0,p.useState)(""),[d,x]=(0,p.useState)(),g=(0,p.useRef)(t.prompt),f=(0,p.useRef)(d),v=(0,o.T9)("claude_style_previews","previewExamples",al,an),{handleRateLimitError:y}=tH(),{isPending:b,mutateAsync:j}=(0,tD.n7)(),w=(0,p.useCallback)(async()=>{if(d)try{let e=await j({style_prompt:t.prompt,example_key:d.key,example_text:d.textKey?(0,i.fl)({id:d.textKey,intl:s}):d.text});r(e)}catch(e){y(e,s.formatMessage({defaultMessage:"Failed to preview style. Please try again.",id:"B2A4x/wbTg"}))}},[y,j,d,t.prompt,s]);return(0,p.useEffect)(()=>{var e;(g.current!==t.prompt||(null==(e=f.current)?void 0:e.key)!==(null==d?void 0:d.key))&&(g.current=t.prompt,f.current=d,w())},[w,d,t.prompt]),(0,n.jsx)(m.P.div,{className:(0,c.A)("max-sm:hidden flex flex-col gap-2 h-full min-h-0 p-2 rounded-xl border-0.5 border-border-300 transition-colors",d?"bg-bg-000/70":"bg-bg-000/20"),initial:!!a.current&&{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{scale:{type:"spring",stiffness:230,damping:15,delay:.2},opacity:{duration:.3,delay:.2}},children:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center text-sm px-2 font-medium text-text-200",children:[(0,n.jsx)(S.A,{defaultMessage:"Previewing with",id:"tNFdPqESDT"}),(0,n.jsx)(W.ms,{align:"center",trigger:(0,n.jsx)(K.$,{variant:"ghost",size:"unset",className:"!px-1 !py-0.5 gap-0.5 !text-accent-secondary-100 hover:!bg-accent-secondary-900",append:(0,n.jsx)(ae.a,{className:"translate-y-px"}),children:d?d.nameKey?(0,n.jsx)(i.X5,{id:d.nameKey}):d.name:(0,n.jsx)(S.A,{defaultMessage:"Example",id:"xrCRnH/mKK"})}),children:v.map(e=>(0,n.jsx)(W.tJ,{disabled:b,onClick:()=>x(e),children:e.nameKey?(0,n.jsx)(i.X5,{id:e.nameKey}):e.name},e.key))})]}),(0,n.jsxs)(t5.E,{className:"p-2 pt-0 min-h-0 overflow-y-scroll",children:[(0,n.jsx)("div",{className:"bg-bg-300 -mx-0.5 mb-2 py-1.5 px-2 text-sm rounded-lg text-pretty",children:d.textKey?(0,n.jsx)(i.X5,{id:d.textKey}):d.text}),(0,n.jsx)(u.N,{children:b?(0,n.jsx)("div",{className:"pt-2",children:(0,n.jsx)(t2.a,{state:"writing"})}):(0,n.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeIn",duration:.25},children:(0,n.jsx)(t1.fP,{className:"font-claude-response flex-1 flex flex-col gap-2",text:l})})})]})]}):(0,n.jsx)("div",{className:"flex-1 grid place-items-center text-center",children:(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("div",{className:"text-sm text-text-500 font-medium mb-4",children:(0,n.jsx)(S.A,{defaultMessage:"Preview with an example...",id:"YdUmd5z6YL"})}),(0,n.jsx)("div",{className:"flex flex-wrap justify-center gap-2 w-full",children:v.map(e=>(0,n.jsx)("button",{onClick:()=>x(e),className:"\n                    rounded-full\n                    border-0.5\n                    border-border-300\n                    text-sm\n                    text-text-400\n                    font-medium\n                    h-8\n                    px-3\n                    flex\n                    items-center\n                    bg-gradient-to-b\n                    from-always-black/0\n                    to-always-black/5\n                    hover:bg-accent-secondary-900\n                    hover:text-accent-secondary-000\n                    hover:border-accent-secondary-100/50\n                    transition-colors",children:e.nameKey?(0,n.jsx)(i.X5,{id:e.nameKey}):e.name},e.key))})]})})})},am=e=>{let{style:t,returnToListScreen:a,onRename:s,setStateToManualEdit:l}=e,i=(0,at.X)(t),r="default"===t.type,{isPending:o,mutateAsync:d}=(0,tD.M$)(i),{addHiddenPresetStyle:c}=aa(),{clearStoredStyle:u,storedStyle:m}=(0,tg.p)(),{addError:p}=(0,N.Y)(),x=(0,h.A)(),g=async()=>{if(r)c(t),setTimeout(()=>{a()},500);else try{await d(),m&&"uuid"in m&&m.uuid===t.uuid&&u(),a()}catch(e){p(x.formatMessage({defaultMessage:"Failed to delete style. Please try again.",id:"4eIHICfKCI"}),{error:e})}};return(0,n.jsxs)(W.ms,{align:"end",unstyledTrigger:!0,trigger:(0,n.jsxs)(K.$,{variant:"ghost",className:"max-sm:min-w-8 max-sm:px-2 sm:pl-3 sm:pr-2",children:[(0,n.jsxs)("span",{className:"hidden sm:flex items-center gap-1",children:[(0,n.jsx)(S.A,{defaultMessage:"Options",id:"NDV5MqT9ww"}),"\xa0",(0,n.jsx)(ae.a,{})]}),(0,n.jsx)("span",{className:"sm:hidden",children:(0,n.jsx)(t6.L,{weight:"bold",size:20})})]}),children:[!r&&(0,n.jsx)(W.tJ,{disabled:o,onClick:()=>{s()},children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(t4.g,{className:"mr-2"}),(0,n.jsx)(S.A,{defaultMessage:"Rename style",id:"sEO8vFphTF"})]})}),"Concise"===i?(0,n.jsx)(W.q,{className:"text-sm",children:(0,n.jsx)(S.A,{defaultMessage:"Concise style can’t be hidden",id:"zTztS+Om9I"})}):(0,n.jsx)(W.tJ,{className:"pr-0 !text-danger-000",disabled:o,onClick:g,children:r?(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(t3.C,{}),(0,n.jsx)(S.A,{defaultMessage:"Hide preset style",id:"z44N28JZYv"})]}):(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(t8.l,{}),(0,n.jsx)(S.A,{defaultMessage:"Delete style",id:"fAqSoPl78t"})]})}),!r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.DG,{}),(0,n.jsx)(W.tJ,{onClick:l,children:(0,n.jsx)(S.A,{defaultMessage:"Edit style manually",id:"H+z4uo2Wfn"})})]})]})},ap=e=>{let{size:t=16,className:a}=e;return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",width:t,height:t,viewBox:"0 0 16 16",className:a,strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M8.5 4.5c-3 2-4.5 4-5.5 8L2.5 15l1-1.5"}),(0,n.jsx)("path",{d:"M3 4.5c-.5 1.3-.1 5 .4 6.5 0 0 1.9-2 4.1-3 1.8-.8 3.8-.6 4.5-2 .6-1.2-.2-1.7-1.5-1 1.2-.7 4-2 3-3.5-1-1.4-3.5-.1-4.5.8C9 1.9 9 .9 8 1c-1 .1-2 1.5-2.3 2.8 0 0 0-.7-.7-.8-.7-.1-1.6.5-2 1.5Z"}),(0,n.jsx)("path",{d:"M10.5 11v4m-2-2h4"})]})};var ah=a(26505),ax=a(88869),ag=a(17938),af=a(99115),av=a(43520);let ay=(0,p.forwardRef)((e,t)=>{let{setScreen:a,styles:s,onStyleChange:l}=e,{hiddenPresetStyles:i,resetHiddenPresetStyles:r}=aa(),{sortStyles:o,setOrder:d}=function(){let[e,t]=(0,eP.Vc)("userStylesOrder",[]);return{sortStyles:(0,p.useCallback)(t=>[...t].sort((t,a)=>{let s=(0,at.X)(t),n=(0,at.X)(a);if("Default"===s)return -1;if("Default"===n)return 1;let l=e.indexOf(s),i=e.indexOf(n);return -1===l&&-1===i?0:-1===l?1:-1===i?-1:l-i}),[e]),stylesOrder:e,setOrder:(0,p.useCallback)(e=>{t(e.map(e=>(0,at.X)(e)))},[t])}}(),[c,u]=(0,p.useState)([]),h=(0,p.useCallback)(e=>{let t=[...i,"Default"];return o(e.filter(e=>!t.includes((0,at.X)(e))))},[i,o]);(0,p.useEffect)(()=>{u(h(s))},[s,h]);let x=(0,p.useCallback)(e=>{Array.isArray(e)&&(u(e),d(e))},[d]),g=(0,p.useMemo)(()=>s.some(e=>"custom"===e.type),[s]);return(0,n.jsxs)(m.P.div,{exit:{opacity:0,transition:{duration:0}},ref:t,className:"flex-1 min-h-0 flex flex-col -mx-3",children:[(0,n.jsxs)("div",{className:"flex-1 min-h-0",children:[(0,n.jsx)(ag.x,{as:"ul",axis:"y",values:c,onReorder:x,layoutScroll:!0,className:"pl-3 pr-3 pb-2 overflow-y-auto max-h-full [mask-image:linear-gradient(to_top,hsl(var(--always-black)/0%)_0%,_hsl(var(--always-black)/100%)_3%)]",children:c.map(e=>(0,n.jsx)(ab,{style:e,onClick:()=>l(e,!1)},(0,at.X)(e)))}),!g&&(0,n.jsxs)(m.P.div,{initial:{opacity:0,scale:.985},animate:{opacity:1,scale:1,transition:{delay:.3,ease:"easeOut",duration:.3}},exit:{opacity:0},className:"flex bg-gradient-to-b from-accent-pro-900/20 to-accent-pro-900/50 py-3 pl-3.5 pr-5 mx-3 rounded-lg border-0.5 border-border-300 text-text-300 text-sm",children:[(0,n.jsx)("div",{className:"font-ui-serif font-medium mr-4 text-accent-pro-000 mt-px whitespace-nowrap",children:(0,n.jsx)(S.A,{defaultMessage:"Tip",id:"4j1TGZubAJ"})}),(0,n.jsx)("p",{children:(0,n.jsx)(S.A,{defaultMessage:"Choose from preset styles or create your own custom style to tailor elements of Claude’s written responses such as tone, voice, vocabulary, detail level, and more. <link>Learn about styles</link>",id:"pwT6iI4QV7",values:{link:e=>(0,n.jsx)("a",{href:"https://support.anthropic.com/en/articles/10181068-configuring-and-using-styles",className:"underline hover:text-text-000",target:"_blank",children:e})}})})]})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center mt-4 mx-3",children:[(0,n.jsx)(K.$,{onClick:()=>a(tE.I.CREATE),prepend:(0,n.jsx)(ap,{}),children:(0,n.jsx)(S.A,{defaultMessage:"Create custom style",id:"9y/YEanHck"})}),i.length>0&&(0,n.jsx)(K.$,{variant:"underline",onClick:r,children:(0,n.jsx)(S.A,{defaultMessage:"Reset preset styles",id:"EITqrHaUNi"})})]})]})});ay.displayName="ListStyles";let ab=e=>{let{style:t,onClick:a}=e,s="default"===t.type,l=(0,af.m)(),[r,o]=(0,p.useState)(!1);return(0,n.jsxs)(av.N,{value:t,dragListener:!1,dragControls:l,dragTransition:{bounceStiffness:500,bounceDamping:40},onDragStart:()=>o(!0),onDragEnd:()=>o(!1),className:"relative my-2 min-w-0",children:[(0,n.jsxs)("button",{className:(0,c.A)("\n          flex\n          items-center\n          w-full\n          h-11\n          py-4\n          pl-1\n          pr-3\n          min-w-0\n          rounded-lg\n          transition\n          border-0.5\n          border-border-300\n          bg-bg-100\n          bg-gradient-to-b\n          from-bg-300/0\n          to-bg-300/50\n          select-none\n          relative\n        ",r?"scale-y-[1.015] scale-x-[1.0025] shadow-md":"group hover:enabled:from-accent-secondary-200/0 hover:enabled:to-accent-secondary-200/10 hover:enabled:border-accent-secondary-200/50"),onClick:a,children:[(0,n.jsx)("div",{className:"flex min-w-0 items-center flex-1 pl-7 truncate",children:"default"===t.type&&t.nameKey?(0,n.jsx)(i.X5,{id:t.nameKey}):t.name}),s&&(0,n.jsx)("div",{className:"mr-0.5 rounded-full px-2 py-0.5 bg-text-300/5 text-text-400 font-medium text-[0.625rem]",children:(0,n.jsx)(S.A,{defaultMessage:"Preset",id:"EucS2pAMVS"})}),(0,n.jsx)("div",{className:"text-accent-secondary-200 opacity-0 scale-50 transition group-hover:scale-100 group-hover:opacity-100",children:s?(0,n.jsx)(ah.Q,{}):(0,n.jsx)(t4.g,{})})]}),(0,n.jsx)("div",{onPointerDown:e=>l.start(e),onClick:e=>e.stopPropagation(),className:"w-7 h-7 absolute left-1 top-1/2 -translate-y-1/2 grid place-items-center cursor-move text-text-500 hover:text-accent-secondary-000",children:(0,n.jsx)(ax.H,{size:16,weight:"bold"})})]})},aj=e=>{let{openWithScreen:t,onClose:a,styles:s,setChatStyle:l}=e,r=(0,h.A)(),o=!!t,d=(0,eh.st)(),[c,m]=(0,p.useState)(t||tE.I.LIST),[x,g]=(0,p.useState)(),[f,v]=(0,p.useState)(!1),[y,b]=(0,p.useState)(!1),j=(0,p.useRef)(!1);(0,p.useEffect)(()=>{t&&m(t)},[t]);let w=()=>{j.current=!1,m(tE.I.LIST),v(!1),b(!1)},k=()=>{(!f||window.confirm(r.formatMessage({defaultMessage:"Are you sure? Closing while editing may not synchronize changes.",id:"0XdWZrmwXu"})))&&(d.track({event_key:"styles.modal",open:!1}),w(),a())},M=(e,t)=>{j.current=t,g(e),m(tE.I.EDIT),v(!1),b(!1)};return(0,n.jsx)(eI.aF,{modalSize:"xl",title:(e=>{switch(e){case tE.I.CREATE:return(0,n.jsx)("div",{className:"font-ui-serif font-normal",children:(0,n.jsx)(S.A,{defaultMessage:"Create a style",id:"/pKvFi9Ak4"})});case tE.I.CREATE_MANUALLY:return(0,n.jsx)("div",{className:"font-ui-serif font-normal",children:(0,n.jsx)(S.A,{defaultMessage:"Describe your style",id:"Ntblq5cSRe"})});case tE.I.LIST:return(0,n.jsx)("div",{className:"font-ui-serif font-normal",children:(0,n.jsx)(S.A,{defaultMessage:"Customize your styles",id:"dn3MiW/vUH"})});case tE.I.EDIT:return(0,n.jsx)("div",{className:"w-10/12 sm:w-5/12 md:w-7/12",children:y?(0,n.jsx)(aw,{style:x,onClose:e=>{e&&g(e),b(!1)}}):(0,n.jsx)("button",{title:x.name,className:"w-full font-ui-serif font-normal text-left truncate cursor-text h-9 pr-4 leading-none translate-y-px text-text-200 hover:text-text-000",onClick:()=>!f&&b(!0),children:f?(0,n.jsx)(S.A,{defaultMessage:"Edit {name}",id:"s3IOQQ+nJU",values:{name:x.name}}):"default"===x.type&&x.nameKey?(0,n.jsx)(i.X5,{id:x.nameKey}):x.name})})}})(c),icon:(e=>{switch(e){case tE.I.CREATE:case tE.I.EDIT:return(0,n.jsx)(K.$,{variant:"ghost",size:"icon_sm",disabled:f,onClick:()=>w(),children:(0,n.jsx)(tI.n,{})});case tE.I.CREATE_MANUALLY:return(0,n.jsx)(K.$,{variant:"ghost",size:"icon_sm",onClick:()=>m(tE.I.CREATE),children:(0,n.jsx)(tI.n,{})});case tE.I.LIST:return null}})(c),isOpen:o,onClose:k,className:"h-[35rem] !bg-gradient-to-b from-bg-100 to-bg-200 !pt-5 !pb-7",prependBeforeCloseButton:(0,n.jsx)(n.Fragment,{children:c===tE.I.LIST&&(0,n.jsx)(q.Tooltip,{tooltipContent:r.formatMessage({defaultMessage:"Learn more about styles ↗",id:"nuhnis5YtY"}),children:(0,n.jsx)("div",{className:"mr-1",children:(0,n.jsx)(K.$,{href:"https://support.anthropic.com/en/articles/10181068-configuring-and-using-styles",variant:"ghost",className:"text-text-300",size:"icon",target:"_blank",children:(0,n.jsx)(tT.v,{size:18})})})})}),hasCloseButton:!0,children:(0,n.jsxs)(u.N,{mode:"popLayout",children:[c===tE.I.CREATE&&(0,n.jsx)(tK,{onStyleChange:M,setScreen:m,animateBoolRef:j},"CreateStyleScreen"),c===tE.I.CREATE_MANUALLY&&(0,n.jsx)(t0,{onStyleChange:M,setScreen:m},"CreateStyleManuallyScreen"),c===tE.I.LIST&&(0,n.jsx)(ay,{setScreen:m,styles:s,onStyleChange:M},"ListStylesScreen"),c===tE.I.EDIT&&x&&(0,n.jsx)(ar,{animateBoolRef:j,style:x,returnToListScreen:w,setIsEditingName:b,setCurrentStyle:g,setIsEditing:v,setChatStyle:e=>{l(e),k()}},"EditStyleScreen")]})})},aw=e=>{let{style:t,onClose:a}=e,s=(0,at.X)(t),l="default"===t.type,r=(0,h.A)(),[o,d]=(0,p.useState)("default"===t.type&&t.nameKey?(0,i.fl)({id:t.nameKey,intl:r}):t.name),{isPending:c,mutateAsync:u}=(0,tD.lo)(s,l),m=async()=>{a(await u({name:o}))};return(0,n.jsx)("form",{className:"w-full",onSubmit:async e=>{e.preventDefault(),await m()},children:(0,n.jsx)(tf.ks,{autoFocus:!0,className:"w-full",value:o,maxLength:64,onChange:e=>d(e.target.value),error:0===o.length,append:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(K.$,{variant:"ghost",type:"button",size:"unset",className:"w-7 h-7 rounded-md mr-1",onClick:()=>a(),disabled:c,children:(0,n.jsx)(eW.X,{})}),(0,n.jsx)(K.$,{variant:"flat",size:"unset",className:"w-7 h-7 rounded-md",type:"submit",loading:c,children:(0,n.jsx)(Q.J,{weight:"bold"})})]})})})};var ak=a(60885),aM=a(96533);let a_=()=>{let{projectUuid:e,setProjectUuid:t,setSyncSourceUuids:a,setIsUploadingGithubSync:s,syncSourceUuids:l,attachments:i,setAttachments:r}=(0,w.oM)(),{styleModalOpenWithScreen:o,setStyleModalOpenWithScreen:d,createProjectModalIsOpen:c,setCreateProjectModalIsOpen:u,githubModalIsOpen:m,setGithubModalIsOpen:h,gmailAuthModalIsOpen:g,setGmailAuthModalIsOpen:f,createPromptArgumentModalIsOpen:v,setCreatePromptArgumentModalIsOpen:y}=(0,e5.CH)(),{mcpDirectoryModalIsOpen:b,setMcpDirectoryModalIsOpen:j}=(0,e5.tl)(),{personalizedStyleOptions:k}=(0,tg.p)(),M=(0,eY.sb)(),_=(0,e7.pi)(),A=(0,p.useCallback)(e=>{a(t=>[...t,e.uuid]),s(!1)},[a,s]),N=(0,x.NY)(l),C=(0,tx.B7)(N);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(aj,{openWithScreen:o,onClose:()=>d(null),styles:k,setChatStyle:e=>_(e.key)}),(0,n.jsx)(aM.r,{isOpen:!!g,onClose:()=>f(!1),callerIdentifier:"inputMenu"}),(0,n.jsx)(tC,{moveAttachments:!!(null==c?void 0:c.moveAttachments),isOpen:!!(null==c?void 0:c.isOpen),handleClose:()=>u(null),handleProjectCreated:e=>{t(e.uuid),u(null)},syncSources:C,attachments:i,setSyncSourceUuids:a,setAttachments:r}),(0,n.jsx)(ak.s,{location:"chat",projectUuid:e,isOpen:m,onClose:()=>h(!1),onCreated:A,setIsUploadingGithubSync:s}),v&&(0,n.jsx)(tw,{isOpen:v.isOpen,onClose:()=>y(null),serverUuid:v.serverUuid,prompt:v.prompt}),M&&(0,n.jsx)(eB.TY,{isOpen:b,setIsOpen:j,showManageButton:!0})]})};function aA(){let e=(0,s._)(["\n  !box-content\n  flex\n  flex-col\n  bg-bg-000\n  mx-2\n  md:mx-0\n  items-stretch\n  transition-all\n  duration-200\n  relative\n  cursor-text\n  z-10\n  rounded-2xl\n"]);return aA=function(){return e},e}function aN(){let e=(0,s._)(["\n  bg-bg-100 \n  w-full \n  h-2\n"]);return aN=function(){return e},e}function aC(){let e=(0,s._)(["\n  flex \n  w-full \n  min-w-0 \n  flex-col\n"]);return aC=function(){return e},e}let aS=(0,p.forwardRef)((e,t)=>{var a,s,l,v;let{disabled:y,placement:b,placeholder:R,onSubmit:P,onReady:z,onRetry:U}=e,F=(0,h.A)(),G=(0,e5.CH)(),{prompt:Y,previewPrompt:H,tipTapEditorState:B,projectUuid:V,setPrompt:K,setTipTapEditorState:W,setAttachments:q,setFiles:X,attachments:$,files:J,syncSourceUuids:Z,isUploadingDriveSync:Q,isUploadingGithubSync:ee,sendMessage:et,conversation:ea,isChatSyncing:es,isProjectSyncing:en,setSyncSourceUuids:el,isSending:ei,focusInput:er,promptInputRef:eo,willRedirectOnSubmit:ed,hasBlockingWarning:ec,isUploadingFile:eu,setIsUploadingFile:em,validateMaxUploadLimit:ep,onPasteFiles:eh,uploadInputProps:ex,hasAttachments:eg,isNewConversation:ef,isImprovingPrompt:ev}=(0,w.oM)(),{incognitoModeEnabled:ey}=(0,k.S)();(0,p.useImperativeHandle)(t,()=>({setContent:(e,t,a)=>{K(e,{forceUpdateTiptap:!0}),q("function"==typeof t?t($):t),X("function"==typeof a?a(J):a)},sendMessage:et,setAttachments:e=>{q("function"==typeof e?e($):e)},getAttachments:()=>$})),(()=>{let{setPrompt:e,setAttachments:t,setFiles:a}=(0,O.Tc)(e=>({setPrompt:e.setPrompt,setAttachments:e.setAttachments,setFiles:e.setFiles}),"useSavePromptOnFail"),{failedStreamRetryData:s,setFailedStreamRetryData:n}=(0,D.x)();(0,p.useEffect)(()=>{null!==s&&(e(s.prompt),t(s.attachments),a(s.files),n(null))},[s,t,n,a,e])})();let{fetchInputAutocompletion:eb}=(0,g.$z)(null==ea?void 0:ea.id),ej=function(e,t,a,s,n,l){let[i,r]=(0,p.useState)(!1);return(0,p.useEffect)(()=>{let e=e=>{"Shift"===e.key&&r(!0)},t=e=>{"Shift"===e.key&&r(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[]),(0,p.useCallback)(e=>{var a,r,o;let d=null==(r=e.clipboardData)||null==(a=r.files)?void 0:a.length,c=null==(o=e.clipboardData)?void 0:o.getData("text/plain"),u=null==c?void 0:c.length;if(u&&!d){let e=(0,I.$)(c);e&&l(e)}if(d&&!u){s({newUploads:Array.from(e.clipboardData.files)})&&n(e.clipboardData.files),e.preventDefault();return}s({numNewPotentialAttachments:1,showError:!1})&&(!u||c.length<4e3||i||(e.preventDefault(),t(e=>[...e,{file_name:"",file_size:c.length,file_type:"txt",extracted_content:c}])))},[s,t,n,l,i])}(0,q,0,ep,eh,(()=>{let{setSyncSourceUuids:e,isAtMaxNumUploads:t,setIsUploadingDriveSync:a,prompt:s}=(0,w.oM)(),l=(0,E.LP)(),{addError:i}=(0,N.Y)(),r=(0,h.A)(),{mutate:o}=(0,x.EF)({onMutate:()=>{a(!0)},onSuccess:t=>{e(e=>[...e,t.uuid]),a(!1)},onError:e=>{a(!1),i((0,T.J)(e),{error:e})},meta:{noToast:!0}}),{isDriveAuthenticated:d,initDriveAuth:c}=(0,E.cI)({callerIdentifier:"chat-input",handleAuthSuccess:()=>{for(let e of s.match(/(https?:\/\/[^\s]+)/gi)||[]){let t=(0,I.$)(e);t&&u(t,!0)}}}),u=(0,p.useCallback)(function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(l||a){if(!d&&!a)return void i((0,n.jsx)("span",{children:(0,n.jsx)(S.A,{defaultMessage:"<button>Authenticate</button> to paste link as attachment",id:"85AH1hyv0s",values:{button:e=>(0,n.jsx)("button",{className:"underline",onClick:c,children:e})}})}));if(t)return void i(r.formatMessage({defaultMessage:"You can add at most {maxUploads, plural, one {# attachment} other {# attachments}} to a message.",id:"wvnM4s8976"},{maxUploads:A.XA.maxTotalUploadsPerMessage}));o({sync_source_type:C.v8.GDRIVE,sync_source_config:{uri:e}})}},[l,d,t,o,c,i,r]);return u})()),ew=null!=(a=null==ea?void 0:ea.projectKnowledgebaseTokens)?a:0,[ek]=(0,L.q)({projectUuid:V,conversationUuid:null!=(s=null==ea?void 0:ea.id)?s:null,conversationTokensSoFar:null!=(l=null==ea?void 0:ea.tokensSoFar)?l:0,conversationFiles:null!=(v=null==ea?void 0:ea.files)?v:[],projectKnowledgebaseTokens:ew,input:Y,attachments:$,syncSourceUuids:Z}),eM=(0,_.U)(V),{value:e_}=(0,o.fS)("test_gated_strings"),{value:eA}=(0,o.fS)("claudeai_beam"),eN=(0,d.q)(),eC=y||ei||0===Y.length&&0===$.length&&0===J.length&&0===Z.length||eu||Q||ee||es||en||ec||"will-exceed"===ek||eM||(null==ea?void 0:ea.isSampling)===!0,eS=(0,p.useCallback)(async()=>{!eC&&(await et(),P&&P())},[eC,P,et]),eE=(0,p.useCallback)(e=>{W(e)},[W,G,eA]),eI=(0,p.useCallback)(e=>{let t=e.target;"BUTTON"===t.tagName||t.closest("button")||t.closest("[role]")||t.closest("a")||t.closest("input")||t.closest("select")||t.closest("textarea")||er()},[er]),eT=(0,p.useRef)(null),eD=(0,x.NY)(Z).map((e,t)=>{let{data:a}=e;return{syncSource:a,uuid:Z[t]}}),eO=(0,n.jsx)(u.N,{initial:!1,children:eg&&(0,n.jsx)(m.P.div,{className:"overflow-hidden rounded-b-2xl",initial:{height:0},animate:{height:"auto"},exit:{height:0},children:(0,n.jsx)(j,{isUploadingFile:eu,isUploadingSync:Q||ee,attachments:$,files:J,syncSourceResults:eD,onRemoveAttachment:e=>{q(t=>t.filter((t,a)=>a!==e))},onRemoveFile:e=>{X(t=>t.filter((t,a)=>a!==e))},onRemoveSyncSource:e=>{el(t=>t.filter(t=>t!==e))}})},"attachments")});return eN?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(aD,{onPasteCapture:e=>{var t,a;(null==eo||null==(a=eo.current)||null==(t=a.getEditor())?void 0:t.isFocused)&&ej(e)},children:[(0,n.jsx)("input",{ref:eT,id:"chat-input-file-upload-".concat(b),"data-testid":"file-upload","aria-hidden":"true",tabIndex:-1,className:"absolute -z-10 h-0 w-0 overflow-hidden opacity-0 select-none",...ex}),"bottom"===b&&(0,n.jsx)("div",{className:"px-3 md:px-2",children:(0,n.jsx)(f.Q,{placement:b,onRetry:(e,t)=>null==U?void 0:U(e,t)})}),(0,n.jsxs)(aI,{onClick:eI,className:(0,c.A)("border border-transparent",ed&&ei&&"animated-loading-background",ev?"transition-all duration-500 ring-1 ring-border-300/50 dark:ring-border-300/50":"",ey?"border-dashed bg-clip-padding !border-border-200 shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%)]":"shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-300)/0.15)] hover:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] hover:focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)]"),children:[(0,n.jsxs)("div",{className:"flex flex-col gap-3.5 m-3.5",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(M.P,{ref:eo,prompt:Y,tipTapEditorState:B,setTipTapEditorState:eE,onSubmit:eS,onReady:z,placement:b,placeholder:null!=R?R:ef?e_?(0,i.O)({id:"spread_attempt_mind",intl:F}):F.formatMessage({defaultMessage:"How can I help you today?",id:"XLcM6WHfQR"}):e_?(0,i.O)({id:"window_edge_kiwi",intl:F}):F.formatMessage({defaultMessage:"Reply to Claude...",id:"kSt28+RchS"}),fetchInputAutocompletion:eb,className:H?"!opacity-0":void 0}),(0,n.jsx)(u.N,{children:H?(0,n.jsxs)(m.P.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"self-start flex items-center gap-2 absolute pointer-events-none inset-0 text-text-500",children:[(0,n.jsx)("div",{className:"h-6 items-center inline-flex",children:(0,n.jsx)(r.ce,{size:20})}),H]}):ev&&Y?(0,n.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 pointer-events-none overflow-hidden rounded",children:(0,n.jsx)(m.P.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-always-white/20 dark:via-always-white/10 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:1.5,ease:"easeInOut",repeat:1/0}})}):null})]}),(0,n.jsx)(tc,{placement:b,isDisabled:eC})]}),(0,n.jsx)(tp,{}),eO]}),"bottom"!==b&&(0,n.jsx)("div",{className:"px-3 md:px-2",children:(0,n.jsx)(f.Q,{placement:b,onRetry:(e,t)=>null==U?void 0:U(e,t)})}),"bottom"===b&&(0,n.jsx)(aT,{})]}),(0,n.jsx)(a_,{})]}):(0,n.jsxs)(aD,{children:[(0,n.jsx)(aI,{className:"bottom"===b?"h-[99px]":"h-[123px]"}),"bottom"===b&&(0,n.jsx)(aT,{})]})});aS.displayName="ChatInputContent";let aE=(0,p.forwardRef)((e,t)=>{let{disabled:a,placement:s,placeholder:l,onSubmit:i,onReady:r,onRetry:o}=e;return(0,n.jsx)(e5.Xx,{placement:s,children:(0,n.jsx)(aS,{ref:t,disabled:a,placement:s,placeholder:l,onSubmit:i,onReady:r,onRetry:o})})});aE.displayName="ChatInput";let aI=l.J.div(aA()),aT=l.J.div(aN()),aD=l.J.fieldset(aC())},49194:(e,t,a)=>{a.d(t,{X:()=>s});function s(e){return"default"===e.type?e.key:e.uuid}},50163:(e,t,a)=>{a.d(t,{L:()=>l,NuxProvider:()=>i});var s=a(54568),n=a(7620);let l=(0,n.createContext)(null);function i(e){let{children:t}=e,[a,i]=(0,n.useState)({items:{},currentlyShowing:null}),o=(0,n.useCallback)((e,t)=>{i(a=>{if(a.items[e])return a;let s={...a.items,[e]:t};return{items:s,currentlyShowing:r(s,!0)}})},[]),d=(0,n.useCallback)(e=>{i(t=>{let{[e]:a,...s}=t.items;return{items:s,currentlyShowing:t.currentlyShowing===e?r(s):t.currentlyShowing}})},[]),c={items:a.items,currentlyShowing:a.currentlyShowing,registerNux:o,unregisterNux:d};return(0,s.jsx)(l.Provider,{value:c,children:t})}let r=(e,t)=>{let a=Object.entries(e).sort((e,t)=>{let a=e[1].priority||0,s=t[1].priority||0;return a!==s?s-a:new Date(t[1].dateAdded).getTime()-new Date(e[1].dateAdded).getTime()});if(t){var s,n;return null!=(n=null==(s=a[0])?void 0:s[0])?n:null}for(let[e,t]of a)if(t.showAfterOthersDismiss)return e;return null}},51291:(e,t,a)=>{a.d(t,{P:()=>H});var s=a(54568),n=a(7620);let l=(0,n.createContext)({setOverrideSubmit:()=>!1});var i=a(91961),r=a(64863),o=a(97618),d=a(40082),c=a(49267),u=a(98300),m=a(88596),p=a(16555),h=a(78660),x=a(20591),g=a.n(x);let f=new d.hs("inputAutocomplete"),v=()=>({decoration:null,completion:null}),y=(e,t)=>d.LN.atEnd(e).$anchor.pos===t.$anchor.pos,b=e=>{let{editor:t}=e;if(!y(t.state.doc,t.state.selection))return!1;let a=f.getState(t.state);return!!a.decoration&&(t.view.dispatch(t.state.tr.insertText(a.completion.content)),!0)},j=(e,t,a,s)=>{let n=e.getMeta(f);if(n&&n.prompt===s.doc.textContent&&(t.completion=n),!y(s.doc,s.selection)||!t.completion||t.completion.prompt!==s.doc.textContent)return t.decoration=null,t;let l=document.createElement("span");l.className="text-text-500",l.textContent=t.completion.content;let i=document.createElement("span");i.className="ml-1 px-1 border rounded-lg align-[1px] font-medium text-xs text-text-500",i.textContent="Tab";let r=s.selection.$head.pos,o=h.NZ.widget(r,l),d=h.NZ.widget(r,i);return t.decoration=h.zF.create(s.doc,[o,d]),t},w=c.YY.create({name:"inputAutocompletion",addOptions:()=>({fetchInputAutocompletion:e=>Promise.resolve("")}),addProseMirrorPlugins(){let e=g()(async(e,t)=>{try{let a=this.options.fetchInputAutocompletion,s=await a(t);s&&e.dispatch(e.state.tr.setMeta(f,{prompt:t,content:s}))}catch(e){}},300);return[new d.k_({key:f,state:{init:v,apply:j},props:{decorations(e){return this.getState(e).decoration}},view:t=>{let{textContent:a}=t.state.doc;return a.length>=3&&e(t,a),{update:(t,a)=>{var s;let{state:n}=t,{doc:l}=n;!a.doc.eq(l)&&(null==(s=f.getState(n).completion)?void 0:s.prompt)!==l.textContent&&l.textContent.length>=3&&e(t,l.textContent)}}}})]},addKeyboardShortcuts:()=>({Tab:b})});var k=a(74530);let M=e=>0===e.state.selection.$from.parentOffset,_=e=>e.state.selection.$from.marks().some(e=>"code"===e.type.name),A=e=>"heading"===e.state.selection.$from.parent.type.name,N=e=>{let t=e.state.selection.$from;return t.parentOffset===t.parent.nodeSize-2},C=e=>{let t=e.state.tr;t.setStoredMarks([]),t.insertText("​"),e.view.dispatch(t)},S=e=>!(e.state.selection.$from.after()<e.state.doc.content.size)&&(C(e),!0),E=e=>!(e.state.selection.$from.before()>0)&&e.chain().insertContentAt(0,"<p></p>").run(),I=e=>!(e.state.selection.$from.after()<e.state.doc.content.size)&&e.chain().insertContent("<p></p>").run(),T=c.YY.create({name:"CodeBlockKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return"codeBlock"===t.state.selection.$from.parent.type.name&&!!M(t)&&E(t)}})}),D=c.YY.create({name:"InlineCodeKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return!!_(t)&&!!M(t)&&E(t)},ArrowDown:e=>{let{editor:t}=e;return!!_(t)&&!!N(t)&&I(t)},ArrowRight:e=>{let{editor:t}=e;return!!_(t)&&!!N(t)&&S(t)},ArrowLeft:e=>{let{editor:t}=e;return!!_(t)&&!!M(t)&&(e=>!(e.state.selection.$from.before()>0)&&(C(e),!0))(t)}})}),O=c.YY.create({name:"HeadingKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowUp:e=>{let{editor:t}=e;return!!A(t)&&!!M(t)&&E(t)},ArrowDown:e=>{let{editor:t}=e;return!!A(t)&&!!N(t)&&I(t)}})}),L=c.YY.create({name:"BoldKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"bold"===e.type.name)&&!!N(t)&&S(t)}})}),R=c.YY.create({name:"ItalicKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"italic"===e.type.name)&&!!N(t)&&S(t)}})}),P=c.YY.create({name:"StrikeKeyboardNavExtension",addKeyboardShortcuts:()=>({ArrowRight:e=>{let{editor:t}=e;return!!t.state.selection.$from.marks().some(e=>"strike"===e.type.name)&&!!N(t)&&S(t)}})}),z=c.YY.create({name:"PTagShiftEnterCreateExtension",addKeyboardShortcuts:()=>({"Shift-Enter":e=>{let{editor:t}=e;return t.commands.enter(),t.commands.scrollIntoView(),!0},"Alt-Enter":e=>{let{editor:t}=e;return t.commands.enter(),t.commands.scrollIntoView(),!0}})}),U=c.YY.create({name:"pasteCodeAsPlainText",addProseMirrorPlugins:()=>[new d.k_({key:new d.hs("pasteCodeAsPlainText"),props:{handlePaste:(e,t,a)=>{let{schema:s}=e.state;if(!t.clipboardData||!t.clipboardData.types.includes("vscode-editor-data"))return!1;let n=t.clipboardData.getData("text/plain"),l=s.text(n);return e.dispatch(e.state.tr.replaceSelectionWith(l)),!0}}})]}),F=()=>(0,s.jsx)(u.VR,{className:"code-block",children:(0,s.jsx)("pre",{className:"my-4 block rounded-md bg-[#282c34] p-2 text-[0.875rem] text-[#abb2bf]",children:(0,s.jsx)(u.$p,{as:"code"})})});var G=a(32987),Y=a(46760);let H=(0,n.forwardRef)((e,t)=>{let{className:a,disabled:c,prompt:h,tipTapEditorState:x,setTipTapEditorState:g,placeholder:f,onSubmit:v,onReady:y,placement:b,fetchInputAutocompletion:j}=e,{editor:M}=(e=>{let{tipTapEditorState:t,setTipTapEditorState:a,onReady:s,placeholder:n,extraEditorAttributes:l={},fetchInputAutocompletion:d}=e,c=[m.A.configure({codeBlock:!1,blockquote:!1,hardBreak:!1,heading:!1,horizontalRule:!1}),r.A.extend({addNodeView:()=>(0,u.gu)(F)}).configure({lowlight:p.l}),L,T,O,D,R,P,U,z,o.A.configure({placeholder:n,emptyEditorClass:"is-editor-empty before:!text-text-500 before:whitespace-nowrap"}),w.configure({fetchInputAutocompletion:d})];return{editor:(0,u.hG)({editorProps:{attributes:{enterkeyhint:"enter",...l}},onCreate:()=>{null==s||s()},autofocus:!(0,i.Fr)()&&"end",extensions:c,content:t,onUpdate(e){let{editor:t}=e,s=t.isEmpty,n=t.getJSON();a((0,k.DV)(n)),s&&t.commands.focus("end")}})}})({tipTapEditorState:x,setTipTapEditorState:g,onReady:y,placeholder:f,fetchInputAutocompletion:j,extraEditorAttributes:{role:"textbox","aria-label":(0,Y.A)().formatMessage({defaultMessage:"Write your prompt to Claude",id:"Lxn7p6AQvE"}),"aria-multiline":"true","aria-required":"false","aria-invalid":"false"}}),[_,A]=(0,n.useState)(!1);(0,n.useImperativeHandle)(t,()=>({setContent(e){e!==h&&(null==M||M.commands.setContent(e,!1,{preserveWhitespace:"full"}))},setEditable(e){M.setOptions({editable:e})},focus(){null==M||M.commands.focus()},getPosition:()=>null==M?void 0:M.state.selection.$anchor,getEditor:()=>M,getIsAtEnd(){if(!M)return;let e=M.state.selection.$anchor.pos;return d.LN.atEnd(M.state.doc).$anchor.pos===e},scrollToEnd(){M&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{M.commands.setTextSelection(M.state.doc.content.size),M.commands.scrollIntoView();let e=M.view.dom.parentElement;e&&(e.scrollTop=e.scrollHeight)})})}}),[M,h]),(0,n.useEffect)(()=>{null==M||M.setOptions({editable:!c})},[M,c]),(0,n.useEffect)(()=>{if(null!==M&&""!==f){let e=M.extensionManager.extensions.filter(e=>"placeholder"===e.name)[0];e&&(e.options.placeholder=f,M.view.dispatch(M.state.tr))}},[M,f]);let N=(0,n.useCallback)(e=>{"Enter"===e.key&&v&&(_||e.shiftKey||e.altKey||e.nativeEvent.isComposing||(0,i.Fr)()&&!e.metaKey&&!e.ctrlKey||(e.preventDefault(),v(e)))},[v,_]);return(0,s.jsx)(l.Provider,{value:{setOverrideSubmit:A},children:(0,s.jsx)(u.$Z,{className:(0,G.A)("max-h-96 w-full overflow-y-auto font-large break-words transition-opacity duration-200","bottom"===b?"min-h-[1.5rem]":"min-h-[3rem]",!(null==M?void 0:M.isEditable)&&"opacity-60",a),editor:M,onKeyDownCapture:N})})});H.displayName="PromptInput"},51699:(e,t,a)=>{a.d(t,{Kk:()=>b});var s=a(54568),n=a(1761),l=a(15964),i=a(41417),r=a(77101),o=a(77520),d=a(68736),c=a(32987),u=a(7620),m=a(62971),p=a(46760),h=a(92075),x=a(81527),g=a(32805),f=a(60629);let v=(0,s.jsx)(m.A,{defaultMessage:"Everyone in your organization can view and use this project",id:"o6dyBu92Ad"}),y=(0,s.jsx)(m.A,{defaultMessage:"Only invited members can view and use this project",id:"r65HKpZU8I"});function b(e){var t,a,b,j,w,k;let{syncSources:M=[],onProjectCreated:_,onError:A,onCancel:N,strings:C}=e,S=(0,p.A)(),E=(0,n.mV)(),I=(0,f.AI)(),{customInstructions:T,type:D,subtype:O}=null!=I?I:{},[L,R]=(0,u.useState)({name:"",description:null!=(t=C.createProjectDescriptionDefault)?t:"",type:D,subtype:O,is_private:!0}),[P,z]=(0,u.useState)({}),[U,F]=(0,u.useState)(!1),G=M.length>0,Y=M.some(e=>e.type===r.v8.GITHUB),H=M.some(e=>e.type===r.v8.GDRIVE),B=Y&&H?(0,s.jsx)(m.A,{defaultMessage:"Github and GDrive attachments can only be added to private projects",id:"rqNebqAfPF"}):Y?(0,s.jsx)(m.A,{defaultMessage:"Github attachments can only be added to private projects",id:"eyujXWQfg4"}):H?(0,s.jsx)(m.A,{defaultMessage:"GDrive attachments can only be added to private projects",id:"DMBgAV43lL"}):(0,s.jsx)(m.A,{defaultMessage:"Some of these attachments can only be added to private projects",id:"2ssKO1VReL"}),{mutateAsync:V}=(0,x.bL)(),{activeOrganization:K}=(0,n.YL)(),{data:W}=(0,x.BN)(),{data:q,isLoading:X}=(0,x.PL)(),{data:$}=(0,h.q)(),J=$&&!G,Z=!X&&(null==q?void 0:q.count)===0,Q=e=>t=>{R(a=>({...a,[e]:t.target.value})),z(t=>({...t,[e]:null}))},ee=e=>{R(t=>({...t,is_private:e.target.checked&&"private"===e.target.value}))},et=async e=>{if(e.preventDefault(),!U&&(()=>{let e={};return""===L.name.trim()&&(e.name=S.formatMessage({defaultMessage:"Project name is required",id:"n5cqkMmIMW"})),z(e),0===Object.keys(e).length})()){F(!0);try{let e={...L};T&&(e.prompt_template=T.replaceAll("{{PROJECT_NAME}}",L.name));let t=await V(e);_(t)}catch(e){A(e)}finally{F(!1)}}};return(0,s.jsxs)("form",{className:"grid grid-cols-1 gap-4",onSubmit:e=>et(e),children:[Z&&!I&&(0,s.jsxs)("div",{className:"bg-bg-300 border-border-400/10 text-text-300 flex w-full flex-col items-start justify-start gap-2 rounded-xl border px-5 pb-5 pt-4 text-sm",children:[(0,s.jsx)("div",{className:"flex items-center gap-1 font-medium",children:(0,s.jsx)(m.A,{defaultMessage:"How to use projects",id:"moKJkVk/qB"})}),E?(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{children:(0,s.jsx)(m.A,{defaultMessage:"Use Projects with your team to do things like:",id:"fcUpqajVgl"})}),(0,s.jsxs)("ul",{className:"list-disc pl-4",children:[(0,s.jsx)("li",{children:(0,s.jsx)(m.A,{defaultMessage:"Query and analyze information about customers, sales calls, and project plans",id:"1YyB53/KOc"})}),(0,s.jsx)("li",{children:(0,s.jsx)(m.A,{defaultMessage:"Upload files from your codebase to understand, improve, and contribute",id:"HXj87AQH0P"})}),(0,s.jsx)("li",{children:(0,s.jsx)(m.A,{defaultMessage:"Generate analysis and reports from one consistent set of materials",id:"3XvEQYrcUv"})}),(0,s.jsx)("li",{children:(0,s.jsx)(m.A,{defaultMessage:"Create content informed by company policies and documentation",id:"HrODk029zr"})})]}),(0,s.jsx)("p",{children:(0,s.jsx)(m.A,{defaultMessage:"Start by creating a memorable title and description to organize your project. You can always edit it later.",id:"qEWJMy5mr7"})})]}):(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("p",{children:(0,s.jsx)(m.A,{defaultMessage:"Projects help organize your work and leverage knowledge across multiple conversations. Upload docs, code, and files to create themed collections that Claude can reference again and again.",id:"7HFalNigyO"})}),(0,s.jsx)("p",{children:(0,s.jsx)(m.A,{defaultMessage:"Start by creating a memorable title and description to organize your project. You can always edit it later.",id:"qEWJMy5mr7"})})]}),W&&(0,s.jsx)("div",{children:(0,s.jsx)(m.A,{defaultMessage:"Curious to learn more? <link>Try an example project</link>",id:"+AcqvUzRry",values:{link:e=>(0,s.jsx)(i.$,{variant:"underline",size:"unset",href:"/project/".concat(W),children:e})}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ks,{autoFocus:!0,name:"name",className:"w-full",label:null!=(a=C.createProjectNameLabel)?a:S.formatMessage({defaultMessage:"What are you working on?",id:"R2IogQsIBI"}),placeholder:null!=(b=C.createProjectNamePlaceholder)?b:S.formatMessage({defaultMessage:"Name your project",id:"BtIbm/e/WX"}),size:"lg",onChange:Q("name"),error:!!P.name,"data-1p-ignore":!0}),P.name&&(0,s.jsx)("div",{className:"text-danger-000 mt-1 text-right text-xs font-medium",children:P.name})]}),!I&&(0,s.jsx)("div",{children:(0,s.jsx)(l.fs,{name:"description",className:"w-full",label:null!=(j=C.createProjectDescriptionLabel)?j:S.formatMessage({defaultMessage:"What are you trying to achieve?",id:"RPsTh+NBxY"}),placeholder:null!=(w=C.createProjectDescriptionPlaceholder)?w:S.formatMessage({defaultMessage:"Describe your project, goals, subject, etc...",id:"WStTnUWlP8"}),minRows:3,onChange:Q("description"),error:P.description})}),E?(0,s.jsxs)("fieldset",{children:[(0,s.jsx)("div",{className:"mb-2 text-sm font-medium",children:(0,s.jsx)(m.A,{defaultMessage:"Visibility",id:"JAkIqbzRj5"})}),(0,s.jsxs)("label",{className:(0,c.A)("mb-2 flex w-full gap-2",!J&&"opacity-40"),children:[(0,s.jsx)("input",{name:"visibility",className:"mt-0.5",type:"radio",value:"open",checked:!L.is_private,onChange:ee,disabled:!J}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)(o.m,{size:16,className:"-mt-1 mr-1 inline-block"}),null!=(k=null==K?void 0:K.name)?k:(0,s.jsx)(m.A,{defaultMessage:"Organization",id:"K56Dims7Up"})]}),(0,s.jsx)("div",{className:"text-text-300 text-xs",children:$?G?B:v:(0,s.jsx)(m.A,{defaultMessage:"Public projects are disabled by your organization",id:"c2HBgZtgDR"})})]})]}),(0,s.jsxs)("label",{className:"flex w-full gap-2",children:[(0,s.jsx)("input",{name:"visibility",className:"mt-0.5",type:"radio",value:"private",checked:L.is_private,onChange:ee}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)(d.W,{size:16,className:"-mt-1 mr-1 inline-block"}),(0,s.jsx)(m.A,{defaultMessage:"Private",id:"viXE3205/2"})]}),(0,s.jsx)("div",{className:"text-text-300 text-xs",children:y})]})]})]}):null,(0,s.jsx)("div",{className:"mt-2 flex justify-end",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.$,{onClick:N,href:N?void 0:"/projects",variant:"secondary",disabled:U,children:(0,s.jsx)(m.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,s.jsx)(g.i,{children:(0,s.jsx)(i.$,{type:"submit",loading:U,children:(0,s.jsx)(m.A,{defaultMessage:"Create project",id:"VUN1K7kSzC"})})})]})})]})}},53600:(e,t,a)=>{a.d(t,{R:()=>m,V:()=>u});var s=a(54568),n=a(89674),l=a(91961),i=a(46612),r=a(72638),o=a(89598),d=a(7620);let c=(0,d.createContext)({isExpanded:!1,setIsExpanded:()=>void 0,closeSidebarOnMobile:()=>void 0,isMobile:!1,setForceMobileLayout:()=>void 0});function u(){return(0,d.useContext)(c)}function m(e){let{children:t}=e,[a,u]=(0,n.j)(i.eT.SIDEBAR_PINNED,!1),[m,p]=(0,n.j)(i.eT.SIDEBAR_VISIBLE_ON_LOAD,!1),{width:h}=(0,r.l)(),[x,g]=d.useState(!1),f=x||(0===h?!m:h<1024),[v,y]=d.useState(m&&a);(0,o.M)("keydown",e=>{var t,a,s;let n=(0,l.cX)()?e.metaKey:e.ctrlKey;if((null==(t=e.key)?void 0:t.toLowerCase())==="."&&n&&(e.preventDefault(),y(e=>!e)),(null==(a=e.key)?void 0:a.toLowerCase())==="/"&&n&&(e.preventDefault(),y(e=>!e)),(null==(s=e.key)?void 0:s.toLowerCase())==="u"&&n){let t=document.getElementById("chat-input-file-upload-onpage")||document.getElementById("chat-input-file-upload-modal")||document.getElementById("chat-input-file-upload-bottom");t instanceof HTMLInputElement&&(e.preventDefault(),t.click())}});let b=(0,d.useMemo)(()=>({isExpanded:v,setIsExpanded:e=>{y(e),f||u(e)},closeSidebarOnMobile:()=>{f&&v&&y(!1)},isMobile:f,setForceMobileLayout:g}),[v,y,f,u,g]);return(0,d.useEffect)(()=>{f?(p(!1),y(!1)):(p(!0),y(a))},[f,p,y,a]),(0,s.jsx)(c.Provider,{value:b,children:t})}},53685:(e,t,a)=>{a.d(t,{$z:()=>o,cY:()=>r});var s=a(77186),n=a(1761),l=a(27062),i=a(21036);function r(){let e=(0,i.useLayer)("frontend"),{value:t}=(0,l.fS)("chat_suggestion_chips_enabled"),a=e.get("chat_suggestion_chips",!1);return t||a}function o(e){let{mutateAsync:t,enabled:a}=function(){let{activeOrganization:e}=(0,n.YL)(),{value:t}=(0,l.fS)("chat_autocomplete"),a=(0,s.L2)("/api/organizations/".concat(null==e?void 0:e.uuid,"/dust/chat_autocomplete"),"POST",{enabled:t,onError:()=>{console.warn("Failed to fetch completion")},meta:{noToast:!0}});return{mutateAsync:a.mutateAsync,isPending:a.isPending,isIdle:a.isIdle,enabled:t}}();return{fetchInputAutocompletion:async s=>{if(!a||!e)return"";let[n,l]=(await t({conversationUuid:null!=e?e:"",prompt:s})).prompt.split("\n").map(e=>e.trim());return"Yes"===n?" "===s[s.length-1]?l||"":" "+(l||""):"No"===n&&l||""}}}},53861:(e,t,a)=>{var s=a(85544),n=a(81527);n.gr.BeamTemplateAskClaudeV1,s.xd.EXTENDED_THINKING,n.gr.BeamTemplatePmV1,s.xd.EXTENDED_THINKING,n.gr.BeamTemplateDsV1,s.xd.EXTENDED_THINKING},54615:(e,t,a)=>{a.d(t,{D:()=>r,MessageLimitModalProvider:()=>o});var s=a(54568),n=a(7620),l=a(71165);let i=null;function r(){i&&i(!0)}function o(){let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>(i=t,()=>{i=null}),[]),(0,s.jsx)(l.v,{isOpen:e,onClose:()=>t(!1),limitType:"message_limit"})}},56273:(e,t,a)=>{a.d(t,{u:()=>u,i:()=>m});var s=a(54568),n=a(89256),l=a.n(n),i=a(7620);function r(e,t){switch(t.type){case"OPEN_COMPASS_STATUS":return{...e,selectedItem:{type:"compass",data:t.data}};case"SELECT_ATTACHMENT":return{...e,selectedItem:{type:"attachment",attachment:t.attachment}};case"SELECT_ARTIFACT":return{...e,selectedItem:{type:"artifact",id:t.id,versionUUID:t.versionUUID}};case"SELECT_DOC":return{...e,selectedItem:{type:"doc",id:t.id}};case"SELECT_FILE":return{...e,selectedItem:{type:"file",path:t.path,toolType:t.toolType,messageId:t.messageId}};case"CLEAR_SELECTED":return{...e,selectedItem:null,activeMessageUUID:void 0};case"SET_ACTIVE_MESSAGE_UUID":return{...e,activeMessageUUID:t.uuid};case"UPDATE_ATTACHMENTS":return{...e,attachments:t.attachments};case"UPDATE_FILES":return{...e,files:t.files};case"UPDATE_SYNC_SOURCES":return{...e,syncSources:t.syncSources};case"UPDATE_STREAMING_FILE":{var a,s;let n=new Map(e.streamingFiles),l=n.get(t.path);return n.set(t.path,{content:t.content,renderAs:t.renderAs,showingInRightPane:null!=(s=null!=(a=t.showingInRightPane)?a:null==l?void 0:l.showingInRightPane)&&s}),{...e,streamingFiles:n}}case"CLEAR_STREAMING_FILE":{let a=new Map(e.streamingFiles);return a.delete(t.path),{...e,streamingFiles:a}}default:return e}}let o={selectedItem:null,attachments:[],files:[],syncSources:[],activeMessageUUID:void 0,conversationUuid:void 0,streamingFiles:new Map},d={chatResourceState:o,dispatchChatResource:l()},c=(0,i.createContext)(d);function u(e){let{children:t,conversationUuid:a}=e,[n,l]=(0,i.useReducer)(r,{...o,conversationUuid:a}),d=(0,i.useMemo)(()=>({chatResourceState:n,dispatchChatResource:l}),[n,l]);return(0,s.jsx)(c.Provider,{value:d,children:t})}function m(){return(0,i.useContext)(c)}},56704:(e,t,a)=>{a.d(t,{CD:()=>o});var s=a(77186),n=a(1761),l=a(71473),i=a(77101),r=a(85717);let o=()=>{let e=(0,r.$f)(),t=(0,r.vT)(),a=(0,r.K6)(),{data:s}=d(i.v8.GDRIVE),n=null==s?void 0:s.state;return!!(e&&t&&a&&n&&[i.I5.CREATED,i.I5.UPDATING,i.I5.PENDING].includes(n))},d=e=>{let{account:t,activeOrganization:a}=(0,n.YL)(),r=null==t?void 0:t.uuid,o=null==a?void 0:a.uuid;return(0,s.Sk)("/api/organizations/".concat(o,"/sync/ingestion/").concat(e,"/progress"),{queryKey:[l.hx,{orgUuid:o,accountUuid:r,syncSourceType:e}],enabled:!!a,refetchInterval:e=>{let t;return!!(e.state.data&&(t=e.state.data.state,[i.I5.CREATED,i.I5.PENDING,i.I5.UPDATING].includes(t)))&&6e4},meta:{noToast:!0}})}},61906:(e,t,a)=>{a.d(t,{EY:()=>r,jc:()=>o});var s=a(77186),n=a(1761),l=a(21036);let i=()=>{let{activeOrganization:e}=(0,n.YL)(),t=null==e?void 0:e.uuid,a=(0,n.h0)(),i=(0,l.useLayer)("trials_freemium"),r=!a&&(i.get("free_thinking",!1)||i.get("free_opus",!1))&&!!t;return(0,s.Sk)("/api/organizations/".concat(t,"/feature_limits"),{queryKey:["FEATURE_LIMITS",t],enabled:r,staleTime:3e5})},r=()=>{let{data:e,...t}=i(),a=null==e?void 0:e.limits.find(e=>"thinking"===e.feature);return{...t,data:a}},o=()=>{let{data:e,...t}=i(),a=null==e?void 0:e.limits.find(e=>"opus_4"===e.feature);return{...t,data:a}}},68195:(e,t,a)=>{a.d(t,{Q:()=>eB,I:()=>eH});var s=a(54568),n=a(7726),l=a(85644),i=a(9896),r=a(70958),o=a(98518),d=a(1761),c=a(46612),u=a(23661),m=a(27062),p=a(77101),h=a(90119),x=a(10097),g=a(7620),f=a(62971),v=a(34116),y=a(52909),b=a(85717),j=a(92947),w=a(91768),k=a(56704),M=a(56147),_=a(56273),A=a(38807),N=a(8559),C=a(57383),S=a(41417),E=a(21036),I=a(32987),T=a(68864),D=a(14786),O=a(80079),L=a(69916),R=a(18179),P=a(37076),z=a(36208),U=a(96712),F=a(78730),G=a(90384),Y=a(74027),H=a(23952),B=a(15964);function V(e){let{onReady:t,children:a,onSuccess:n}=e,l=(0,H.useStripe)(),i=(0,H.useElements)(),{account:r}=(0,d.YL)(),[o,c]=(0,g.useState)(null),[u,m]=(0,g.useState)(!1),[p,h]=(0,g.useState)(!1),{mutateAsync:x}=(0,v.k0)(),y=async()=>{if(!u&&l&&i){m(!0);try{let e=await i.submit();if(e.error){e.error.message&&c(e.error.message);return}let t=await x(),{error:a}=await l.confirmPayment({elements:i,clientSecret:t.clientSecret,redirect:"if_required"});(null==a?void 0:a.message)&&"validation_error"!==a.type&&c(a.message),a||n()}catch(e){c(e.message)}finally{m(!1)}}};return(0,s.jsxs)(B.lV,{onSubmit:()=>{u||y()},children:[(0,s.jsx)(H.PaymentElement,{id:"payment-element",options:{readOnly:u,layout:"tabs",terms:{card:"never"},defaultValues:{billingDetails:{email:null==r?void 0:r.email_address,name:null==r?void 0:r.full_name}}},onReady:()=>{h(!0),t&&t()}}),o&&(0,s.jsx)("div",{className:"text-danger-000 mt-4",id:"payment-message",children:o}),(0,s.jsxs)("div",{className:"mt-5 flex flex-row flex-wrap items-center justify-end gap-3",children:[a,(0,s.jsx)(S.$,{type:"submit",loading:u,variant:"flat",className:"bg-accent-pro-100 hover:bg-accent-pro-200 w-full py-6",disabled:!p,children:(0,s.jsx)(f.A,{defaultMessage:"Confirm payment",id:"Dja1nAdMHW"})})]}),(0,s.jsx)("div",{className:"mt-3 text-text-500 text-sm text-center",children:(0,s.jsx)(f.A,{defaultMessage:"By providing your payment information, you allow Anthropic to charge your card in the amount above. Purchase non-refundable.",id:"0L0VGgMTRs"})})]})}function K(e){let{amount:t,currency:a,children:n,className:l,onSuccess:i}=e,r=(0,F.ib)(),[o,d]=(0,g.useState)(!0),{theme:u,mode:m}=(0,Y.D)(),p=(0,U.l)().get(c.eT.COLOR_MODE),h={fontSizeBase:"16px",colorBackground:(0,G.w)(u,m,p,"bg-000"),colorText:(0,G.w)(u,m,p,"text-100")},x={mode:"payment",amount:t,currency:null==a?void 0:a.toLowerCase(),payment_method_types:["card","link"],loader:"never",appearance:{theme:"stripe",variables:h}};return(0,s.jsxs)("div",{className:(0,I.A)("relative",l),children:[(0,s.jsx)("div",{className:(0,I.A)("w-full pt-1 transition-opacity duration-1000",{"opacity-0":o}),children:(0,s.jsx)(H.Elements,{options:x,stripe:r,children:(0,s.jsx)(V,{onReady:()=>d(!1),onSuccess:i,children:n})})}),o&&(0,s.jsx)(W,{})]})}let W=()=>(0,s.jsx)("div",{className:"absolute inset-0 flex h-full w-full items-center justify-center",children:(0,s.jsx)(R.Loading,{})});function q(e){var t,a;let n,{isOpen:l,onClose:i,conversationUuid:r}=e,o=(0,L.Y)(),{activeOrganization:c}=(0,d.YL)(),u=(0,O.$)(),m=(0,g.useCallback)(()=>{o.addSuccess((0,s.jsx)(f.A,{defaultMessage:"Message limits reset. Let’s chat!",id:"LGCoQdVha4"})),(null==c?void 0:c.uuid)&&r&&u({type:"within_limit"},c.uuid,r),i()},[null==c?void 0:c.uuid,r,i,o,u]),{data:p,isLoading:h}=(0,v.Zr)();return p&&(n=(0,z.vv)(p.price+(null!=(t=p.taxAmount)?t:0),p.currency,{preferWholeNumber:!0})),(0,s.jsx)(P.aF,{isOpen:l,onClose:i,title:(0,s.jsx)("div",{className:"text-text-200 font-ui-serif text-xl font-medium tracking-tight mt-2",children:(0,s.jsx)(f.A,{defaultMessage:"Reset usage limits",id:"YKpO8tTise"})}),hasCloseButton:!0,modalSize:"lg",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex p-3 justify-center items-center gap-10 self-stretch rounded-xl border border-accent-pro-100 bg-accent-pro-900 mt-6",children:[(0,s.jsx)("div",{className:"flex flex-col px-5 gap-2",children:h||!p?(0,s.jsx)(R.Loading,{size:"sm"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-text-100 text-3xl/6 font-medium tracking-tighter",children:n}),null===p.taxAmount&&(0,s.jsx)("p",{className:"text-text-500 text-sm/3 tracking-tight text-nowrap",children:(0,s.jsx)(f.A,{defaultMessage:"+ tax",id:"H/9uGFjKzR"})})]})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("p",{className:"text-text-200 text-sm tracking-tight",children:(0,s.jsx)(f.A,{defaultMessage:"Immediately get access to Claude instead of waiting for usage limits to reset.",id:"6Gj58FRZ27"})}),(0,s.jsx)("p",{className:"text-text-200 text-sm tracking-tight",children:(0,s.jsx)(f.A,{defaultMessage:"This is a one-time payment.",id:"lVfQHZlUq0"})})]})]}),(0,s.jsx)(K,{amount:p?p.price+(null!=(a=p.taxAmount)?a:0):500,currency:(null==p?void 0:p.currency)||"USD",onSuccess:m})]})})}function X(e){let{messageLimit:t,placement:a,defaultWarning:n,defaultTheme:l}=e,i=(0,E.useExperiment)("rate_limit_resets").get("allow_rate_limit_resets",!1);return i&&("exceeded_limit"===t.type||"approaching_limit"===t.type&&0===t.remaining)?(0,s.jsx)(N.L,{theme:"pro",placement:a,warning:(0,s.jsx)(J,{messageLimit:t})}):i&&"approaching_limit"===t.type?(0,s.jsx)(N.L,{theme:"info",placement:a,warning:(0,s.jsx)($,{messageLimit:t})}):(0,s.jsx)(N.L,{theme:l,warning:n,placement:a})}let $=e=>{let{messageLimit:t}=e,[a,n]=(0,g.useState)(!1);return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsxs)("div",{className:"flex w-full flex-col items-center md:flex-row gap-2",children:[(0,s.jsx)("div",{className:"flex flex-row items-center gap-2 md:w-full",children:(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-sm",children:1===t.remaining?(0,s.jsx)(f.A,{id:"RoowG4DICE",defaultMessage:"You have 1 message left before hitting usage limits"}):(0,s.jsx)(f.A,{id:"4rS9S85sm+",defaultMessage:"You have {numMessagesRemaining} messages left before hitting usage limits",values:{numMessagesRemaining:t.remaining}})})})}),(0,s.jsx)("div",{className:"-mt-px w-full whitespace-nowrap md:w-fit",children:(0,s.jsx)(S.$,{variant:"unstyled",className:(0,I.A)("@lg:w-fit w-full shrink-0","text-sm font-medium","text-accent-pro-000","hover:text-accent-pro-000 hover:bg-bg-500/40"),onClick:()=>{n(!0)},children:(0,s.jsx)(f.A,{id:"0Lg76lu7jn",defaultMessage:"Reset limits"})})})]}),(0,s.jsx)(q,{isOpen:a,onClose:()=>n(!1),conversationUuid:t.conversationUuid})]})},J=e=>{let{messageLimit:t}=e,a=T.c9.fromSeconds(t.resetsAt),[n,l]=(0,g.useState)(!1);return(0,s.jsxs)(D.q,{minimalUi:!0,actionButton:(0,s.jsxs)(S.$,{variant:"unstyled",size:"sm",className:(0,I.A)("@lg:w-fit w-full shrink-0","bg-accent-pro-100 text-oncolor-100 font-medium font-ui tracking-tight transition-colors hover:bg-accent-pro-200"),onClick:()=>{l(!0)},children:[(0,s.jsx)(f.A,{id:"0Lg76lu7jn",defaultMessage:"Reset limits"}),(0,s.jsx)("span",{className:"inline-block text-[0.65rem] bg-bg-000/20 ml-2 px-1.5 py-0.5 rounded",children:(0,s.jsx)(f.A,{id:"vroSRZd5vI",defaultMessage:"BETA"})})]}),children:[(0,s.jsx)(f.A,{id:"74NSYSM2xX",defaultMessage:"You can reset usage limits now or wait until {time}.",values:{time:(0,s.jsx)("span",{className:"inline-block",children:a.toLocaleString(T.c9.TIME_SIMPLE)})}}),(0,s.jsx)(q,{isOpen:n,onClose:()=>l(!1),conversationUuid:t.conversationUuid})]})};var Z=a(42824),Q=a(45317),ee=a(18472),et=a(11515),ea=a(62094),es=a(61773),en=a(70659);let el=()=>{let e=(0,en.lu)();return(0,s.jsxs)(Q.x,{children:[(0,s.jsx)("p",{className:"text-[13px] text-text-200",children:e?(0,s.jsx)(f.A,{defaultMessage:"Connect your tools to Claude",id:"exSmFaQCLC"}):(0,s.jsx)(f.A,{defaultMessage:"Upgrade to connect your tools to Claude",id:"kIvAPf8iSA"})}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[e&&["https://mcp.notion.com/mcp","https://mcp.canva.com/mcp","https://mcp.linear.app/sse","https://mcp.atlassian.com/v1/sse","https://mcp.asana.com/sse"].map(e=>(0,s.jsx)("div",{className:"w-3",children:(0,s.jsx)(ee.O,{size:18,children:(0,s.jsx)(et.d,{url:e,size:13,fadeInOnLoad:!0})},e)},e)),["/images/icons/messages-app.svg","/images/icons/notes-app.svg","/images/icons/chrome-app.svg"].map(e=>(0,s.jsx)("div",{className:"w-3",children:(0,s.jsx)(ee.O,{size:18,children:(0,s.jsx)(es.default,{src:e,alt:"",width:13,height:13})},e)},e))]}),(0,s.jsx)(ea.J,{size:16,className:"text-text-500"})]})]})};var ei=a(27261),er=a.n(ei),eo=a(46760);function ed(){let e=(0,d.Kq)(),t=(0,eo.A)();return(0,s.jsx)(D.q,{actionButton:null,title:t.formatMessage({defaultMessage:"Team plan canceled",id:"KuqVOfg9/0"}),children:e?(0,s.jsx)(f.A,{defaultMessage:"You can no longer chat with Claude. To restore full access, <link>renew your subscription</link>.",id:"L2pC0kiNNO",values:{link:e=>(0,s.jsx)(er(),{className:"whitespace-nowrap font-medium underline",href:"/settings/billing",children:e})}}):(0,s.jsx)(f.A,{defaultMessage:"You can no longer chat with Claude.",id:"hxcpUUnV0b"})})}var ec=a(47959);let eu=()=>{let e=(0,ec.h)({allowSelfUpgrade:!1});return(0,s.jsx)(D.q,{actionButton:e,children:(0,s.jsx)(f.A,{defaultMessage:"Due to capacity constraints, chatting with Claude is currently not available. Please try again shortly.",id:"kfyWX0MxKQ"})})};var em=a(34281),ep=a(95675);let eh=e=>{let{className:t,...a}=e;return(0,s.jsx)("a",{className:(0,I.A)("text-text-100 font-medium hover:underline",t),...a})},ex=e=>{var t;let a,{inaccessibleSyncSources:n}=e,{chatResourceState:l}=(0,_.i)(),i=(0,em.v)(),{isDrawerExpanded:r,setIsDrawerExpanded:o}=(0,ep.x)(),d=n.every(e=>e.status.state===p.I5.UNAUTHENTICATED)&&1===new Set(n.map(e=>e.type)).size,c=null==(t=n[0])?void 0:t.type,u=(0,s.jsx)("button",{onClick:()=>{o(!0)},children:(0,s.jsx)(eh,{children:(0,s.jsx)(f.A,{defaultMessage:"Show {count, plural, one {# Item} other {# Items}}",id:"1HlfJxfH7H",values:{count:n.length}})})});return d&&null!==c?a=(0,s.jsx)("button",{onClick:()=>i(c),children:(0,s.jsx)(eh,{children:(0,s.jsx)(f.A,{defaultMessage:"Reconnect with {sourceName}",id:"dUareRZF9G",values:{sourceName:p.sb[c]}})})}):l.conversationUuid&&!r&&(a=u),(0,s.jsx)(Q.x,{children:(0,s.jsx)(f.A,{defaultMessage:"Some of your content could not be loaded. {actionButton}",id:"Ibsz06ys2B",values:{actionButton:a}})})};var eg=a(75006);let ef=eg.z.array(eg.z.object({text:eg.z.string(),href:eg.z.string().optional(),button:eg.z.boolean().optional()})).nullable();function ev(e){let{messageComponents:t}=e;return(0,s.jsx)(Q.x,{children:(0,s.jsx)(ey,{messageComponents:t})})}function ey(e){let{messageComponents:t}=e;return(0,s.jsx)("div",{children:t.map((e,t)=>e.button?(0,s.jsx)(S.$,{href:e.href,target:"_blank",children:e.text},t):e.href?(0,s.jsx)(er(),{href:e.href,className:"underline",target:"_blank",children:e.text},t):(0,s.jsx)("span",{children:e.text},t))})}var eb=a(74039),ej=a(18395);function ew(e){let t=(0,L.Y)(),[a,l]=(0,g.useState)(!1),i=(0,n.bT)("push"),r=()=>{i()},o=function(e){let{stopReason:t,model:a}=e,s=(0,E.useDynamicConfig)("holdup").get("modelFallbacks",{})[a];if(s&&"refusal"===t)return s}({stopReason:e.stopReason,model:e.model}),d=e=>(0,s.jsx)("a",{onClick:r,className:"underline cursor-pointer",children:e});return(0,s.jsxs)(D.q,{actionButton:null,children:[(0,s.jsx)(ej.B,{isOpen:a,showOptions:!1,conversationUuid:e.conversationUuid,message:e.lastMessage,requestedFeedbackType:"sc/false_positive",setRequestedFeedbackType:()=>{},onClose:()=>{l(!1)},onSuccess:()=>{l(!1),t.addSuccess((0,s.jsx)(f.A,{defaultMessage:"Thanks for your feedback!",id:"coh2h6fh1P"}))}}),(0,s.jsx)("div",{className:"text-text-200 flex w-full items-center justify-between",children:(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsx)("span",{children:o?(0,s.jsx)(f.A,{defaultMessage:"<bold>Flagged by the safety classifier</bold> If you think this flag is wrong, you can start a new chat or try these: <falsePositiveButton>Let us know</falsePositiveButton> or <retryButton>retry with {fallbackName}</retryButton>",id:"hleSl+zqIN",values:{fallbackName:o.displayName,bold:e=>(0,s.jsx)("span",{className:"font-medium",children:e}),retryButton:t=>(0,s.jsx)("button",{className:"underline cursor-pointer",onClick:()=>{e.onRetryWithFallback()},children:t}),falsePositiveButton:e=>(0,s.jsx)("button",{className:"underline cursor-pointer",onClick:()=>{l(!0)},children:e})}}):"refusal"===e.stopReason?(0,s.jsx)(f.A,{defaultMessage:"Claude is unable to respond to this request, which appears to violate our <policyLink>Usage Policy</policyLink>. Please <newChat>start a new chat</newChat>.",id:"JQtAKVGSTL",values:{policyLink:e=>(0,s.jsx)("a",{href:"https://www.anthropic.com/legal/aup",target:"_blank",className:"underline cursor-pointer",children:e}),newChat:d}}):(0,s.jsx)(f.A,{defaultMessage:"Claude is unable to respond to this request. Please <newChat>start a new chat</newChat>.",id:"VZKromeiwV",values:{newChat:d}})})})})]})}var ek=a(16253),eM=a(41932),e_=a(80047);function eA(e){let{isOpen:t,setIsOpen:a,files:n,isNewConversation:l}=e,i=(0,eo.A)();return(0,s.jsxs)(P.aF,{isOpen:t,hasCloseButton:!0,title:i.formatMessage({defaultMessage:"Analysis tool required",id:"jvGhSl5Gpz"}),onClose:()=>a(!1),children:[(0,s.jsxs)("div",{className:"my-4 text-pretty flex flex-col gap-2",children:[(0,s.jsx)("div",{children:(0,s.jsx)(f.A,{defaultMessage:"Claude requires the analysis tool to be enabled to analyze the following files:",id:"DWgtKtw1y9"})}),(0,s.jsx)("ul",{className:"list-disc pl-4",children:n.map(e=>(0,s.jsx)("li",{children:e.file_name},e.file_uuid))}),(0,s.jsx)("div",{children:l?i.formatMessage({defaultMessage:"If you start this conversation without turning on the analysis tool, these files will not be available to Claude.",id:"0r1iTiKoSi"}):i.formatMessage({defaultMessage:"Please enable the analysis tool and then start a new chat in this project to analyze these files.",id:"YLHCS8L8fc"})})]}),(0,s.jsx)(P.vW,{layout:"right",children:(0,s.jsx)(P.yl,{type:"button",size:"lg",onClick:()=>a(!1),children:(0,s.jsx)(f.A,{defaultMessage:"OK",id:"kAEQyVFWDv"})})})]})}function eN(e){let{files:t,isNewConversation:a}=e,{track:n}=(0,o.st)(),{openFeaturePreviewModal:l}=(0,e_.go)(),[i,r]=(0,g.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eA,{isOpen:i,setIsOpen:r,isNewConversation:a,files:t}),(0,s.jsx)(Q.x,{children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)(f.A,{defaultMessage:"Claude cannot access some of the <a>files attached</a> to this conversation",id:"dlrqZaDnOO",values:{a:e=>(0,s.jsx)("a",{className:"underline",href:"#",onClick:()=>r(!0),children:e})}})}),(0,s.jsx)("div",{children:(0,s.jsx)("a",{className:"text-accent-secondary-000 font-medium",href:"#",onClick:()=>{n({event_key:"claudeai.settings.preview_feature.opened",source:"ooc_files_warning"}),l()},children:(0,s.jsx)(f.A,{defaultMessage:"Enable analysis tool",id:"UDUWEABw3p"})})})]})})]})}var eC=a(1336),eS=a(78217),eE=a(46127),eI=a(76761),eT=a(70497);let eD=eg.z.object({id:eg.z.string(),bodyMd:eg.z.string(),isDismissable:eg.z.boolean(),proUpsell:eg.z.boolean(),alertForModels:eg.z.array(eg.z.string())}).nullable(),eO=e=>{let{alert:t,setHideAlert:a}=e,n=(0,d.UC)(),l=(0,ec.h)();return(0,s.jsxs)(Q.x,{children:[(0,s.jsx)(eC.Lv,{children:(0,s.jsx)(eT.o,{children:t.bodyMd})}),n&&t.proUpsell&&l,t.isDismissable&&(0,s.jsx)(S.$,{className:"ml-2 h-4 w-4 translate-y-[0.5px] rounded",size:"unset",variant:"ghost",onClick:()=>a(!0),children:(0,s.jsx)(eI.X,{size:12})})]})},eL=e=>{let{className:t,...a}=e;return(0,s.jsx)("button",{className:"text-text-100 text-sm font-medium hover:underline text-nowrap",...a})};var eR=a(6568);let eP=e=>{let t=(0,eR.tA)(e.projectKnowledgebaseTokens,e.maxConversationTokens),a=(0,n.bT)("push");return(0,s.jsx)(D.q,{actionButton:(0,s.jsx)(eL,{onClick:()=>a({projectUuid:e.projectUuid}),children:(0,s.jsx)(f.A,{defaultMessage:"Start a new conversation",id:"Lc72GmPP25"})}),children:t?(0,s.jsx)(f.A,{defaultMessage:"This conversation has reached its <link>maximum length</link>. You may want to remove some files from your project’s knowledge base.",id:"8KrIIDzvA1",values:{link:e=>(0,s.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:c.q4,children:e})}}):(0,s.jsx)(f.A,{defaultMessage:"This conversation has reached its <link>maximum length</link>.",id:"h7H72fz8l5",values:{link:e=>(0,s.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:c.q4,children:e})}})})},ez=()=>(0,s.jsx)(Q.x,{children:(0,s.jsx)(f.A,{defaultMessage:"Long prompts or documents may take multiple minutes to respond",id:"bw4uiEG/kB"})});var eU=a(4708);let eF=e=>{let t,a=(0,n.bT)("push"),{tokenTotals:l,numAttachments:i,projectKnowledgebaseTokens:r}=e,{msgTokens:o,totalTokens:d,maxConversationTokens:u}=l,m=null!=r?r:0,p=(0,eR.tA)(m,u),h=d/u-1;return t=i&&p?(0,s.jsx)(f.A,{defaultMessage:"Try replacing the attached {numAttachments, plural, one {file} other {files}} with smaller excerpts or removing files from your project’s knowledge base.",id:"LZJa/izuge",values:{numAttachments:i}}):i?(0,s.jsx)(f.A,{defaultMessage:"Try replacing the attached {numAttachments, plural, one {file} other {files}} with smaller excerpts.",id:"doIlMUx6Hu",values:{numAttachments:i}}):p?(0,s.jsx)(f.A,{defaultMessage:"Try removing files from your project’s knowledge base.",id:"rTmS1cuCeD"}):(0,s.jsx)(f.A,{defaultMessage:"Try shortening your message.",id:"vd0y42PhHK"}),(0,s.jsx)(Q.x,{children:(0,s.jsxs)("span",{children:[(0,s.jsx)(f.A,{defaultMessage:"Conversation is {percentage}% over the <link>length limit</link>.",id:"IGar1JqHAm",values:{percentage:Math.ceil(100*h),link:e=>(0,s.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:c.q4,children:e})}}),"\xa0",t,"\xa0",o+m<u&&(0,s.jsx)("a",{className:"underline",href:"#",onClick:()=>a({projectUuid:e.projectUuid}),children:(0,s.jsx)(f.A,{defaultMessage:"Start a new conversation?",id:"8ha4a4N9Uq"})})]})})};var eG=a(40459);let eY=e=>{let{switchModel:t,copyText:a,modelName:n}=e;return(0,s.jsx)(Q.x,{children:(0,s.jsxs)("div",{className:"text-text-200 flex w-full items-center flex-wrap justify-between",children:[(0,s.jsx)("div",{className:"flex items-center gap-1",children:a}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("button",{className:"text-text-100 text-sm font-medium hover:underline text-nowrap",onClick:t,children:(0,s.jsx)(f.A,{defaultMessage:"Switch to {modelName}",values:{modelName:n},id:"1APwtKAkCy"})}),"\xa0"]})]})})},eH=()=>{let e=(0,w.X0)(p.v8.GMAIL),t=(0,w.X0)(p.v8.GCAL),a=(0,b.$f)();return!(0,h.V)()&&(e||t||a)},eB=e=>{var t,a,h,b,w,S,E,I,T,D,O,L,R,P,z,U,F,G,Y,H,B,V,K,W,q,$;let J,{placement:ee,onRetry:et}=e,{prompt:ea,isPromptUnsafe:es,model:en,setModel:ei,attachments:er,conversation:eo,projectUuid:ec,syncSourceUuids:em,files:ep}=(0,C.oM)(),eh=(0,n.WZ)(null==eo?void 0:eo.id),{setMcpDirectoryModalIsOpen:eg}=(0,A.tl)(),ey=(0,M.ED)(ec),ej=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=(0,n.mz)(t||""),s=null==a||null==(e=a.chat_messages)?void 0:e.at(-1);return s&&"assistant"===s.sender&&("prompt_injection_risk"===s.stop_reason||"refusal"===s.stop_reason)?{stopReason:s.stop_reason,lastMessage:s}:null}(null==eo?void 0:eo.id),e_=(null==eo?void 0:eo.id)&&ej?(0,s.jsx)(ew,{conversationUuid:eo.id,model:eo.model,lastMessage:ej.lastMessage,stopReason:ej.stopReason,onRetryWithFallback:async()=>{if(!ej.lastMessage.parent_message_uuid)return;let{model:e}=await eh.mutateAsync();et(ej.lastMessage.parent_message_uuid,e)}}):null,[eA,eC]=(0,eU.q)({projectUuid:ec,conversationUuid:null!=(a=null==eo?void 0:eo.id)?a:null,conversationTokensSoFar:null!=(h=null==eo?void 0:eo.tokensSoFar)?h:0,conversationFiles:(null!=(b=null==eo?void 0:eo.files)?b:[]).concat(ep),projectKnowledgebaseTokens:null!=(w=null==eo?void 0:eo.projectKnowledgebaseTokens)?w:ey,input:ea,attachments:er,syncSourceUuids:em,chatInputModel:en}),eI=(0,o.st)();(0,g.useEffect)(()=>{"exceeded"===eA?eI.track({event_key:"chat.conversation.token_limit_exceeded",conversation_uuid:null==eo?void 0:eo.id,project_uuid:ec}):"will-exceed"===eA&&eI.track({event_key:"chat.conversation.token_limit_will_exceed",conversation_uuid:null==eo?void 0:eo.id,project_uuid:ec})},[eI,null==eo?void 0:eo.id,ec,eA]);let{exceededMessageLimitWarning:eT,approachingMessageLimitWarning:eL,overageExceededWarning:eR,messageLimit:eB}=(0,eb.IK)(null!=(S=null==eo?void 0:eo.id)?S:null),eV="exceeded"===eA?(0,s.jsx)(eP,{projectKnowledgebaseTokens:null!=(E=null==eo?void 0:eo.projectKnowledgebaseTokens)?E:0,maxConversationTokens:eC.maxConversationTokens,projectUuid:ec}):null,{isRavenCanceled:eK}=(0,v.bF)(),eW=eK?(0,s.jsx)(ed,{}):void 0,eq=(0,d.r$)()?(0,s.jsx)(eu,{}):void 0,eX=(()=>{let{chatResourceState:e}=(0,_.i)();return[...e.syncSources||[],...(0,y.CO)(ec).data||[]].filter(e=>{var t;return p.xj.includes(null==e||null==(t=e.status)?void 0:t.state)})})(),e$=eX.length?(0,s.jsx)(ex,{inaccessibleSyncSources:eX}):void 0,{maxKbTokens:eJ,modelWithLargestContext:eZ}=(0,M.AO)(),{setStickyModelPreference:eQ}=(0,i.F)(),e0=!eZ||(null==en?void 0:en.toLowerCase())===eZ.toLowerCase(),e1="exceeded"===eA||"will-exceed"===eA,e2=!e0&&e1&&eC.totalTokens<eJ,{allModelOptions:e5}=(0,l.A9)(),e7=null==(t=e5.find(e=>e.model===eZ))?void 0:t.name,e6=(0,g.useCallback)(()=>{eZ&&(ei(eZ),eQ(eZ))},[ei,eQ,eZ]),e4=e7&&e2?(0,s.jsx)(eY,{switchModel:e6,modelName:e7,copyText:(0,s.jsx)("span",{children:(0,s.jsx)(f.A,{defaultMessage:"Your message is over the <link>length limit</link>",id:"sFF+OamRk1",values:{link:e=>(0,s.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:c.q4,children:e})}})})}):void 0,e3="will-exceed"===eA?(0,s.jsx)(eF,{tokenTotals:eC,numAttachments:er.length,projectKnowledgebaseTokens:null==eo?void 0:eo.projectKnowledgebaseTokens,projectUuid:ec}):null,e8=eC.msgTokens<1e5?null:(0,s.jsx)(ez,{}),e9=(0,k.CD)(),te=(0,d.mV)(),tt=e9&&!te?(0,s.jsx)(Q.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(x.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(f.A,{defaultMessage:"Less accurate Google Drive search results while Claude catalogs your Drive files",id:"ljvRWwDUyf"})})]})}):void 0,ta=(0,Z.U)(ec)?(0,s.jsx)(Q.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(x.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(f.A,{defaultMessage:"Project knowledge exceeds maximum. Remove files to continue.",id:"IqUMWBoy4d"})})]})}):void 0,{systemAlertFromConfig:ts}=(e=>{let t=(0,m.T9)("claude_ai_system_alerts","alert",null,eD),[a,n]=(0,eE.Vc)("".concat(e,":").concat(null==t?void 0:t.id,":hideAlertOnConversation"),!1),l=null==t?void 0:t.alertForModels,i=(0,eS.Z3)(e);return e&&(!l||l.includes(i))&&t&&!a?{systemAlertFromConfig:{alert:t,component:(0,s.jsx)(eO,{alert:t,setHideAlert:n})}}:{}})(null!=(I=null==eo?void 0:eo.id)?I:null),tn=ts?ts.component:null,tl=(0,r.u9)(),ti=function(e,t,a){let{data:n=[]}=(0,eM.uE)(a),l=(0,ek.cV)(),i=[...e,...t?t.files:[],...n].filter(e=>e.file_kind===u.M.Blob);return!l&&i.length?(0,s.jsx)(eN,{files:i,isNewConversation:!t}):null}(ep,eo,ec),tr=tl?null:ti,to=function(){let e=(0,m.T9)("claudeai_warning_message","components",null,ef);return e?(0,s.jsx)(ev,{messageComponents:e}):null}(),td=eH(),tc=(0,m.fS)("claudeai_unsafe_prompt_inline"),tu=es()&&td&&tc?(0,s.jsx)(Q.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(x.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(f.A,{defaultMessage:"Use caution before running this prompt. Malicious conversation content could trick Claude into attempting harmful actions or sharing your data.",id:"bWRp6wwzXA"})})]})}):null,tm=er.some(e=>e.origin===u.R.URLParameter)?(0,s.jsx)(Q.x,{children:(0,s.jsxs)("div",{className:"text-danger-000 flex items-center gap-1",children:[(0,s.jsx)(x.N,{className:"h-4 w-4 shrink-0",weight:"regular"}),(0,s.jsx)("span",{children:(0,s.jsx)(f.A,{defaultMessage:"Artifacts are user-generated and may contain unverified or potentially unsafe content.",id:"/0GesG9R4n"})})]})}):null,tp=null!=(D=null!=(T=null!=e_?e_:tu)?T:tm)?D:null,th=null!=ta?ta:null,tx=(0,j.ko)({shouldTrack:"onpage"===ee})&&"onpage"===ee?(0,s.jsx)(el,{}):null,tg=null!=($=null!=(q=null!=(W=null!=(K=null!=(V=null!=(B=null!=(H=null!=(Y=null!=(G=null!=(F=null!=(U=null!=(z=null!=(P=null!=(R=null!=(L=null!=(O=null!=tp?tp:th)?O:eT)?L:eR)?R:e4)?P:eV)?z:eW)?U:eq)?F:e$)?G:e3)?Y:tr)?H:e8)?B:tn)?V:tt)?K:to)?W:eL)?q:tx)?$:null;tg===tx&&(J=()=>eg(!0));let tf=ts&&ts.alert.proUpsell?"pro":eT||tr||tt||eL?"info":tx?"chin":"danger",tv=(0,d.O9)(),ty=(0,d.zc)();return!th&&eB&&(tv||ty)&&(eL||eT)&&!eG.env.NEXT_PUBLIC_DISABLE_PAYMENTS?(0,s.jsx)(X,{messageLimit:eB,defaultWarning:tg,defaultTheme:tf,placement:ee}):(0,s.jsx)(N.L,{warning:tg,placement:ee,theme:tf,onClick:J})}},73212:(e,t,a)=>{a.d(t,{l:()=>l});var s=a(91961),n=a(96406);let l=()=>{if((0,s.fJ)())return;let e=document.getElementById(n.I);e&&e.focus()}},73817:(e,t,a)=>{a.d(t,{s:()=>c});var s=a(54568),n=a(52198),l=a(91961),i=a(85544),r=a(32987),o=a(46760),d=a(96406);let c=e=>{let{path:t,inputMenuSearchQuery:a,setInputMenuSearchQuery:c,handleBack:u,className:m}=e,p=(0,o.A)(),h=(0,l.fJ)(),x={[i.xd.DRIVE]:p.formatMessage({defaultMessage:"Search Google Drive",id:"1bbXc6Z3S1"}),[i.xd.PROJECTS]:p.formatMessage({defaultMessage:"Search projects",id:"doPT7U8q21"}),[i.xd.STYLES]:p.formatMessage({defaultMessage:"Search styles",id:"9oQ0JkPwFY"})},g=t&&t in x?x[t]:p.formatMessage({defaultMessage:"Search menu",id:"lL4HM3zEqr"}),f=null===t||!!a.trim().length;return(0,s.jsxs)("div",{className:(0,r.A)("flex flex-row items-center gap-2.5 px-1.5 w-full rounded-md h-[2rem]",m),children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,s.jsx)(n.vj,{className:(0,r.A)("text-text-500/50 transition-opacity",f?"opacity-100":"opacity-0")})}),(0,s.jsx)("button",{onClick:u,className:(0,r.A)("transition-opacity text-text-500 hover:text-text-100 absolute left-0 top-0",f?"opacity-0":"opacity-100"),disabled:f,children:(0,s.jsx)("div",{className:"w-4 h-4 flex items-center justify-center",children:(0,s.jsx)(n.nk,{})})})]}),(0,s.jsx)("input",{autoFocus:!h,id:d.I,className:"block bg-transparent hide-focus-ring leading-6 placeholder:text-text-500/70 font-base text-text-300 w-full",placeholder:g,value:a,onChange:e=>c(e.target.value)})]})}},74039:(e,t,a)=>{a.d(t,{IK:()=>C,hq:()=>L,AC:()=>N});var s=a(54568),n=a(78217),l=a(80079),i=a(1761),r=a(55554),o=a(41417),d=a(46612),c=a(27062),u=a(76761),m=a(21036),p=a(68864),h=a(27261),x=a.n(h),g=a(7620),f=a(62971),v=a(34242),y=a(1390),b=a(54615),j=a(17411),w=a(45317),k=a(14786),M=a(47959);function _(e,t){var a,s,n,l,i,r,o,d;if(!e)return{windowName:null,status:null};let c=null==(d=null==t?void 0:t.startsWith("claude-opus"))||d,u=(null==(a=e["5h"])?void 0:a.status)==="exceeded_limit",m=(null==(s=e["7d"])?void 0:s.status)==="exceeded_limit",p=c&&(null==(n=e["7d_opus"])?void 0:n.status)==="exceeded_limit",h=(null==(l=e.overage)?void 0:l.status)==="exceeded_limit";if((m||u||p)&&h)return{windowName:"overage",status:e.overage};let x=[];if(u&&x.push({name:"5h",resetTime:e["5h"].resets_at}),m&&x.push({name:"7d",resetTime:e["7d"].resets_at}),p&&x.push({name:"7d_opus",resetTime:e["7d_opus"].resets_at}),x.length>1){let t=x.reduce((e,t)=>t.resetTime>e.resetTime?t:e);return{windowName:t.name,status:e[t.name]}}return p?{windowName:"7d_opus",status:e["7d_opus"]}:m?{windowName:"7d",status:e["7d"]}:u||(null==(i=e["5h"])?void 0:i.status)==="approaching_limit"?{windowName:"5h",status:e["5h"]}:(null==(r=e["7d"])?void 0:r.status)==="approaching_limit"?{windowName:"7d",status:e["7d"]}:(null==(o=e.overage)?void 0:o.status)==="approaching_limit"?{windowName:"overage",status:e.overage}:{windowName:null,status:null}}function A(){let e=(0,m.useExperiment)("claude_ai_rate_limit_modal").get("show_upgrade_modal",!1);return(0,g.useEffect)(()=>{e&&(0,b.D)()},[e]),null}let N=()=>{let{messageLimit:e}=(0,i.YL)(),{isTierSelectorEnabled:t}=(0,r.t)(),a=(0,i.mV)(),n=(0,i.O9)(),l=(0,i.zc)(),[o,d]=(0,g.useState)(!0),[c,u]=(0,g.useState)(!0),m=function(e){var t,a,s;if(!e||"within_limit"===e.type)return{isOverageScenario:!1,isBlocking:!1,isActive:!1};let n=!!e.overageDisabledReason&&"overage_not_provisioned"!==e.overageDisabledReason&&"org_level_disabled"!==e.overageDisabledReason,l=!!(null==(t=e.windows)?void 0:t.overage)||n,i=(null==(s=e.windows)||null==(a=s.overage)?void 0:a.status)==="exceeded_limit"||n;return{isOverageScenario:l,isBlocking:i,isActive:!i&&l}}(e);return m.isOverageScenario?m.isBlocking?{messageLimit:e,overageExceededWarning:(0,s.jsx)(I,{messageLimit:e,isBlocking:!0})}:{messageLimit:e,approachingMessageLimitWarning:c?(0,s.jsx)(I,{messageLimit:e,isBlocking:!1,onDismiss:()=>u(!1)}):void 0}:(null==e?void 0:e.type)==="exceeded_limit"||(null==e?void 0:e.type)==="approaching_limit"&&0===e.remaining?{messageLimit:e,exceededMessageLimitWarning:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S,{messageLimit:e,showTierSelector:t}),!n&&!a&&!l&&(0,s.jsx)(A,{})]})}:(null==e?void 0:e.type)==="approaching_limit"?{messageLimit:e,approachingMessageLimitWarning:o?(0,s.jsx)(E,{messageLimit:e,onDismiss:()=>d(!1)}):void 0}:{}},C=e=>{let t=N(),{messageLimit:a}=t,s=(null==a?void 0:a.type)==="within_limit",l=(0,n.Z3)(e),i=s?null:null==a?void 0:a.conversationUuid,r=(0,n.Z3)(null!=i?i:null);return(null==a?void 0:a.type)!=="within_limit"&&(null==a?void 0:a.perModelLimit)&&l!==r?{}:t};function S(e){let{messageLimit:t,showTierSelector:a=!1}=e,n=(0,i.mV)(),l=(0,i.O9)(),r=(0,i.zc)(),o=(0,i.tP)(),c=(0,y.o)(),u=(0,M.h)(),{account:m,activeOrganization:h}=(0,i.YL)(),v=(0,g.useMemo)(()=>{if(!m||!h)return!1;let e=m.memberships.find(e=>e.organization.uuid===h.uuid);return(null==e?void 0:e.seat_tier)==="enterprise_usage_based"},[m,h]),{windowName:b,status:w}=_(t.windows),A=(null==w?void 0:w.resets_at)||t.resetsAt,N=p.c9.fromSeconds(A),{hasOAuthTokens:C}=function(){var e;let{data:t,isLoading:a}=(0,j.Jh)();return{hasOAuthTokens:null!=(e=null==t?void 0:t.some(e=>!e.is_revoked))&&e,isLoading:a}}(),S=n&&c,E=(()=>{if(v)if(S)return(0,s.jsx)(f.A,{defaultMessage:"Extra usage is required - contact an admin to keep working",id:"Bidiq5CnYF"});else return(0,s.jsx)(f.A,{defaultMessage:"Extra usage is required",id:"fejJ1o01QI"});if("5h"===b)if(S)return(0,s.jsx)(f.A,{defaultMessage:"5-hour limit resets {time} - contact an admin to keep working",id:"JtwE+AsNoz",values:{time:N.toLocaleString(p.c9.TIME_SIMPLE)}});else return(0,s.jsx)(f.A,{defaultMessage:"5-hour limit reached ∙ resets {time}",id:"wEubEiECAS",values:{time:N.toLocaleString(p.c9.TIME_SIMPLE)}});if("7d"===b){let e=N.toFormat("cccc");return S?(0,s.jsx)(f.A,{defaultMessage:"Weekly limit resets {day} {time} - contact an admin to keep working",id:"LUFY3UYYXY",values:{day:e,time:N.toLocaleString(p.c9.TIME_SIMPLE)}}):(0,s.jsx)(f.A,{defaultMessage:"Weekly limit reached ∙ resets {day} {time}",id:"MhyGCtndd7",values:{day:e,time:N.toLocaleString(p.c9.TIME_SIMPLE)}})}if("7d_opus"===b){let e=N.toFormat("cccc");return S?(0,s.jsx)(f.A,{defaultMessage:"Opus limit resets {day} {time} - contact an admin to keep working",id:"ir+wpgGBaT",values:{day:e,time:N.toLocaleString(p.c9.TIME_SIMPLE)}}):(0,s.jsx)(f.A,{defaultMessage:"Opus limit reached ∙ resets {day} {time}",id:"9Di9WqoUCM",values:{day:e,time:N.toLocaleString(p.c9.TIME_SIMPLE)}})}return null})();return(0,s.jsxs)(k.q,{actionButton:S?null:u,minimalUi:!0,children:[E||(a?(0,s.jsx)(f.A,{defaultMessage:"Usage limit reached — your limit will reset at {time}. As an internal user, you can change your tier in the user menu to test different rate limits.",id:"Um8zFcRLL/",values:{time:(0,s.jsx)("span",{className:"inline-block",children:N.toLocaleString(p.c9.TIME_SIMPLE)})}}):r&&o?(0,s.jsx)(f.A,{defaultMessage:"Increase usage for uninterrupted work or continue at {time}.",id:"5QbZN4LMkt",values:{time:(0,s.jsx)("span",{className:"inline-block",children:N.toLocaleString(p.c9.TIME_SIMPLE)})}}):l||n||r?C?(0,s.jsx)(f.A,{defaultMessage:"Usage limit reached — your limit will reset at {time}. <link>Your limits are shared with Claude Code</link>",id:"UrobydPO9o",values:{time:(0,s.jsx)("span",{className:"inline-block",children:N.toLocaleString(p.c9.TIME_SIMPLE)}),link:e=>(0,s.jsx)(x(),{className:"underline",href:"/settings/claude-code",children:e})}}):(0,s.jsx)(f.A,{defaultMessage:"Usage limit reached — your limit will reset at {time}.",id:"bXAswF0AK8",values:{time:(0,s.jsx)("span",{className:"inline-block",children:N.toLocaleString(p.c9.TIME_SIMPLE)})}}):(0,s.jsx)(f.A,{defaultMessage:"You are out of free <link>messages</link> until {time}",id:"PKaisys/Ji",values:{time:(0,s.jsx)("span",{className:"inline-block",children:N.toLocaleString(p.c9.TIME_SIMPLE)}),link:e=>(0,s.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:d.Kf,children:e})}})),(0,s.jsx)(O,{messageLimit:t})]})}let E=e=>{let{messageLimit:t,onDismiss:a}=e,n=(0,M.h)(),{windowName:l,status:i}=_(t.windows),r=(null==i?void 0:i.resets_at)||t.resetsAt,d=p.c9.fromSeconds(r);return(0,s.jsxs)(w.x,{children:[(0,s.jsx)("span",{className:"text-text-300 text-sm",children:"5h"===l?(0,s.jsx)(f.A,{defaultMessage:"Approaching 5-hour limit",id:"TLC6m0t22W"}):"7d"===l?(0,s.jsx)(f.A,{defaultMessage:"Approaching weekly limit",id:"t2T1PWD6TI"}):(0,s.jsx)(f.A,{defaultMessage:"You’re almost out of usage - your limits will reset at {time}",id:"jKI2rDp1ds",values:{time:(0,s.jsx)("span",{className:"inline-block",children:d.toLocaleString(p.c9.TIME_SIMPLE)})}})}),(0,s.jsxs)("span",{children:[n,(0,s.jsx)(o.$,{className:"ml-2 h-6 w-6 translate-y-[0.5px] rounded !bg-transparent",size:"unset",variant:"ghost",onClick:a,children:(0,s.jsx)(u.X,{size:12})})]})]})},I=e=>{let{messageLimit:t,onDismiss:a,isBlocking:n}=e;return n?(0,s.jsx)(T,{messageLimit:t}):(0,s.jsx)(D,{messageLimit:t,onDismiss:a})},T=e=>{let{messageLimit:t}=e,a=(0,i.mV)(),n=(0,y.o)(),[l,r]=(0,g.useState)(!1);if(a&&n)return(0,s.jsx)(k.q,{actionButton:null,minimalUi:!0,dangerText:!0,children:(0,s.jsx)(f.A,{defaultMessage:"Limit reached - contact an admin to keep working",id:"f1/9b+4969"})});if((null==t?void 0:t.overageDisabledReason)==="out_of_credits"){let e=(0,s.jsx)("button",{onClick:()=>r(!0),className:"underline text-sm",children:(0,s.jsx)(f.A,{defaultMessage:"Add funds",id:"sx0aSlxLIy"})});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.q,{actionButton:e,minimalUi:!0,dangerText:!0,children:(0,s.jsx)(f.A,{defaultMessage:"Wallet empty",id:"hgChvDBkGs"})}),(0,s.jsx)(v.l,{isOpen:l,onClose:()=>r(!1)})]})}let o=(0,s.jsx)(x(),{href:"/settings/usage",className:"underline text-sm",children:(0,s.jsx)(f.A,{defaultMessage:"Manage",id:"0AzlrbMWV9"})});return(0,s.jsx)(k.q,{actionButton:o,minimalUi:!0,dangerText:!0,children:(0,s.jsx)(f.A,{defaultMessage:"Spending cap reached",id:"e2HH8SvqXl"})})},D=e=>{let{messageLimit:t,onDismiss:a}=e,{windowName:n,status:l}=_(t.windows),i=(null==l?void 0:l.resets_at)||t.resetsAt,r=p.c9.fromSeconds(i);return(0,s.jsxs)(w.x,{children:[(0,s.jsx)("span",{className:"text-text-300 text-sm",children:(()=>{if("5h"===n)return(0,s.jsx)(f.A,{defaultMessage:"5-hour limit resets {time} ∙ continuing with extra usage",id:"Imf94b7CcD",values:{time:r.toLocaleString(p.c9.TIME_SIMPLE)}});if("7d"===n){let e=r.toFormat("cccc");return(0,s.jsx)(f.A,{defaultMessage:"Weekly limit resets {day} {time} ∙ continuing with extra usage",id:"wvFU29jyYg",values:{day:e,time:r.toLocaleString(p.c9.TIME_SIMPLE)}})}if("7d_opus"===n){let e=r.toFormat("cccc");return(0,s.jsx)(f.A,{defaultMessage:"Opus limit resets {day} {time} ∙ continuing with extra usage",id:"P3sN2kt3TW",values:{day:e,time:r.toLocaleString(p.c9.TIME_SIMPLE)}})}return(0,s.jsx)(f.A,{defaultMessage:"Limit reached ∙ continuing with extra usage",id:"uWI9rRK6Dw"})})()}),(0,s.jsx)("span",{children:a&&(0,s.jsx)(o.$,{className:"ml-2 h-6 w-6 translate-y-[0.5px] rounded !bg-transparent",size:"unset",variant:"ghost",onClick:a,children:(0,s.jsx)(u.X,{size:12})})})]})},O=e=>{let{messageLimit:t}=e,{mutate:a}=(0,l.T)(t.conversationUuid),{value:n}=(0,c.fS)("can_reset_rate_limits");return n?(0,s.jsx)(o.$,{className:"ml-2",variant:"secondary",size:"sm",onClick:()=>a(),children:(0,s.jsx)(f.A,{defaultMessage:"Reset limits",id:"0Lg76lu7jn"})}):null},L=e=>{var t;let{messageLimit:a,activeOrganization:s}=(0,i.YL)(),r=(0,l.$)(),o=(0,n.Z3)(e),d=(null==a?void 0:a.type)!=="within_limit"&&null!=(t=null==a?void 0:a.conversationUuid)?t:null,c=(0,n.Z3)(d);(0,g.useEffect)(()=>{(null==s?void 0:s.uuid)&&a&&"within_limit"!==a.type&&c!==o&&r({type:"within_limit"},s.uuid,e)},[e,c,s,a,o,r])}},77336:(e,t,a)=>{a.d(t,{E:()=>n,V:()=>l});var s=a(7620);function n(e){let t=[];for(let s of e){var a;for(let e of null!=(a=s.files_v2)?a:s.files)"file_kind"in e&&t.push(e)}return t}let l=e=>(0,s.useMemo)(()=>n(e),[e])},80047:(e,t,a)=>{a.d(t,{TW:()=>S,go:()=>C,wU:()=>N});var s=a(54568),n=a(68096),l=a(33200),i=a(70958),r=a(98518),o=a(1761),d=a(69916),c=a(15046),u=a(22529),m=a(37076),p=a(98411),h=a(12072),x=a(27062),g=a(89256),f=a.n(g),v=a(61773),y=a(7620),b=a(62971),j=a(46760),w=a(75006);let k=w.z.object({title:w.z.string(),description:w.z.string(),shortDescription:w.z.string().optional(),titleKey:w.z.string().optional(),descriptionKey:w.z.string().optional(),shortDescriptionKey:w.z.string().optional()}),M=w.z.object({preview_feature_uses_artifacts:k.optional(),preview_feature_uses_latex:k.optional(),preview_feature_uses_citations:k.optional(),enabled_artifacts_attachments:k.optional(),enabled_turmeric:k.optional(),enabled_gdrive:k.optional(),enabled_bananagrams:k.optional(),enabled_web_search:k.optional(),enabled_sourdough:k.optional(),enabled_foccacia:k.optional(),enabled_monkeys_in_a_barrel:k.optional()}),_={},A=(0,y.createContext)({openFeaturePreviewModal:f()}),N=e=>{let{children:t}=e,[a,n]=(0,y.useState)(!1);return(0,s.jsxs)(A.Provider,{value:{openFeaturePreviewModal:()=>n(!0)},children:[t,(0,s.jsx)(m.aF,{modalSize:"xl",isOpen:a,onClose:()=>n(!1),hasCloseButton:!0,title:(0,s.jsx)(b.A,{defaultMessage:"Feature preview",id:"3H/t1552xG"}),children:(0,s.jsx)(S,{})})]})},C=()=>(0,y.useContext)(A);function S(e){let{includeTitle:t}=e,a=function(){let e=(0,x.T9)("fp_menu","features",_,M),{value:t,source:a}=(0,l.N)({}),{preview_feature_uses_artifacts:s,enabled_artifacts_attachments:n,preview_feature_uses_latex:i,enabled_monkeys_in_a_barrel:r,enabled_turmeric:o,...d}=e,c={...d};return t&&"experiment"===a&&s||(c.enabled_artifacts_attachments=n),r&&(c.enabled_monkeys_in_a_barrel=r),c}(),i=Object.keys(a).length>0,{account:r}=(0,o.YL)(),{mutate:d}=(0,n.Jy)(),c=(0,y.useRef)(!1);if((0,y.useEffect)(()=>{if(!(null==r?void 0:r.settings)||c.current)return;c.current=!0;let e=r.settings.enabled_monkeys_in_a_barrel,t=r.settings.preview_feature_uses_artifacts,a=r.settings.enabled_artifacts_attachments;e&&!t&&d({...r.settings,preview_feature_uses_artifacts:!0}),e&&a&&d({...r.settings,enabled_artifacts_attachments:!1})},[null==r?void 0:r.settings,d]),!i)return;let u=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.eE,{id:"feature-preview",children:(0,s.jsx)(b.A,{defaultMessage:"Preview and provide feedback on upcoming enhancements to our platform. Please note: experimental features might influence Claude’s behavior and some interactions may differ from the standard experience.",id:"TJ0Nj7aQ5C"})}),(0,s.jsx)("div",{className:"flex flex-col gap-4",children:Object.entries(a).map((e,t)=>{let[a,n]=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[t>0&&(0,s.jsx)("div",{className:"border-t border-border-300"}),(0,s.jsx)(E,{label:a,...n})]},a)})})]});return t?(0,s.jsxs)(p.XY,{children:[(0,s.jsx)(p.F9,{children:(0,s.jsx)(b.A,{defaultMessage:"Experimental",id:"GOx7x4mbZd"})}),u]}):u}function E(e){var t;let{label:a,...l}=e,m=(0,j.A)(),{track:p}=(0,r.st)(),{addSuccess:x}=(0,d.Y)(),{account:g}=(0,o.YL)(),{mutate:f}=(0,n.Jy)(),{checked:w}=I(a),k=(0,i.t5)(),M="enabled_monkeys_in_a_barrel"===a&&!k,_=(0,y.useCallback)(()=>{if(!g||M)return;p({event_key:"claudeai.settings.preview_feature.toggled",account_uuid:g.uuid,feature_id:a,action:!0===w?"disable":"enable"});let e=!w;if(x(m.formatMessage({defaultMessage:"{title} {action}",id:"XuGv50sPs9"},{title:l.title,action:w?"disabled":"enabled"})),e){var t,s,n;if("enabled_monkeys_in_a_barrel"===a){let e=null==(t=g.settings)?void 0:t.enabled_artifacts_attachments,a=[];e&&a.push("Analysis Tool"),a.length>0&&x(m.formatMessage({defaultMessage:"Automatically disabled: {features}",id:"7StJBCedWA"},{features:a.join(", ")})),(null==(s=g.settings)?void 0:s.preview_feature_uses_artifacts)||x(m.formatMessage({defaultMessage:"Automatically enabled: Artifacts",id:"v5zt5SRUyk"}))}else"enabled_artifacts_attachments"===a&&(null==(n=g.settings)?void 0:n.enabled_monkeys_in_a_barrel)&&x(m.formatMessage({defaultMessage:"Automatically disabled: Files feature",id:"8T9PGQkYRT"}))}f({...g.settings,[a]:e,..."enabled_monkeys_in_a_barrel"===a&&e&&{enabled_artifacts_attachments:!1,preview_feature_uses_artifacts:!0},..."enabled_artifacts_attachments"===a&&e&&{enabled_monkeys_in_a_barrel:!1}})},[g,p,a,w,x,m,l.title,f,M]);return(0,s.jsxs)("div",{className:"flex flex-row w-full gap-4 items-start",children:[(0,s.jsx)(v.default,{src:"/images/feature-preview/square/".concat(null!=(t=T[a])?t:"generic",".png"),style:{objectFit:"cover",width:62,height:62},className:"rounded-lg border border-border-300",width:248,height:248,alt:m.formatMessage({defaultMessage:"Preview image of feature",id:"6VliGZPeZA"})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 flex-grow",children:[(0,s.jsx)("h3",{className:"text-text-100 font-base-bold",id:"feature-".concat(a,"-title"),children:l.titleKey?(0,s.jsx)(u.X5,{id:l.titleKey}):l.title}),(0,s.jsx)("p",{className:"text-text-300 font-base",children:l.descriptionKey?(0,s.jsx)(u.X5,{id:l.descriptionKey}):l.description}),"enabled_monkeys_in_a_barrel"===a&&(0,s.jsx)("span",{className:"text-xs text-text-500",children:(0,s.jsx)(b.A,{defaultMessage:"This feature gives Claude network access to create and analyze files, which has security risks. Monitor chats closely when using this feature.",id:"lRBrGrai48"})})]}),(0,s.jsx)("label",{className:"cursor-pointer mt-2",children:(0,s.jsx)(h.Tooltip,{tooltipContent:M?(0,s.jsx)(b.A,{defaultMessage:"This feature has been disabled by your administrator.",id:"Jpvq2WYysx"}):"enabled_monkeys_in_a_barrel"===a?(0,s.jsx)(b.A,{defaultMessage:"This is an upgrade to the analysis tool. It does not support versioning or remixing of Artifacts.",id:"OT4Z/tnKXZ"}):null,children:(0,s.jsx)("div",{children:(0,s.jsx)(c.j,{checked:!!w,onChange:_,"aria-labelledby":"feature-".concat(a,"-title"),disabled:M},a)})})})]})}let I=e=>{var t,a,s,n,r,d,c,u,m;let{account:p}=(0,o.YL)(),{value:h,source:x}=(0,l.N)(null!=(r=null==p?void 0:p.settings)?r:{}),g=(0,i.u9)(),f=null!=(d=null==p||null==(t=p.settings)?void 0:t.enabled_monkeys_in_a_barrel)?d:g,v=null!=(c=null==p||null==(a=p.settings)?void 0:a.preview_feature_uses_artifacts)&&c,y="flag"===x&&h||null!=(u=null==p||null==(s=p.settings)?void 0:s.enabled_artifacts_attachments)&&u;return"enabled_monkeys_in_a_barrel"===e?{checked:f}:"enabled_artifacts_attachments"===e?{checked:y}:"preview_feature_uses_artifacts"===e?{checked:v}:{checked:null!=(m=null==p||null==(n=p.settings)?void 0:n[e])&&m}},T={preview_feature_uses_artifacts:"artifacts",preview_feature_uses_latex:"latex",preview_feature_uses_citations:"generic",enabled_artifacts_attachments:"analyse",enabled_turmeric:"turmeric",enabled_gdrive:"google-drive",enabled_web_search:"web-search",enabled_bananagrams:"bananagrams",enabled_foccacia:"foccacia",enabled_sourdough:"sourdough",enabled_monkeys_in_a_barrel:"wiggle"}},84403:(e,t,a)=>{a.d(t,{L:()=>s,f:()=>n});var s=function(e){return e.CLAUDE_CODE="claude_code",e.ORG_ENABLE_INTEGRATIONS="org_enable_integrations",e.MONKEYS_IN_A_BARREL="monkeys_in_a_barrel",e.AZURE_KNIGHT_GALLANT="azure_knight_gallant",e.RESEARCH_AND_MCP="research_and_mcp",e.ARTIFACTS_GALLERY="artifacts_gallery",e.MCP_DIRECTORY="mcp_directory",e.MEMORY_SEARCH="memory_search",e.MEMORY_SYNTHESIS="memory_synthesis",e.VOLDEMORT_LUNA_LOVEGOOD="voldemort_luna_lovegood",e}({}),n=function(e){return e.INTERACTED="interacted",e.DISMISSED="dismissed",e.NOT_TARGETED="not_targeted",e}({})},85201:(e,t,a)=>{a.d(t,{Hd:()=>o,Ob:()=>d,gB:()=>r});var s=a(1761),n=a(21036),l=a(43156),i=a(62370);let r=()=>{let e=(0,s.h0)(),t=(0,l.be)(),a=(0,i.Uz)().length>0;return!e&&!t&&a},o=()=>{let e=(0,s.h0)(),t=(0,i.Uz)().length>0;return e||t},d=()=>{let e=(0,s.h0)(),t=(0,n.useLayer)("trials_freemium");return!e&&t.get("show_upgrade_buttons",!1)}},90517:(e,t,a)=>{a.d(t,{I:()=>s});var s=function(e){return e.CREATE="create",e.CREATE_MANUALLY="create_manually",e.LIST="list",e.EDIT="edit",e}({})},92111:(e,t,a)=>{a.d(t,{V:()=>r});var s=a(54568);a(7726),a(78217),a(85644),a(1761);var n=a(52198),l=a(42e3);a(27062),a(45078);var i=a(12331);a(93770);let r=e=>{let{anchorRef:t,canShowNux:a,text:r,id:o,nuxItem:d,side:c}=e,{shouldShow:u,dismiss:m}=(0,i.z)(o,d);return u&&a?(0,s.jsx)(l.U,{side:c,anchorRef:t,onClose:m,accentColor:"secondary",introDelay:.5,children:(0,s.jsxs)("div",{className:"flex flex-row gap-2 min-w-[13rem]",children:[(0,s.jsx)(n.g5,{}),(0,s.jsx)("p",{className:"whitespace-normal",children:r})]})}):null}},95675:(e,t,a)=>{a.d(t,{_:()=>c,x:()=>d});var s=a(54568),n=a(46127),l=a(62942),i=a(7620),r=a(53600);let o=(0,i.createContext)({isDrawerExpanded:!1,setIsDrawerExpanded:()=>void 0});function d(){return(0,i.useContext)(o)}function c(e){let{children:t,conversationUuid:a}=e,d=function(e){let t=!!(0,l.useSearchParams)().get("controls")&&!(window.matchMedia&&window.matchMedia("(max-width: 767px)").matches),[a]=(0,n.Vc)("".concat(e,":chatControlsSidebarIsOpen"),t);return a}(a),{isExpanded:c,setIsExpanded:u}=(0,r.V)(),[m,p]=(0,i.useState)(d),h=(0,i.useRef)({reopenMain:!1}),x=(0,i.useCallback)(e=>{e&&(c&&(h.current.reopenMain=!0),u(!1)),!e&&h.current.reopenMain&&(h.current.reopenMain=!1,u(!0)),p(e)},[c,u,p]),g=(0,i.useMemo)(()=>({isDrawerExpanded:m,setIsDrawerExpanded:x}),[m,x]);return(0,s.jsx)(o.Provider,{value:g,children:t})}},96406:(e,t,a)=>{a.d(t,{I:()=>s});let s="chat-input-menu-search-input"},98769:(e,t,a)=>{a.d(t,{A:()=>s});let s={snappyOut:[.19,1,.22,1],inOutQuart:[.77,0,.175,1],outCirc:[.075,.82,.165,1],inOutBase:[.25,.1,.25,1]}}}]);