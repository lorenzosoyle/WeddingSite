try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6add5c9a-3f52-4223-a061-dcb899f5c141",e._sentryDebugIdIdentifier="sentry-dbid-6add5c9a-3f52-4223-a061-dcb899f5c141")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2495],{16700:(e,t,s)=>{s.d(t,{m:()=>u});var a=s(54568),l=s(1761),n=s(12072),i=s(62942),r=s(7620),o=s(62971),d=s(56147),c=s(71165);function u(e){let{children:t}=e,s=(0,i.useRouter)(),u=(0,l.h0)(),x=(0,d.aT)(),[m,f]=(0,r.useState)(!1),g=(0,r.useCallback)(()=>{x&&!u?f(!0):s.push("/projects/create")},[x,u,s]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Tooltip,{tooltipContent:(0,a.jsxs)("div",{className:"max-w-48 p-1",children:[(0,a.jsx)("p",{className:"mb-2 whitespace-break-spaces text-xs tracking-tight",children:(0,a.jsx)(o.A,{defaultMessage:"This is an example project. Create a new project to work with your own documents.",id:"aod9/juMdU"})}),(0,a.jsx)("button",{onClick:g,className:"text-accent-secondary-200 text-xs tracking-tight hover:underline cursor-pointer bg-transparent border-none p-0",children:(0,a.jsx)(o.A,{defaultMessage:"Create new project",id:"a7FtAnfVfj"})})]}),children:t}),(0,a.jsx)(c.S,{isOpen:m,onClose:()=>f(!1),limitType:"projects"})]})}},21869:(e,t,s)=>{s.d(t,{g:()=>u});var a=s(54568),l=s(15964),n=s(52198),i=s(41417),r=s(12072),o=s(21036);s(7620);var d=s(62971),c=s(80731);let u=e=>{let{isLoading:t=!1,numSelected:s,totalNumItems:u,handleSelectAll:x,handleCancel:m,handleDeleteSelected:f,handleMoveToProject:g}=e,h=(0,c.K)(),{value:p}=(0,o.useFeatureGate)("move_conversation_to_projects");return(0,a.jsxs)("div",{className:"flex items-center rounded-lg w-full gap-2.5",children:[(0,a.jsx)(r.Tooltip,{tooltipContent:s<u?(0,a.jsx)(d.A,{defaultMessage:"Select all",id:"94Fg25VD0N"}):(0,a.jsx)(d.A,{defaultMessage:"Deselect all",id:"Spd88Hdc8Z"}),side:"bottom",disableHoverableContent:!0,children:(0,a.jsx)("div",{children:(0,a.jsx)(l.Sc,{checked:s>0,variant:s===u?"check":"minus",onChange:x,label:0===s?(0,a.jsx)(d.A,{defaultMessage:"Select all",id:"94Fg25VD0N"}):(0,a.jsx)(d.A,{defaultMessage:"Select all ({numSelected})",id:"DyqTu9FCTX",values:{numSelected:s}}),hideLabel:!0,disabled:0===u})})}),(0,a.jsx)("div",{className:"font-base text-text-400",children:(0,a.jsx)(d.A,{defaultMessage:"<format>{count}</format> selected",id:"N0IAIYom8U",values:{format:e=>(0,a.jsx)("span",{className:"tabular-nums",children:e}),count:s}})}),(0,a.jsxs)("div",{className:"mr-auto flex gap-1",children:[g&&h&&p&&(0,a.jsx)(i.$,{size:"icon",tooltip:s>0&&(0,a.jsx)(d.A,{defaultMessage:"Move {numSelected, plural, one {# chat} other {# chats}} to a project",id:"TNDo7KthuR",values:{numSelected:s}}),variant:"ghost",disabled:0===s,onClick:g,children:(0,a.jsx)(n.Jt,{})}),(0,a.jsx)(i.$,{size:"icon",tooltip:s>0&&(0,a.jsx)(d.A,{defaultMessage:"Delete {numSelected} selected {numSelected, plural, one {item} other {items}}",id:"TmuLafn4Jw",values:{numSelected:s}}),variant:"ghost",disabled:0===s,onClick:f,loading:t,children:(0,a.jsx)(n.E9,{})})]}),(0,a.jsx)(i.$,{tooltip:(0,a.jsx)(d.A,{defaultMessage:"Cancel",id:"47FYwba+bI"}),size:"icon",variant:"ghost",onClick:m,children:(0,a.jsx)(n.X,{})})]})}},44879:(e,t,s)=>{s.d(t,{b:()=>T});var a=s(54568),l=s(7620),n=s(7386),i=s(69916),r=s(41417),o=s(1385),d=s(77101),c=s(26505),u=s(49645),x=s(37463),m=s(98682),f=s(61773),g=s(62971),h=s(41932),p=s(52909),j=s(23661);let v=e=>{let{doc:t,canEditKnowledgeBase:s,...i}=e,{mutate:r}=(0,h.gG)(t.project_uuid),o=(0,l.useMemo)(()=>new TextEncoder().encode(t.content).length,[t]),d={created_at:t.created_at,file_name:t.file_name,file_size:o,file_type:"",extracted_content:t.content,origin:j.R.UserUpload};return(0,a.jsx)(n.NM,{...i,file:d,handleRemove:()=>r({docUuid:t.uuid})})},y=e=>{let{file:t,projectUuid:s,canEditKnowledgeBase:l,...i}=e,{mutate:r,isPending:o}=(0,h.KU)(s);return(0,a.jsx)(n.NM,{...i,file:t,handleRemove:()=>{r({file_uuids:[t.file_uuid]})},isLoading:o})};var b=s(50498),w=s(21869),S=s(12072),M=s(11134),N=s(4705),A=s(46760),k=s(91768),C=s(74744);function D(e){let{projectUuid:t,syncSource:s,isActionsHidden:n,canEditKnowledgeBase:r,...o}=e,{mutateAsync:c}=(0,p.bG)(t),{isUpdating:u,handleUpdate:x,isFailing:m}=function(e){let{projectUuid:t,syncSource:s}=e,[a,n]=(0,l.useState)(!1),{addSuccess:r}=(0,i.Y)(),o=(0,A.A)(),{mutate:d}=(0,p.M3)(t,{onSuccess:()=>{r(o.formatMessage({defaultMessage:"Sync started",id:"yyuAtTi0E+"}))}});(0,l.useEffect)(()=>{n(!1)},[s.status]);let c=(0,k.z3)(s)||a,u=(0,k.Dd)(s),x=(0,l.useCallback)(()=>{c||(n(!0),d({sync_source_uuid:s.uuid,sync_source_config:s.config}))},[c,d,s.config,s.uuid]);return{isUpdating:c,isFailing:u,handleUpdate:x}}({projectUuid:t,syncSource:s});return(0,a.jsx)(C.br,{...o,location:"project",projectUuid:t,syncSource:s,handleRemove:()=>c(s.uuid),actions:s.type===d.v8.GITHUB?(0,a.jsx)(_,{handleUpdate:x,isFailing:m,isSyncing:u}):void 0,isSyncing:u||m})}function _(e){let{handleUpdate:t,isFailing:s,isSyncing:l}=e,i=(0,A.A)();return(0,a.jsx)(S.Tooltip,{tooltipContent:l?i.formatMessage({defaultMessage:"Syncing...",id:"S92mvo6R0o"}):s?i.formatMessage({defaultMessage:"Sync failed. Click to retry",id:"zOAqlyzs1U"}):i.formatMessage({defaultMessage:"Sync now",id:"SwsYB/OerA"}),children:(0,a.jsx)(n.G,{className:"!w-[18px] !px-0 shrink-0",onClick:t,children:l?(0,a.jsx)(M.P,{size:12,className:"animate-spin"}):s?(0,a.jsx)(N.N,{size:12}):(0,a.jsx)(M.P,{size:12})})})}var U=s(59401);let P="project_syncs",E="project_docs",I="project_linked_files";function T(e){let{project:t,canEditKnowledgeBase:s=!1,isUploadingDoc:i=!1,isUploadingDriveSync:d=!1,isUploadingOutlineSync:h=!1,isUploadingGithubSync:p=!1,setIsUploadingDoc:j,setIsUploadingDriveSync:b,setIsUploadingOutlineSync:S,setIsUploadingGithubSync:M,maxItems:N,onViewAll:A,isEditable:k}=e,{githubSyncSources:C,driveSyncSources:_,outlineSyncSources:T,projectDocs:F,linkedFiles:z,isFetchingKnowledge:L,knowledgeCount:K}=R({projectUuid:t.uuid,maxItems:N}),{isDeleting:V,selectedItems:H,handleSelect:B,selectAllItems:J,isInSelectionMode:Y,toggleSelectMode:W,handleDeleteSelected:$}=G({githubSyncSources:C,driveSyncSources:_,outlineSyncSources:T,projectDocs:F,linkedFiles:z,projectUuid:t.uuid,isEnabled:s});O({clearUploadingState:()=>null==j?void 0:j(!1),numItems:F.length+z.length}),O({clearUploadingState:()=>null==M?void 0:M(!1),numItems:C.length}),O({clearUploadingState:()=>null==b?void 0:b(!1),numItems:_.length}),O({clearUploadingState:()=>null==S?void 0:S(!1),numItems:T.length});let q=new Set(H.map(e=>{let{uuid:t}=e;return t}));if(L)return(0,a.jsx)(o.j,{className:"!rounded-2xl !h-[10rem] !w-full !bg-bg-200",variant:"light"});if(0===K&&!i&&!d&&!h&&!p)return(0,a.jsxs)("div",{className:"text-center h-[10rem] bg-bg-200 rounded-2xl flex flex-col gap-3 items-center justify-center text-text-500 font-small",children:[(0,a.jsx)(f.default,{src:"/images/illustrations/project-knowledge-light-mode.svg",alt:"",width:105,height:56,className:"dark:hidden"}),(0,a.jsx)(f.default,{src:"/images/illustrations/project-knowledge-dark-mode.svg",alt:"",width:105,height:56,className:"hidden dark:block"}),(0,a.jsx)("div",{className:"max-w-[14.5rem]",children:(0,a.jsx)(g.A,{defaultMessage:"Add PDFs, documents, or other text to reference in this project.",id:"EC12TWMoUS"})})]});let X=(0,a.jsx)(u.N,{children:Y&&(0,a.jsx)(x.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,a.jsx)(w.g,{isLoading:V,numSelected:H.length,totalNumItems:K,handleSelectAll:J,handleCancel:()=>W(!1),handleDeleteSelected:$})},"item-management-menu")}),Q={size:"stretch",isEditable:k,isInSelectionMode:Y};return(0,a.jsxs)("div",{className:"flex flex-col mb-1",children:[(0,a.jsxs)(m.o,{children:[(0,a.jsx)(u.N,{children:s&&(0,a.jsx)(x.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mb-3",children:(0,a.jsx)(U.H,{projectUuid:t.uuid})})}),(0,a.jsx)("div",{className:"ml-1 -mr-2.5",children:X}),(0,a.jsx)("ul",{className:"grid grid-cols-[repeat(auto-fill,minmax(120px,1fr))] gap-3 mt-3",children:(0,a.jsxs)(u.N,{initial:!1,children:[(0,a.jsx)(n.NG,{isShown:d,...Q}),_.map(e=>(0,a.jsx)(D,{projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:Y||!s,...Q,isSelected:q.has(e.uuid),handleSelect:(t,s)=>B({uuid:e.uuid,type:P},t,s)},e.uuid)),(0,a.jsx)(n.NG,{isShown:h,...Q},"outline-sync-loading-indicator"),T.map(e=>(0,a.jsx)(D,{projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:Y||!s,...Q,isSelected:q.has(e.uuid),handleSelect:(t,s)=>B({uuid:e.uuid,type:P},t,s)},e.uuid)),(0,a.jsx)(n.NG,{isShown:p,...Q},"github-sync-loading-indicator"),C.map(e=>(0,l.createElement)(D,{...Q,key:e.uuid,projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:Y||!s,isSelected:q.has(e.uuid),handleSelect:(t,s)=>B({uuid:e.uuid,type:P},t,s)})),(0,a.jsx)(n.NG,{isShown:i,...Q},"doc-upload-loading-indicator"),F.map(e=>(0,l.createElement)(v,{...Q,key:e.uuid,doc:e,canEditKnowledgeBase:s,isSelected:q.has(e.uuid),handleSelect:(t,s)=>B({uuid:e.uuid,type:E},t,s)})),z.map(e=>(0,l.createElement)(y,{...Q,key:e.file_uuid,file:e,projectUuid:t.uuid,canEditKnowledgeBase:s,handleSelect:(t,s)=>B({uuid:e.file_uuid,type:I},t,s),isSelected:q.has(e.file_uuid)}))]})})]}),!!A&&!!N&&K>N&&(0,a.jsx)("div",{children:(0,a.jsxs)(r.$,{variant:"unstyled",onClick:A,className:"hover:text-text-000 hover:underline !px-0 text-sm",children:[(0,a.jsx)(g.A,{defaultMessage:"View all {count} files",id:"b36mSZ46cW",values:{count:K}}),(0,a.jsx)(c.Q,{size:16,className:"inline-block pl-1"})]})})]})}let O=e=>{let{clearUploadingState:t,numItems:s}=e,a=(0,l.useRef)(s);(0,l.useEffect)(()=>{s>a.current&&t(),a.current=s},[s,t])},R=e=>{let{projectUuid:t,maxItems:s}=e,{data:a=[],isLoading:l}=(0,h.MO)(t),n=[...a],{data:i=[],isLoading:r}=(0,p.CO)(t),{data:o=[],isLoading:c}=(0,h.uE)(t),u=[...o],x=i.filter(e=>{let{type:t}=e;return t===d.v8.GDRIVE}),m=i.filter(e=>{let{type:t}=e;return t===d.v8.OUTLINE}),f=i.filter(e=>{let{type:t}=e;return t===d.v8.GITHUB});if(s){let e=s;[x,m,f,n,u].forEach(t=>{t.splice(e),e=Math.max(0,e-t.length)})}let g=[n,i,u].reduce((e,t)=>{var s;return e+(null!=(s=null==t?void 0:t.length)?s:0)},0);return{driveSyncSources:x,outlineSyncSources:m,githubSyncSources:f,projectDocs:n,linkedFiles:u,isFetchingKnowledge:l||r||c,knowledgeCount:g}},G=e=>{let{githubSyncSources:t,driveSyncSources:s,outlineSyncSources:a,projectDocs:l,linkedFiles:n,projectUuid:r,isEnabled:o}=e,d=s.map(e=>{let{uuid:t}=e;return{type:P,uuid:t}}).concat(t.map(e=>{let{uuid:t}=e;return{type:P,uuid:t}})).concat(a.map(e=>{let{uuid:t}=e;return{type:P,uuid:t}})).concat(l.map(e=>{let{uuid:t}=e;return{type:E,uuid:t}})).concat(n.map(e=>{let{file_uuid:t}=e;return{type:I,uuid:t}})),{selectedItems:c,handleSelect:u,selectAllItems:x,isInSelectionMode:m,toggleSelectMode:f}=(0,b.m)(d,!o),{addError:g}=(0,i.Y)(),{mutateAsync:j,isPending:v}=(0,p.z_)(r),{mutateAsync:y,isPending:w}=(0,h.Aw)(r),{mutateAsync:S,isPending:M}=(0,h.KU)(r),N=async()=>{let e=c.filter(e=>{let{type:t}=e;return t===E}),t=c.filter(e=>{let{type:t}=e;return t===P}),s=c.filter(e=>{let{type:t}=e;return t===I});f(!1);try{await Promise.all([e.length?y({doc_uuids:e.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve(),t.length?j({sync_source_uuids:t.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve(),s.length?S({file_uuids:s.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve()])}catch(e){g("Something went wrong while deleting. Refresh the page and try again",{error:e})}};return{isDeleting:w||v||M,selectedItems:c,handleSelect:u,selectAllItems:x,isInSelectionMode:m,toggleSelectMode:f,handleDeleteSelected:N}}},50498:(e,t,s)=>{s.d(t,{m:()=>l});var a=s(7620);let l=(e,t)=>{let[s,l]=(0,a.useState)(!1),[n,i]=(0,a.useState)([]);return(0,a.useEffect)(()=>{let t=n.filter(t=>e.some(e=>e.uuid===t.uuid&&e.type===t.type));t.length!==n.length&&i(t)},[e]),(0,a.useEffect)(()=>{l(n.length>0)},[n]),{selectedItems:n,handleSelect:(s,a,l)=>{t||(a?((s,a)=>{t||i(t=>{if(!a||0===Object.keys(t).length)return[...t,s];let l=t[Object.keys(t).length-1],n=e.findIndex(e=>{let{uuid:t,type:s}=e;return t===l.uuid&&s===l.type});if(-1===n)return[...t,s];let i=e.findIndex(e=>{let{uuid:t}=e;return t===s.uuid}),r=Math.min(n+1,i),o=Math.max(n-1,i),d=e.slice(r,o+1),c=t.map(e=>{let{uuid:t}=e;return t});return[...t,...d.filter(e=>{let{uuid:t}=e;return -1===c.indexOf(t)})]})})(s,l):(e=>{t||i(t=>t.filter(t=>{let{uuid:s,type:a}=t;return s!==e.uuid||a!==e.type}))})(s))},selectAllItems:()=>{t||(n.length===e.length?i([]):i(e))},isInSelectionMode:!t&&s,toggleSelectMode:e=>{l(e),e||i([])}}}},59401:(e,t,s)=>{s.d(t,{H:()=>ee,w:()=>W});var a=s(54568),l=s(16253),n=s(69916),i=s(15964),r=s(52198),o=s(34059),d=s(41417),c=s(56370),u=s(37076),x=s(12072),m=s(89674),f=s(27062),g=s(77101),h=s(62094),p=s(64039),j=s(32987),v=s(7620),y=s(46760),b=s(62971),w=s(41932),S=s(81527),M=s(85717),N=s(57934),A=s(45715),k=s(56147),C=s(16700),D=s(87907),_=s(60885),U=s(8816),P=s(13261),E=s(16430),I=s(89836),T=s(52909),O=s(15046),R=s(45078);function G(e){let{conversation:t}=e,s=(0,M.K6)(),l=(0,M.$f)(t),{toggleConversationSetting:n}=(0,R.r)();return s?(0,a.jsx)("div",{className:"px-2 py-1.5 -mx-1 -mb-1 border-t-0.5 border-border-300 hover:bg-bg-200",children:(0,a.jsxs)(c.tJ,{className:"flex flex-row gap-4 cursor-pointer px-2 pt-1 pb-2",onSelect:e=>{e.stopPropagation(),e.preventDefault(),n("enabled_bananagrams",!l)},onPointerLeave:e=>e.preventDefault(),onPointerMove:e=>e.preventDefault(),children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{children:(0,a.jsx)(b.A,{defaultMessage:"Allow Claude to search",id:"zyxxt7OHPv"})}),(0,a.jsx)("p",{className:"text-xs text-text-400",children:(0,a.jsx)(b.A,{defaultMessage:"Claude will search for relevant documents",id:"JxbYvAvtdV"})})]}),(0,a.jsx)(O.j,{checked:l,readOnly:!0})]})}):null}var F=s(35391),z=s(1385);function L(e){let{title:t,url:s,isLoading:l,isError:n,isLink:i=!1,defaultErrorTitle:r,defaultDocumentTitle:o}=e,d=(0,a.jsx)("p",{children:o});return(n?d=(0,a.jsx)("p",{children:r}):!l||t||o?t&&(d=(0,a.jsx)("p",{children:t})):d=(0,a.jsx)(z.j,{variant:"light",className:"rounded-md",height:18}),i&&s)?(0,a.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:d}):d}function K(e){let{uri:t,isError:s,isLink:l=!1}=e,{data:n,isLoading:i}=(0,M.y)({documentId:t}),r=(0,F.d)(t);return(0,a.jsx)(L,{title:null==n?void 0:n.title,url:r,isLoading:i,isError:s,isLink:l,defaultErrorTitle:"Google Docs"})}var V=s(48676),H=s(31102);let B={includeScore:!0,threshold:.3,keys:["title"],ignoreLocation:!0},J=e=>{let{conversation:t,projectUuid:s,trigger:l,align:r,isSubDropdown:o=!1,setIsUploadingDriveSync:d,onCreated:u,isOpen:x,setIsOpen:h,closeWholeDropdown:p=()=>h(!1),shouldAddSyncUponPaste:j}=e,b=(0,y.A)(),{value:w}=(0,f.fS)("kingfisher_prefetch"),{recentDriveDocs:S,isLoading:N}=(0,M.zH)(w||x),[A,k]=(0,v.useState)(""),[C,D]=(0,v.useState)(!1),[_,U]=(0,v.useState)(""),{addError:P}=(0,n.Y)(),O=(0,v.useRef)(null),R=(0,v.useRef)(null),F=()=>{d(!0),D(!0)},z=e=>{null==u||u(e),p(),D(!1)},L=e=>{d(!1),D(!1),P((0,H.J)(e),{error:e})},{mutate:K}=(0,I.EF)({onMutate:F,onSuccess:z,onError:L,meta:{noToast:!0}}),{mutate:J}=(0,T.pz)(s,{onMutate:F,onSuccess:z,onError:L,meta:{noToast:!0}}),W=(0,v.useMemo)(()=>S&&A?new E.A(S,B).search(A).map(e=>e.item):S,[S,A]),$=A?null==W?void 0:W.slice(0,7):null==S?void 0:S.slice(0,5),q=e=>{p(),(s?J:K)({sync_source_type:g.v8.GDRIVE,sync_source_config:{uri:e}})},X=e=>{let t=(0,V.$)(e);k(e);let s="";if(t)q(t);else if((0,V.X)(e))s=b.formatMessage({defaultMessage:"Only Google Docs are supported at this time",id:"P3m20xflVA"});else try{new URL(e),s=b.formatMessage({defaultMessage:"Not a valid Google Doc URL",id:"S//j6oF0j8"})}catch(e){}U(s)};(0,m.y)({target:O,shouldFocus:x}),(0,v.useEffect)(()=>{x||(k(""),D(!1),U(""))},[x,k,D,U]);let Q=!!s,Z=o?c.FV:c.ms;return(0,a.jsxs)(Z,{className:"text-md w-[332px] p-0 overflow-hidden",align:r,trigger:l,onKeyDown:e=>{if(!["Enter","ArrowDown","ArrowUp"].includes(e.key)){var t;null==(t=O.current)||t.focus()}},onFocusOutside:e=>e.preventDefault(),...o?{forceMount:!0}:{open:x,onOpenChange:h,unstyledTrigger:!0},children:[(0,a.jsx)(c.Bi,{children:(0,a.jsx)(i.ks,{ref:O,value:A,placeholder:b.formatMessage({defaultMessage:"Search recents or paste URL",id:"jprBObbn5b"}),className:"w-full bg-inherit border-none select-none",onChange:e=>{X(e.target.value)},onPasteCapture:e=>{if(e.stopPropagation(),!x)return;let t=e.clipboardData.getData("text"),s=(0,V.$)(t);s&&j&&q(s)},onKeyDown:e=>{if("ArrowLeft"===e.key&&A)e.stopPropagation();else if("Enter"===e.key)X(e.currentTarget.value);else if("ArrowDown"===e.key&&$&&$.length>0){var t;e.preventDefault(),null==(t=R.current)||t.focus()}},"data-1p-ignore":!0,autoComplete:"off",autoFocus:!0})}),(0,a.jsx)(Y,{inputRef:O,firstDocumentRef:R,handleAddDocument:q,documents:$,isValidatingUrl:C,isFetchingRecentDriveDocs:N,errorMessage:_}),!Q&&!A&&(0,a.jsx)(G,{conversation:t})]})},Y=e=>{let{inputRef:t,firstDocumentRef:s,handleAddDocument:l,documents:n,isValidatingUrl:i,isFetchingRecentDriveDocs:r,errorMessage:d}=e,u=i||r&&!n.length,x=!!d,m=!u&&(!n||!n.length);return u?(0,a.jsx)("div",{className:"flex flex-col items-center justify-center h-[220px]",children:(0,a.jsx)(U.y,{className:"animate-spin mx-auto"})}):x?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[220px] text-center",children:[(0,a.jsx)(P.i,{size:24,className:"text-text-400",weight:"duotone"}),(0,a.jsx)("p",{className:"text-md text-text-400 mt-4",children:(0,a.jsx)(b.A,{defaultMessage:"Invalid URL",id:"SASA4f9KO3"})}),(0,a.jsx)("p",{className:"text-sm text-danger-000",children:d})]}):m?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[220px]",children:[(0,a.jsx)(P.i,{size:24,className:"text-text-400",weight:"duotone"}),(0,a.jsx)("p",{className:"text-md text-text-400 mt-4",children:(0,a.jsx)(b.A,{defaultMessage:"No recents found",id:"2FzJykASLO"})}),(0,a.jsx)("p",{className:"text-sm text-text-500",children:(0,a.jsx)(b.A,{defaultMessage:"Try pasting the URL instead",id:"jf3/+bX0lc"})})]}):(0,a.jsx)("div",{className:"px-1.5 py-1",children:n.map((e,n)=>{let{uri:i,title:r}=e;return(0,a.jsxs)(c.tJ,{className:"!grid-cols-[max-content_auto] hover:text-text-000 hover:bg-bg-200",ref:0===n?s:void 0,onClick:()=>l(i),onKeyDown:e=>{if("ArrowUp"===e.key&&0===n){var s;e.preventDefault(),null==(s=t.current)||s.focus()}},textValue:"",onPointerLeave:e=>e.preventDefault(),onPointerMove:e=>e.preventDefault(),children:[(0,a.jsx)(o.A9,{type:g.v8.GDRIVE,variant:o.UF.DOCS,size:16}),(0,a.jsx)("span",{className:"truncate",children:null!=r?r:(0,a.jsx)(K,{uri:i})})]},i)})})},W=e=>{let{projectUuid:t,isStarterProject:s,isUploading:i,setIsUploadingDoc:r,setIsUploadingGithubSync:o,setIsUploadingDriveSync:d,setIsUploadingOutlineSync:c}=e,u=(0,y.A)(),x=(0,v.useRef)(null),[m,g]=(0,v.useState)(""),[h,p]=(0,v.useState)(""),[j,C]=(0,v.useState)(!1),[D,U]=(0,v.useState)(!1),[P,E]=(0,v.useState)(!1),{addError:I}=(0,n.Y)(),{mutateAsync:T}=(0,w.fh)(t,{onError:()=>r(!1)}),{data:O}=(0,S.fo)(t),{checkIsGithubAuthenticated:R,initGithubAuth:G}=(0,N.nB)({callerIdentifier:"project",toggleGithubModalOpen:U}),F=(0,N.Cq)(),{isOutlineAuthenticated:z}=(0,A.I5)(),L=(0,A.AI)(),K=(0,M.LP)(),V=(0,k.ED)(t),{maxKbTokens:H}=(0,k.AO)(),B=(null!=V?V:0)>H,J=(0,l.cV)(),{value:Y}=(0,f.fS)("project_image"),{handleProjectFileUpload:W}=(0,k.IE)({projectUuid:t,onError:()=>r(!1)}),q=(0,v.useCallback)(async e=>{let t=e.target.files;t&&(r(!0),await W(Array.from(t),H-(null!=V?V:0)),r(!1)),e.target.value=""},[W,r,V,H]),X=async()=>{try{C(!1),r(!0),await T({file_name:h,content:m}),p(""),g("")}catch(e){r(!1),I(u.formatMessage({defaultMessage:"Error saving text content",id:"9U64gLEIVo"}),{error:e})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{"data-testid":"project-doc-upload",ref:x,type:"file",className:"hidden",accept:(0,l.cm)({imagesEnabled:Y,outOfContextFilesEnabled:J}).join(","),onChange:q,multiple:!0}),(0,a.jsx)($,{projectUuid:t,shouldShowGithubSyncSource:F,shouldShowDriveSyncSource:K,shouldShowOutlineSyncSource:L,handleGithubClick:()=>{R().then(e=>{if(e)return void U(!0);G()})},handleOutlineClick:()=>{z?E(!0):I((0,a.jsxs)("div",{className:"flex flex-col items-start",children:[(0,a.jsx)("div",{children:(0,a.jsx)(b.A,{defaultMessage:"You need to connect to Outline before using this feature.",id:"PejG+e4wN5"})}),(0,a.jsx)("button",{onClick:()=>{window.location.href="/settings/profile"},className:"mt-2 underline",children:(0,a.jsx)(b.A,{defaultMessage:"Connect to Outline",id:"m1DuTWXorQ"})})]}))},handleFileUploadClick:()=>{x.current&&x.current.click()},handleTextContentClick:()=>C(!0),isPrivateProject:!!(null==O?void 0:O.is_private),isStarterProject:s,isOverProjectKnowledgeLimit:B,isLoading:i,setIsUploadingDriveSync:d}),(0,a.jsx)(Z,{isOpen:j,onClose:()=>C(!1),title:h,setTitle:p,content:m,setContent:g,onSave:X}),F&&(0,a.jsx)(_.s,{location:"project",isOpen:D,onClose:()=>U(!1),projectUuid:t,setIsUploadingGithubSync:o}),L&&""]})},$=e=>{let{projectUuid:t,shouldShowGithubSyncSource:s,shouldShowDriveSyncSource:l,handleGithubClick:n,handleFileUploadClick:i,handleTextContentClick:o,isPrivateProject:d,isStarterProject:u,isOverProjectKnowledgeLimit:x,isLoading:m,shouldShowOutlineSyncSource:f,handleOutlineClick:h,setIsUploadingDriveSync:p}=e,[j,y]=(0,v.useState)(!1),[w,S]=(0,v.useState)(!1),N=l||s,{isDriveAuthenticated:A,initDriveAuth:k,handleDriveTrigger:C}=(0,M.cI)({callerIdentifier:"project",handleAuthSuccess:e=>{y(e),e?setTimeout(()=>{S(e)},100):S(e)}}),D=A&&d;return(0,a.jsxs)(c.ms,{align:"end",unstyledTrigger:!0,trigger:(0,a.jsx)(q,{isStarterProject:u,isOverProjectKnowledgeLimit:x,isLoading:m}),open:j,onOpenChange:y,children:[(0,a.jsx)(c.tJ,{onClick:i,className:"text-left",icon:(0,a.jsx)(r.o3,{}),children:(0,a.jsx)(b.A,{defaultMessage:"Upload from device",id:"vMaZk5Jcnv"})}),(0,a.jsx)(c.tJ,{onClick:o,className:"text-left",icon:(0,a.jsx)(r.XG,{}),children:(0,a.jsx)(b.A,{defaultMessage:"Add text content",id:"G7XW3Mvn8X"})}),N?(0,a.jsx)(c.DG,{}):null,s&&(0,a.jsx)(X,{type:g.v8.GITHUB,isPrivateProject:d,onClick:n}),l&&(0,a.jsx)(Q,{projectUuid:t,isPrivateProject:d,setIsUploadingDriveSync:p,isOpen:w,setIsOpen:S,closeWholeDropdown:()=>{S(!1),y(!1)},showGoogleDriveSubDropdown:D,handleGoogleDriveButtonClick:()=>{!D&&d&&(A?C():k())}}),f&&(0,a.jsx)(X,{type:g.v8.OUTLINE,isPrivateProject:d,onClick:h})]})},q=(0,v.forwardRef)((e,t)=>{let{isStarterProject:s,isOverProjectKnowledgeLimit:l,isLoading:n,...i}=e,o=(0,a.jsx)(d.$,{...i,ref:t,size:"icon_sm",variant:"ghost","data-testid":"project-doc-uploader-dropdown-trigger",disabled:s||l||n,loading:n,className:"-mr-2 !scale-100",tooltip:(0,a.jsx)(b.A,{defaultMessage:"Add files",id:"xrAjmQ72mN"}),children:(0,a.jsx)(r.OM,{size:16})});return s?(0,a.jsx)(C.m,{children:(0,a.jsx)("div",{children:o})}):l?(0,a.jsx)(x.Tooltip,{side:"bottom",tooltipContent:(0,a.jsx)(b.A,{defaultMessage:"Project knowledge at capacity. Remove an existing file in order to add to knowledge",id:"g3hx72ya32"}),children:(0,a.jsx)("div",{children:o})}):o});q.displayName="ProjectDocUploaderDropdownTrigger";let X=e=>{let{type:t,isPrivateProject:s,isSubTrigger:l=!1,isSubDropdownOpen:n=!1,onClick:i}=e,r=l?c.Wn:c.tJ,d=(0,a.jsxs)(r,{onClick:i,onPointerLeave:e=>{l&&n&&e.preventDefault()},onPointerMove:e=>{l&&n&&e.preventDefault()},disabled:!s,className:"text-left",children:[(0,a.jsxs)("div",{className:"flex font-base items-center gap-2.5 py-0.5",children:[(0,a.jsx)(o.A9,{type:t,size:18}),(0,D.xI)(t)]}),l&&(0,a.jsx)(h.K,{size:18})]});return s?d:(0,a.jsx)(x.Tooltip,{side:"left",tooltipContent:(0,a.jsx)(b.A,{defaultMessage:"Only accessible from private projects",id:"lNrma+LwGe"}),children:(0,a.jsx)("div",{children:d})})},Q=e=>{let{projectUuid:t,isPrivateProject:s,setIsUploadingDriveSync:l,isOpen:n,setIsOpen:i,closeWholeDropdown:r,showGoogleDriveSubDropdown:o,handleGoogleDriveButtonClick:d}=e;return o?(0,a.jsxs)(c.MS,{open:n,onOpenChange:i,children:[(0,a.jsx)(X,{type:g.v8.GDRIVE,isPrivateProject:s,isSubTrigger:!0,isSubDropdownOpen:n}),(0,a.jsx)(c.cm,{children:(0,a.jsx)(J,{projectUuid:t,isSubDropdown:!0,setIsUploadingDriveSync:l,isOpen:n,setIsOpen:i,closeWholeDropdown:r,shouldAddSyncUponPaste:!0})})]}):(0,a.jsx)(X,{type:g.v8.GDRIVE,isPrivateProject:s,onClick:d})},Z=e=>{let{isOpen:t,onClose:s,title:l,setTitle:n,content:r,setContent:o,onSave:c}=e,x=(0,y.A)(),f=(0,v.useRef)(null);return(0,m.y)({shouldFocus:t,target:f}),(0,a.jsx)(u.aF,{isOpen:t,onClose:s,modalSize:"xl",className:"p-7 pt-6",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),""!==l.trim()&&""!==r.trim()&&c()},children:[(0,a.jsx)("h2",{className:"font-claude-response mb-3 text-xl",children:(0,a.jsx)(b.A,{defaultMessage:"Add text content",id:"G7XW3Mvn8X"})}),(0,a.jsx)(i.ks,{ref:f,placeholder:x.formatMessage({defaultMessage:"Name your content",id:"C7Sx4g/l21"}),className:"mb-2 w-full",size:"lg",label:(0,a.jsx)(b.A,{defaultMessage:"Title",id:"9a9+wwWy4u"}),value:l,onChange:e=>n(e.target.value),required:!0}),(0,a.jsx)(i.fs,{placeholder:x.formatMessage({defaultMessage:"Type or paste in content...",id:"f5RDuqxeT2"}),label:x.formatMessage({defaultMessage:"Content",id:"Jq3FDzj0/T"}),minRows:12,value:r,onChange:e=>o(e.target.value),required:!0,className:"max-h-[50vh] overflow-y-auto"}),(0,a.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,a.jsx)(d.$,{variant:"secondary",onClick:e=>{e.preventDefault(),s()},children:(0,a.jsx)(b.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(d.$,{type:"submit",children:(0,a.jsx)(b.A,{defaultMessage:"Add Content",id:"66s1201qd9"})})]})]})})},ee=e=>{let{size:t="default",projectUuid:s,tooltipContent:l}=e,n=(0,k.ED)(s),{maxKbTokens:i}=(0,k.AO)(),r=(0,k.gq)(s),o=(0,k.AV)(),c=(0,k.Pb)(s);if(!n)return null;let u=Math.ceil(n/i*100),m=u>80&&u<100,f=u>=100,g=r?Math.min(100,r/i*100):void 0;return(0,a.jsxs)("div",{className:(0,j.A)("default"!==t&&"flex items-center gap-3"),children:[(0,a.jsxs)("div",{className:(0,j.A)("bg-bg-300 rounded-full p-px border-border-300 border-0.5 relative","small"===t&&"w-24"),children:[(0,a.jsx)("div",{style:{width:"".concat(Math.max(2,Math.min(100,u)),"%")},className:(0,j.A)("h-1.5 rounded-full transition-all",!m&&!f&&"bg-accent-secondary-100",m&&"bg-warning-orange",f&&"bg-danger-200")}),o&&void 0!==g&&n>=(r||0)&&(0,a.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 w-1.5 h-1.5 bg-text-100 rounded-full mix-blend-normal",style:{left:"".concat(g,"%"),transform:"translate(-50%, -50%)"}})]}),(0,a.jsxs)("div",{className:(0,j.A)("flex gap-2 items-center text-xs","default"===t&&"mt-2"),children:[(0,a.jsx)("div",{className:(0,j.A)("flex-1",u<100&&"text-text-400",u>=100&&"text-danger-000 font-medium"),children:(0,a.jsx)(b.A,{defaultMessage:"{pctUsed}% of project capacity used",id:"JfriU6oVgp",values:{pctUsed:u}})}),!o&&(0,a.jsx)(x.Tooltip,{className:"text-center mt-0.5",side:"left",tooltipContent:null!=l?l:(0,a.jsx)(b.A,{defaultMessage:"Project knowledge is currently limited to Claudeâ€™s maximum context window size.",id:"aAeavdIV/P"}),children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(d.$,{size:"unset",variant:"unstyled",href:"https://support.anthropic.com/en/articles/9517075-what-are-projects",target:"_blank",className:"rounded-full text-text-500 hover:text-text-200",children:(0,a.jsx)(p.R,{size:14})})})}),c&&(0,a.jsx)("div",{className:"text-text-400 text-xs flex gap-1",children:(0,a.jsx)(x.Tooltip,{className:"text-center mt-0.5",side:"bottom",tooltipContent:null!=l?l:(0,a.jsx)(b.A,{defaultMessage:"To save space, Claude looks up information as needed.",id:"a/OO1blv/l"}),children:(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-text-500 rounded-full"}),(0,a.jsx)(b.A,{defaultMessage:"Retrieving",id:"RmdvWf4BuF"})]})})})]}),u>=100&&(0,a.jsx)("div",{className:"text-text-400 text-xs",children:(0,a.jsx)(b.A,{defaultMessage:"Remove an existing file in order to add to knowledge",id:"mSQjDnX2IA"})})]})}},61527:(e,t,s)=>{s.d(t,{k:()=>g});var a=s(54568),l=s(69916),n=s(15964),i=s(41417),r=s(37076),o=s(27062),d=s(27261),c=s.n(d),u=s(7620),x=s(46760),m=s(62971),f=s(81527);function g(e){let{isOpen:t,onClose:s,project:d}=e,g=(0,x.A)(),[h,p]=(0,u.useState)(d.prompt_template),[j,v]=(0,u.useState)(!1),{value:y}=(0,o.fS)("claudeai_custom_styles"),{value:b}=(0,o.fS)("claude_ai_cayenne"),{addError:w}=(0,l.Y)(),{mutateAsync:S}=(0,f.sS)(d.uuid),M=async()=>{v(!0);try{await S({prompt_template:h}),s(),v(!1)}catch(e){w(g.formatMessage({defaultMessage:"Error saving instructions, please try again later",id:"WL3FdCcP2y"}),{error:e}),v(!1)}},N=d.prompt_template.length>0&&0===h.length,A=b?(0,a.jsx)(m.A,{defaultMessage:"This will work alongside <link>user preferences</link> and the selected style in a chat.",values:{link:e=>(0,a.jsx)(c(),{className:"hover:underline",href:"/settings/profile",children:e})},id:"NlixH3av58"}):(0,a.jsx)(m.A,{defaultMessage:"This will work alongside the selected style in a chat.",id:"rptxrPz/Y3"});return(0,a.jsxs)(r.aF,{isOpen:t,onClose:s,modalSize:"xl",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("h2",{className:"font-xl-bold",children:(0,a.jsx)(m.A,{defaultMessage:"Set project instructions",id:"+On7CFwfGv"})}),(0,a.jsxs)("p",{className:"text-text-300 text-sm",children:[(0,a.jsx)(m.A,{defaultMessage:"Provide Claude with relevant instructions and information for chats within {projectName}.",id:"NM6ePuQ0y+",values:{projectName:d.name}}),"\xa0",y&&A]})]}),(0,a.jsx)("div",{className:"mb-6 mt-3",children:(0,a.jsx)(n.fs,{"data-testid":"custom-instructions-textarea",value:h,onChange:e=>p(e.target.value),placeholder:[g.formatMessage({defaultMessage:"Think step by step and show reasoning for complex problems. Use specific examples.",id:"j554E3Ar1K"}),g.formatMessage({defaultMessage:"Break down large tasks and ask clarifying questions when needed.",id:"H/tJ47E9to"}),g.formatMessage({defaultMessage:"Use Artifacts only for web apps and code demos.",id:"U50hIJOW7M"}),g.formatMessage({defaultMessage:"When giving feedback, explain thought process and highlight issues and opportunities.",id:"f2YGj7vTV3"})],minRows:16,required:!0,customScrollbar:!0,className:"max-h-80"})}),(0,a.jsxs)("div",{className:"mt-2 flex justify-end gap-2",children:[(0,a.jsx)(i.$,{variant:"secondary",onClick:s,children:(0,a.jsx)(m.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(i.$,{loading:j,disabled:d.prompt_template===h,onClick:()=>{M()},children:N?(0,a.jsx)(m.A,{defaultMessage:"Clear instructions",id:"aHS9gkqH/s"}):(0,a.jsx)(m.A,{defaultMessage:"Save instructions",id:"wtm6MF4hNg"})})]})]})}},74211:(e,t,s)=>{s.d(t,{G:()=>o,p:()=>r});var a=s(54568),l=s(7620),n=s(15957);let i=(0,l.createContext)(void 0);function r(e){let{project:t,children:s}=e,l=(0,n.X)(t);return(0,a.jsx)(i.Provider,{value:l,children:s})}function o(){return(0,l.useContext)(i)}}}]);